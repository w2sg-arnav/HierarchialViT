2025-05-28 09:32:01 - root - INFO - [setup_logging:75] - Logging configured. Log file: /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_full_v1/finetune_hvt_full_20250528_093201.log. Logger 'root' Effective Level: DEBUG
2025-05-28 09:32:01 - __main__ - INFO - [main_execution_logic:186] - ======== Starting Phase 4: HVT Fine-tuning (Run ID: 20250528_093201) ========
2025-05-28 09:32:01 - __main__ - INFO - [main_execution_logic:187] - Full run configuration: {'seed': 42, 'device': 'cuda', 'log_dir': 'logs_finetune_full_v1', 'log_file_finetune': 'finetune_hvt_full.log', 'best_model_filename': 'best_finetuned_hvt_full.pth', 'final_model_filename': 'final_finetuned_hvt_full.pth', 'checkpoint_save_dir_name': 'checkpoints_full_v1', 'data_root': '/teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection', 'original_dataset_name': 'Original Dataset', 'augmented_dataset_name': 'Augmented Dataset', 'img_size': (448, 448), 'num_classes': 7, 'train_split_ratio': 0.8, 'normalize_data': True, 'use_weighted_sampler': True, 'num_workers': 4, 'prefetch_factor': 2, 'model_architecture_name': 'DiseaseAwareHVT_FullFinetune', 'pretrained_checkpoint_path': '/teamspace/studios/this_studio/cvpr25/phase3_pretraining/pretrain_checkpoints_hvt_xl/hvt_xl_simclr_t4_resumed_best_probe.pth', 'load_pretrained_backbone': True, 'freeze_backbone_epochs': 0, 'unfreeze_backbone_lr_factor': 0.1, 'hvt_params_for_model_init': {'patch_size': 14, 'embed_dim_rgb': 192, 'embed_dim_spectral': 192, 'spectral_channels': 0, 'depths': [3, 6, 24, 3], 'num_heads': [6, 12, 24, 48], 'mlp_ratio': 4.0, 'qkv_bias': True, 'model_drop_rate': 0.1, 'attn_drop_rate': 0.0, 'drop_path_rate': 0.1, 'norm_layer_name': 'LayerNorm', 'use_dfca': False, 'use_gradient_checkpointing': False, 'ssl_enable_mae': False, 'ssl_enable_contrastive': False, 'enable_consistency_loss_heads': False, 'dfca_embed_dim_match_rgb': True, 'dfca_num_heads': 32, 'dfca_drop_rate': 0.1, 'dfca_use_disease_mask': True, 'ssl_mae_mask_ratio': 0.75, 'ssl_mae_decoder_dim': 64, 'ssl_mae_norm_pix_loss': True, 'ssl_contrastive_projector_dim': 128, 'ssl_contrastive_projector_depth': 2}, 'enable_torch_compile': False, 'torch_compile_mode': 'reduce-overhead', 'matmul_precision': 'high', 'cudnn_benchmark': True, 'epochs': 90, 'batch_size': 16, 'accumulation_steps': 2, 'amp_enabled': True, 'clip_grad_norm': 1.0, 'log_interval': 10, 'optimizer': 'AdamW', 'learning_rate': 2e-05, 'head_lr_multiplier': 5.0, 'weight_decay': 0.05, 'optimizer_params': {'betas': (0.9, 0.999)}, 'scheduler': 'WarmupCosine', 'warmup_epochs': 5, 'eta_min_lr': 1e-07, 'loss_label_smoothing': 0.1, 'augmentations_enabled': True, 'evaluate_every_n_epochs': 1, 'early_stopping_patience': 10, 'metric_to_monitor_early_stopping': 'f1_macro', 'ssl_pretrain_img_size_fallback': (448, 448)}
2025-05-28 09:32:01 - __main__ - INFO - [set_global_seed:81] - Global random seed set to: 42
2025-05-28 09:32:01 - __main__ - INFO - [main_execution_logic:191] - Using device: cuda
2025-05-28 09:32:01 - __main__ - INFO - [main_execution_logic:192] - GPU: Tesla T4; CUDA Ver: 12.1
2025-05-28 09:32:01 - phase4_finetuning.dataset - INFO - [__init__:54] - [DATASET INIT - train] Root: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection, ImgSize: (448, 448)
2025-05-28 09:32:01 - phase4_finetuning.dataset - INFO - [__init__:67] - [DATASET INIT - train] Scanning: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection/Original Dataset
2025-05-28 09:32:01 - phase4_finetuning.dataset - INFO - [__init__:67] - [DATASET INIT - train] Scanning: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection/Augmented Dataset
2025-05-28 09:32:01 - phase4_finetuning.dataset - INFO - [__init__:98] - [DATASET INIT - train] Total valid image paths collected: 9137 from ~9137 items considered.
2025-05-28 09:32:01 - phase4_finetuning.dataset - INFO - [__init__:111] - [DATASET INIT - train] Dataset split size: 7309 samples.
2025-05-28 09:32:01 - phase4_finetuning.dataset - INFO - [__init__:123] - [DATASET INIT - train] Base RGB Transforms: Compose(
      ToImage()
      ToDtype(scale=False)
      Resize(size=[448, 448], interpolation=InterpolationMode.BICUBIC, antialias=True)
      Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225], inplace=False)
)
2025-05-28 09:32:01 - phase4_finetuning.dataset - INFO - [__init__:54] - [DATASET INIT - val] Root: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection, ImgSize: (448, 448)
2025-05-28 09:32:01 - phase4_finetuning.dataset - INFO - [__init__:67] - [DATASET INIT - val] Scanning: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection/Original Dataset
2025-05-28 09:32:02 - phase4_finetuning.dataset - INFO - [__init__:67] - [DATASET INIT - val] Scanning: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection/Augmented Dataset
2025-05-28 09:32:02 - phase4_finetuning.dataset - INFO - [__init__:98] - [DATASET INIT - val] Total valid image paths collected: 9137 from ~9137 items considered.
2025-05-28 09:32:02 - phase4_finetuning.dataset - INFO - [__init__:111] - [DATASET INIT - val] Dataset split size: 1828 samples.
2025-05-28 09:32:02 - phase4_finetuning.dataset - INFO - [__init__:123] - [DATASET INIT - val] Base RGB Transforms: Compose(
      ToImage()
      ToDtype(scale=False)
      Resize(size=[448, 448], interpolation=InterpolationMode.BICUBIC, antialias=True)
      Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225], inplace=False)
)
2025-05-28 09:32:02 - phase4_finetuning.dataset - INFO - [get_class_weights:180] - Computed class weights for split 'train': [1.029 0.912 1.065 1.014 1.05  0.833 1.172]
2025-05-28 09:32:02 - __main__ - INFO - [main_execution_logic:207] - Using WeightedRandomSampler.
2025-05-28 09:32:02 - __main__ - INFO - [main_execution_logic:212] - Dataloaders created. Train batches: 456, Val batches: 115
2025-05-28 09:32:02 - phase2_model.models.hvt - INFO - [create_disease_aware_hvt:602] - Factory: Creating DiseaseAwareHVT for img_size: (448, 448), num_classes: 7
2025-05-28 09:32:05 - phase2_model.models.hvt - INFO - [__init__:325] - HVT: Running RGB stream only. No fusion.
2025-05-28 09:32:07 - phase2_model.models.hvt - INFO - [__init__:359] - DiseaseAwareHVT initialized for image size (448, 448) and 7 classes.
2025-05-28 09:32:07 - __main__.load_and_prepare_hvt_model - INFO - [load_and_prepare_hvt_model:126] - Loading SSL backbone weights from: /teamspace/studios/this_studio/cvpr25/phase3_pretraining/pretrain_checkpoints_hvt_xl/hvt_xl_simclr_t4_resumed_best_probe.pth
2025-05-28 09:32:10 - __main__.load_and_prepare_hvt_model - INFO - [load_and_prepare_hvt_model:136] - SSL and Finetune img_size match: (448, 448). No PE interpolation if patch counts same.
2025-05-28 09:32:10 - __main__.load_and_prepare_hvt_model - INFO - [load_and_prepare_hvt_model:154] - SSL Backbone weights loaded: 450 direct, 0 PE interp, 2 head skipped.
2025-05-28 09:32:10 - __main__.load_and_prepare_hvt_model - WARNING - [load_and_prepare_hvt_model:155] - Missing keys in backbone load: ['classifier_head.weight', 'classifier_head.bias']
2025-05-28 09:32:10 - __main__.load_and_prepare_hvt_model - INFO - [load_and_prepare_hvt_model:161] - Re-initialized HVT classifier_head for 7 classes (in_features=1536).
2025-05-28 09:32:11 - __main__ - INFO - [main_execution_logic:217] - Model ready. Total params: 273,615,751, Trainable params: 273,615,751
2025-05-28 09:32:11 - phase4_finetuning.utils.augmentations - INFO - [__init__:24] - FinetuneAugmentation initialized.
2025-05-28 09:32:11 - __main__ - INFO - [main_execution_logic:279] - Optimizer: AdamW. Initial Group LRs: [0.0001, 2.0000000000000003e-06], Group WDs: [0.05, 0.05]
2025-05-28 09:32:11 - __main__ - INFO - [main_execution_logic:293] - Scheduler: WarmupCosine (per-step). WU Steps: 1140, Total Steps: 20520
2025-05-28 09:32:11 - phase4_finetuning.finetune.trainer - INFO - [__init__:44] - Finetuner initialized: device=cuda, accum_steps=2, lr_sched_on_batch=True, AMP=True
2025-05-28 09:32:11 - phase4_finetuning.finetune.trainer - INFO - [__init__:46] - Using augmentations: FinetuneAugmentation
2025-05-28 09:32:11 - __main__ - INFO - [main_execution_logic:317] - Starting fine-tuning: 90 epochs. Monitor: 'f1_macro', Patience: 10.
2025-05-28 09:35:05 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 1 training finished. Avg Loss: 1.9948, Final LR for epoch: 2.00e-05, Opt Steps: 228
2025-05-28 09:35:25 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 2.0189, accuracy: 0.1138, f1_macro: 0.0504, f1_weighted: 0.0496, precision_macro: 0.0325, precision_weighted: 0.0321, recall_macro: 0.1182, recall_weighted: 0.1138, f1_Bacterial_Blight: 0.0000, f1_Curl_Virus: 0.1643, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.0000, f1_Leaf_Hopper_Jassids: 0.1887, f1_Leaf_Redding: 0.0000, f1_Leaf_Variegation: 0.0000
2025-05-28 09:35:26 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:173] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_full_v1/checkpoints_full_v1/best_finetuned_hvt_full.pth
2025-05-28 09:35:26 - __main__ - INFO - [main_execution_logic:361] - E1: New best! Val f1_macro: 0.0504
2025-05-28 09:35:26 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E1 End: Alloc 3161.6MB
2025-05-28 09:38:20 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 2 training finished. Avg Loss: 1.9336, Final LR for epoch: 4.00e-05, Opt Steps: 228
2025-05-28 09:38:39 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 2.0232, accuracy: 0.1439, f1_macro: 0.0413, f1_weighted: 0.0446, precision_macro: 0.0259, precision_weighted: 0.0277, recall_macro: 0.1318, recall_weighted: 0.1439, f1_Bacterial_Blight: 0.0000, f1_Curl_Virus: 0.2694, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.0000, f1_Leaf_Hopper_Jassids: 0.0198, f1_Leaf_Redding: 0.0000, f1_Leaf_Variegation: 0.0000
2025-05-28 09:38:39 - __main__ - INFO - [main_execution_logic:363] - E2: Val f1_macro (0.0413) not better than 0.0504. Patience: 1/10
2025-05-28 09:38:39 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E2 End: Alloc 3161.6MB
2025-05-28 09:41:33 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 3 training finished. Avg Loss: 1.9243, Final LR for epoch: 6.00e-05, Opt Steps: 228
2025-05-28 09:41:52 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 2.0118, accuracy: 0.1559, f1_macro: 0.0452, f1_weighted: 0.0487, precision_macro: 0.0418, precision_weighted: 0.0434, recall_macro: 0.1428, recall_weighted: 0.1559, f1_Bacterial_Blight: 0.0000, f1_Curl_Virus: 0.2758, f1_Healthy_Leaf: 0.0185, f1_Herbicide_Growth_Damage: 0.0000, f1_Leaf_Hopper_Jassids: 0.0219, f1_Leaf_Redding: 0.0000, f1_Leaf_Variegation: 0.0000
2025-05-28 09:41:52 - __main__ - INFO - [main_execution_logic:363] - E3: Val f1_macro (0.0452) not better than 0.0504. Patience: 2/10
2025-05-28 09:41:52 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E3 End: Alloc 3161.6MB
2025-05-28 09:44:46 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 4 training finished. Avg Loss: 1.9163, Final LR for epoch: 8.00e-05, Opt Steps: 228
2025-05-28 09:45:05 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 2.0320, accuracy: 0.1132, f1_macro: 0.0722, f1_weighted: 0.0728, precision_macro: 0.1537, precision_weighted: 0.1454, recall_macro: 0.1144, recall_weighted: 0.1132, f1_Bacterial_Blight: 0.0168, f1_Curl_Virus: 0.2441, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.1441, f1_Leaf_Hopper_Jassids: 0.1006, f1_Leaf_Redding: 0.0000, f1_Leaf_Variegation: 0.0000
2025-05-28 09:45:09 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:173] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_full_v1/checkpoints_full_v1/best_finetuned_hvt_full.pth
2025-05-28 09:45:09 - __main__ - INFO - [main_execution_logic:361] - E4: New best! Val f1_macro: 0.0722
2025-05-28 09:45:09 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E4 End: Alloc 3161.6MB
2025-05-28 09:48:03 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 5 training finished. Avg Loss: 1.9207, Final LR for epoch: 1.00e-04, Opt Steps: 228
2025-05-28 09:48:23 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9497, accuracy: 0.1619, f1_macro: 0.0996, f1_weighted: 0.1016, precision_macro: 0.2442, precision_weighted: 0.2385, recall_macro: 0.1608, recall_weighted: 0.1619, f1_Bacterial_Blight: 0.0085, f1_Curl_Virus: 0.3675, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.2005, f1_Leaf_Hopper_Jassids: 0.1147, f1_Leaf_Redding: 0.0061, f1_Leaf_Variegation: 0.0000
2025-05-28 09:48:26 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:173] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_full_v1/checkpoints_full_v1/best_finetuned_hvt_full.pth
2025-05-28 09:48:26 - __main__ - INFO - [main_execution_logic:361] - E5: New best! Val f1_macro: 0.0996
2025-05-28 09:48:26 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E5 End: Alloc 3161.6MB
2025-05-28 09:51:20 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 6 training finished. Avg Loss: 1.9214, Final LR for epoch: 1.00e-04, Opt Steps: 228
2025-05-28 09:51:39 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9425, accuracy: 0.1871, f1_macro: 0.1144, f1_weighted: 0.1135, precision_macro: 0.1149, precision_weighted: 0.1129, recall_macro: 0.1824, recall_weighted: 0.1871, f1_Bacterial_Blight: 0.3248, f1_Curl_Virus: 0.3085, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.0151, f1_Leaf_Hopper_Jassids: 0.1102, f1_Leaf_Redding: 0.0423, f1_Leaf_Variegation: 0.0000
2025-05-28 09:51:42 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:173] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_full_v1/checkpoints_full_v1/best_finetuned_hvt_full.pth
2025-05-28 09:51:42 - __main__ - INFO - [main_execution_logic:361] - E6: New best! Val f1_macro: 0.1144
2025-05-28 09:51:42 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E6 End: Alloc 3161.6MB
2025-05-28 09:54:36 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 7 training finished. Avg Loss: 1.9123, Final LR for epoch: 9.99e-05, Opt Steps: 228
2025-05-28 09:54:55 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9261, accuracy: 0.1811, f1_macro: 0.1344, f1_weighted: 0.1439, precision_macro: 0.1517, precision_weighted: 0.1542, recall_macro: 0.1653, recall_weighted: 0.1811, f1_Bacterial_Blight: 0.1026, f1_Curl_Virus: 0.3606, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.1078, f1_Leaf_Hopper_Jassids: 0.1192, f1_Leaf_Redding: 0.2508, f1_Leaf_Variegation: 0.0000
2025-05-28 09:54:58 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:173] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_full_v1/checkpoints_full_v1/best_finetuned_hvt_full.pth
2025-05-28 09:54:58 - __main__ - INFO - [main_execution_logic:361] - E7: New best! Val f1_macro: 0.1344
2025-05-28 09:54:58 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E7 End: Alloc 3161.6MB
2025-05-28 09:57:52 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 8 training finished. Avg Loss: 1.9154, Final LR for epoch: 9.97e-05, Opt Steps: 228
2025-05-28 09:58:11 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9398, accuracy: 0.1761, f1_macro: 0.1046, f1_weighted: 0.1157, precision_macro: 0.2075, precision_weighted: 0.2023, recall_macro: 0.1543, recall_weighted: 0.1761, f1_Bacterial_Blight: 0.0333, f1_Curl_Virus: 0.3897, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.0687, f1_Leaf_Hopper_Jassids: 0.0307, f1_Leaf_Redding: 0.2099, f1_Leaf_Variegation: 0.0000
2025-05-28 09:58:11 - __main__ - INFO - [main_execution_logic:363] - E8: Val f1_macro (0.1046) not better than 0.1344. Patience: 1/10
2025-05-28 09:58:11 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E8 End: Alloc 3161.6MB
2025-05-28 10:01:05 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 9 training finished. Avg Loss: 1.9076, Final LR for epoch: 9.95e-05, Opt Steps: 228
2025-05-28 10:01:25 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9192, accuracy: 0.1373, f1_macro: 0.0830, f1_weighted: 0.0876, precision_macro: 0.0644, precision_weighted: 0.0677, recall_macro: 0.1294, recall_weighted: 0.1373, f1_Bacterial_Blight: 0.0000, f1_Curl_Virus: 0.3183, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.1258, f1_Leaf_Hopper_Jassids: 0.0722, f1_Leaf_Redding: 0.0646, f1_Leaf_Variegation: 0.0000
2025-05-28 10:01:25 - __main__ - INFO - [main_execution_logic:363] - E9: Val f1_macro (0.0830) not better than 0.1344. Patience: 2/10
2025-05-28 10:01:25 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E9 End: Alloc 3161.6MB
2025-05-28 10:04:18 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 10 training finished. Avg Loss: 1.9067, Final LR for epoch: 9.91e-05, Opt Steps: 228
2025-05-28 10:04:37 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9235, accuracy: 0.1805, f1_macro: 0.1223, f1_weighted: 0.1311, precision_macro: 0.1656, precision_weighted: 0.1645, recall_macro: 0.1628, recall_weighted: 0.1805, f1_Bacterial_Blight: 0.1697, f1_Curl_Virus: 0.3941, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.1020, f1_Leaf_Hopper_Jassids: 0.0000, f1_Leaf_Redding: 0.1900, f1_Leaf_Variegation: 0.0000
2025-05-28 10:04:37 - __main__ - INFO - [main_execution_logic:363] - E10: Val f1_macro (0.1223) not better than 0.1344. Patience: 3/10
2025-05-28 10:04:37 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E10 End: Alloc 3161.6MB
2025-05-28 10:07:31 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 11 training finished. Avg Loss: 1.9004, Final LR for epoch: 9.88e-05, Opt Steps: 228
2025-05-28 10:07:50 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9323, accuracy: 0.1362, f1_macro: 0.0869, f1_weighted: 0.0927, precision_macro: 0.1567, precision_weighted: 0.1521, recall_macro: 0.1261, recall_weighted: 0.1362, f1_Bacterial_Blight: 0.0726, f1_Curl_Virus: 0.3369, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.0909, f1_Leaf_Hopper_Jassids: 0.0000, f1_Leaf_Redding: 0.0914, f1_Leaf_Variegation: 0.0163
2025-05-28 10:07:50 - __main__ - INFO - [main_execution_logic:363] - E11: Val f1_macro (0.0869) not better than 0.1344. Patience: 4/10
2025-05-28 10:07:50 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E11 End: Alloc 3161.6MB
2025-05-28 10:10:43 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 12 training finished. Avg Loss: 1.9107, Final LR for epoch: 9.83e-05, Opt Steps: 228
2025-05-28 10:11:02 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9133, accuracy: 0.1586, f1_macro: 0.0972, f1_weighted: 0.1012, precision_macro: 0.1255, precision_weighted: 0.1238, recall_macro: 0.1493, recall_weighted: 0.1586, f1_Bacterial_Blight: 0.0620, f1_Curl_Virus: 0.3247, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.0460, f1_Leaf_Hopper_Jassids: 0.1276, f1_Leaf_Redding: 0.0952, f1_Leaf_Variegation: 0.0252
2025-05-28 10:11:02 - __main__ - INFO - [main_execution_logic:363] - E12: Val f1_macro (0.0972) not better than 0.1344. Patience: 5/10
2025-05-28 10:11:02 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E12 End: Alloc 3161.6MB
2025-05-28 10:13:56 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 13 training finished. Avg Loss: 1.8965, Final LR for epoch: 9.78e-05, Opt Steps: 228
2025-05-28 10:14:15 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9353, accuracy: 0.2210, f1_macro: 0.1270, f1_weighted: 0.1415, precision_macro: 0.1242, precision_weighted: 0.1325, recall_macro: 0.1919, recall_weighted: 0.2210, f1_Bacterial_Blight: 0.0082, f1_Curl_Virus: 0.4312, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.0202, f1_Leaf_Hopper_Jassids: 0.1152, f1_Leaf_Redding: 0.3141, f1_Leaf_Variegation: 0.0000
2025-05-28 10:14:15 - __main__ - INFO - [main_execution_logic:363] - E13: Val f1_macro (0.1270) not better than 0.1344. Patience: 6/10
2025-05-28 10:14:15 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E13 End: Alloc 3161.6MB
2025-05-28 10:17:09 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 14 training finished. Avg Loss: 1.9024, Final LR for epoch: 9.73e-05, Opt Steps: 228
2025-05-28 10:17:28 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9387, accuracy: 0.2172, f1_macro: 0.1363, f1_weighted: 0.1478, precision_macro: 0.1267, precision_weighted: 0.1325, recall_macro: 0.1941, recall_weighted: 0.2172, f1_Bacterial_Blight: 0.2519, f1_Curl_Virus: 0.4064, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.0146, f1_Leaf_Hopper_Jassids: 0.0000, f1_Leaf_Redding: 0.2814, f1_Leaf_Variegation: 0.0000
2025-05-28 10:17:31 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:173] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_full_v1/checkpoints_full_v1/best_finetuned_hvt_full.pth
2025-05-28 10:17:31 - __main__ - INFO - [main_execution_logic:361] - E14: New best! Val f1_macro: 0.1363
2025-05-28 10:17:31 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E14 End: Alloc 3161.6MB
2025-05-28 10:20:25 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 15 training finished. Avg Loss: 1.8939, Final LR for epoch: 9.66e-05, Opt Steps: 228
2025-05-28 10:20:44 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.8875, accuracy: 0.2101, f1_macro: 0.1521, f1_weighted: 0.1605, precision_macro: 0.1420, precision_weighted: 0.1454, recall_macro: 0.1932, recall_weighted: 0.2101, f1_Bacterial_Blight: 0.2929, f1_Curl_Virus: 0.4054, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.1097, f1_Leaf_Hopper_Jassids: 0.0208, f1_Leaf_Redding: 0.2356, f1_Leaf_Variegation: 0.0000
2025-05-28 10:20:47 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:173] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_full_v1/checkpoints_full_v1/best_finetuned_hvt_full.pth
2025-05-28 10:20:47 - __main__ - INFO - [main_execution_logic:361] - E15: New best! Val f1_macro: 0.1521
2025-05-28 10:20:47 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E15 End: Alloc 3161.6MB
2025-05-28 10:23:41 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 16 training finished. Avg Loss: 1.8991, Final LR for epoch: 9.59e-05, Opt Steps: 228
2025-05-28 10:23:59 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9255, accuracy: 0.2019, f1_macro: 0.1693, f1_weighted: 0.1759, precision_macro: 0.2051, precision_weighted: 0.2091, recall_macro: 0.1926, recall_weighted: 0.2019, f1_Bacterial_Blight: 0.2430, f1_Curl_Virus: 0.3412, f1_Healthy_Leaf: 0.2850, f1_Herbicide_Growth_Damage: 0.1939, f1_Leaf_Hopper_Jassids: 0.0000, f1_Leaf_Redding: 0.1218, f1_Leaf_Variegation: 0.0000
2025-05-28 10:24:03 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:173] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_full_v1/checkpoints_full_v1/best_finetuned_hvt_full.pth
2025-05-28 10:24:03 - __main__ - INFO - [main_execution_logic:361] - E16: New best! Val f1_macro: 0.1693
2025-05-28 10:24:03 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E16 End: Alloc 3161.6MB
2025-05-28 10:26:57 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 17 training finished. Avg Loss: 1.8948, Final LR for epoch: 9.52e-05, Opt Steps: 228
2025-05-28 10:27:16 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9604, accuracy: 0.1307, f1_macro: 0.0791, f1_weighted: 0.0837, precision_macro: 0.1397, precision_weighted: 0.1350, recall_macro: 0.1217, recall_weighted: 0.1307, f1_Bacterial_Blight: 0.0562, f1_Curl_Virus: 0.3117, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.1008, f1_Leaf_Hopper_Jassids: 0.0083, f1_Leaf_Redding: 0.0636, f1_Leaf_Variegation: 0.0127
2025-05-28 10:27:16 - __main__ - INFO - [main_execution_logic:363] - E17: Val f1_macro (0.0791) not better than 0.1693. Patience: 1/10
2025-05-28 10:27:16 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E17 End: Alloc 3161.6MB
2025-05-28 10:30:10 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 18 training finished. Avg Loss: 1.8999, Final LR for epoch: 9.43e-05, Opt Steps: 228
2025-05-28 10:30:29 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9033, accuracy: 0.1947, f1_macro: 0.1271, f1_weighted: 0.1398, precision_macro: 0.2484, precision_weighted: 0.2607, recall_macro: 0.1691, recall_weighted: 0.1947, f1_Bacterial_Blight: 0.0599, f1_Curl_Virus: 0.3017, f1_Healthy_Leaf: 0.0143, f1_Herbicide_Growth_Damage: 0.1288, f1_Leaf_Hopper_Jassids: 0.0436, f1_Leaf_Redding: 0.3239, f1_Leaf_Variegation: 0.0174
2025-05-28 10:30:29 - __main__ - INFO - [main_execution_logic:363] - E18: Val f1_macro (0.1271) not better than 0.1693. Patience: 2/10
2025-05-28 10:30:29 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E18 End: Alloc 3161.6MB
2025-05-28 10:33:23 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 19 training finished. Avg Loss: 1.8986, Final LR for epoch: 9.35e-05, Opt Steps: 228
2025-05-28 10:33:42 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.8888, accuracy: 0.2741, f1_macro: 0.1955, f1_weighted: 0.2141, precision_macro: 0.1794, precision_weighted: 0.1936, recall_macro: 0.2480, recall_weighted: 0.2741, f1_Bacterial_Blight: 0.0000, f1_Curl_Virus: 0.3536, f1_Healthy_Leaf: 0.4258, f1_Herbicide_Growth_Damage: 0.2401, f1_Leaf_Hopper_Jassids: 0.0082, f1_Leaf_Redding: 0.3406, f1_Leaf_Variegation: 0.0000
2025-05-28 10:33:45 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:173] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_full_v1/checkpoints_full_v1/best_finetuned_hvt_full.pth
2025-05-28 10:33:45 - __main__ - INFO - [main_execution_logic:361] - E19: New best! Val f1_macro: 0.1955
2025-05-28 10:33:45 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E19 End: Alloc 3161.6MB
2025-05-28 10:36:39 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 20 training finished. Avg Loss: 1.8975, Final LR for epoch: 9.25e-05, Opt Steps: 228
2025-05-28 10:36:58 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9052, accuracy: 0.1997, f1_macro: 0.1565, f1_weighted: 0.1596, precision_macro: 0.2321, precision_weighted: 0.2386, recall_macro: 0.1939, recall_weighted: 0.1997, f1_Bacterial_Blight: 0.2784, f1_Curl_Virus: 0.3306, f1_Healthy_Leaf: 0.0420, f1_Herbicide_Growth_Damage: 0.2265, f1_Leaf_Hopper_Jassids: 0.0557, f1_Leaf_Redding: 0.1424, f1_Leaf_Variegation: 0.0200
2025-05-28 10:36:58 - __main__ - INFO - [main_execution_logic:363] - E20: Val f1_macro (0.1565) not better than 0.1955. Patience: 1/10
2025-05-28 10:36:58 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E20 End: Alloc 3161.6MB
2025-05-28 10:39:52 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 21 training finished. Avg Loss: 1.8959, Final LR for epoch: 9.15e-05, Opt Steps: 228
2025-05-28 10:40:11 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9078, accuracy: 0.2090, f1_macro: 0.1389, f1_weighted: 0.1503, precision_macro: 0.1613, precision_weighted: 0.1656, recall_macro: 0.1834, recall_weighted: 0.2090, f1_Bacterial_Blight: 0.1259, f1_Curl_Virus: 0.3166, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.1463, f1_Leaf_Hopper_Jassids: 0.0681, f1_Leaf_Redding: 0.3157, f1_Leaf_Variegation: 0.0000
2025-05-28 10:40:11 - __main__ - INFO - [main_execution_logic:363] - E21: Val f1_macro (0.1389) not better than 0.1955. Patience: 2/10
2025-05-28 10:40:11 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E21 End: Alloc 3161.6MB
2025-05-28 10:43:05 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 22 training finished. Avg Loss: 1.8927, Final LR for epoch: 9.05e-05, Opt Steps: 228
2025-05-28 10:43:23 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.8967, accuracy: 0.2352, f1_macro: 0.1744, f1_weighted: 0.1830, precision_macro: 0.1693, precision_weighted: 0.1723, recall_macro: 0.2192, recall_weighted: 0.2352, f1_Bacterial_Blight: 0.2443, f1_Curl_Virus: 0.3619, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.2721, f1_Leaf_Hopper_Jassids: 0.0570, f1_Leaf_Redding: 0.2854, f1_Leaf_Variegation: 0.0000
2025-05-28 10:43:23 - __main__ - INFO - [main_execution_logic:363] - E22: Val f1_macro (0.1744) not better than 0.1955. Patience: 3/10
2025-05-28 10:43:23 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E22 End: Alloc 3161.6MB
2025-05-28 10:46:17 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 23 training finished. Avg Loss: 1.8811, Final LR for epoch: 8.93e-05, Opt Steps: 228
2025-05-28 10:46:36 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9226, accuracy: 0.2544, f1_macro: 0.1841, f1_weighted: 0.1908, precision_macro: 0.1682, precision_weighted: 0.1749, recall_macro: 0.2497, recall_weighted: 0.2544, f1_Bacterial_Blight: 0.3529, f1_Curl_Virus: 0.3165, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.3327, f1_Leaf_Hopper_Jassids: 0.0081, f1_Leaf_Redding: 0.2787, f1_Leaf_Variegation: 0.0000
2025-05-28 10:46:36 - __main__ - INFO - [main_execution_logic:363] - E23: Val f1_macro (0.1841) not better than 0.1955. Patience: 4/10
2025-05-28 10:46:36 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E23 End: Alloc 3161.6MB
2025-05-28 10:49:30 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 24 training finished. Avg Loss: 1.8965, Final LR for epoch: 8.82e-05, Opt Steps: 228
2025-05-28 10:49:48 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.8877, accuracy: 0.2588, f1_macro: 0.1956, f1_weighted: 0.2024, precision_macro: 0.2023, precision_weighted: 0.2131, recall_macro: 0.2508, recall_weighted: 0.2588, f1_Bacterial_Blight: 0.3202, f1_Curl_Virus: 0.3434, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.3551, f1_Leaf_Hopper_Jassids: 0.0327, f1_Leaf_Redding: 0.2900, f1_Leaf_Variegation: 0.0277
2025-05-28 10:49:52 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:173] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_full_v1/checkpoints_full_v1/best_finetuned_hvt_full.pth
2025-05-28 10:49:52 - __main__ - INFO - [main_execution_logic:361] - E24: New best! Val f1_macro: 0.1956
2025-05-28 10:49:52 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E24 End: Alloc 3161.6MB
2025-05-28 10:52:46 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 25 training finished. Avg Loss: 1.8919, Final LR for epoch: 8.70e-05, Opt Steps: 228
2025-05-28 10:53:04 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9214, accuracy: 0.2248, f1_macro: 0.1572, f1_weighted: 0.1596, precision_macro: 0.3315, precision_weighted: 0.3207, recall_macro: 0.2195, recall_weighted: 0.2248, f1_Bacterial_Blight: 0.2025, f1_Curl_Virus: 0.3236, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.3290, f1_Leaf_Hopper_Jassids: 0.0804, f1_Leaf_Redding: 0.1388, f1_Leaf_Variegation: 0.0263
2025-05-28 10:53:04 - __main__ - INFO - [main_execution_logic:363] - E25: Val f1_macro (0.1572) not better than 0.1956. Patience: 1/10
2025-05-28 10:53:04 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E25 End: Alloc 3161.6MB
2025-05-28 10:55:58 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 26 training finished. Avg Loss: 1.8933, Final LR for epoch: 8.57e-05, Opt Steps: 228
2025-05-28 10:56:16 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9202, accuracy: 0.2352, f1_macro: 0.1537, f1_weighted: 0.1636, precision_macro: 0.1962, precision_weighted: 0.1964, recall_macro: 0.2206, recall_weighted: 0.2352, f1_Bacterial_Blight: 0.0637, f1_Curl_Virus: 0.3293, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.3592, f1_Leaf_Hopper_Jassids: 0.0344, f1_Leaf_Redding: 0.2737, f1_Leaf_Variegation: 0.0153
2025-05-28 10:56:16 - __main__ - INFO - [main_execution_logic:363] - E26: Val f1_macro (0.1537) not better than 0.1956. Patience: 2/10
2025-05-28 10:56:16 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E26 End: Alloc 3161.6MB
2025-05-28 10:59:09 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 27 training finished. Avg Loss: 1.8856, Final LR for epoch: 8.44e-05, Opt Steps: 228
2025-05-28 10:59:27 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9626, accuracy: 0.2232, f1_macro: 0.1448, f1_weighted: 0.1547, precision_macro: 0.1950, precision_weighted: 0.2107, recall_macro: 0.2130, recall_weighted: 0.2232, f1_Bacterial_Blight: 0.0000, f1_Curl_Virus: 0.3265, f1_Healthy_Leaf: 0.0212, f1_Herbicide_Growth_Damage: 0.3266, f1_Leaf_Hopper_Jassids: 0.0849, f1_Leaf_Redding: 0.2542, f1_Leaf_Variegation: 0.0000
2025-05-28 10:59:27 - __main__ - INFO - [main_execution_logic:363] - E27: Val f1_macro (0.1448) not better than 0.1956. Patience: 3/10
2025-05-28 10:59:27 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E27 End: Alloc 3161.6MB
