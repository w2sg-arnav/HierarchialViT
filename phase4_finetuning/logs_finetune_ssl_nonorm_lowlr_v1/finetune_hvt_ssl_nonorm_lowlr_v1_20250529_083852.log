2025-05-29 08:38:52 - root - INFO - [setup_logging:75] - Logging configured. Log file: /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/finetune_hvt_ssl_nonorm_lowlr_v1_20250529_083852.log. Logger 'root' Effective Level: DEBUG
2025-05-29 08:38:52 - __main__ - INFO - [main_execution_logic:191] - ======== Starting Phase 4: HVT Fine-tuning (Run ID: 20250529_083852) ========
2025-05-29 08:38:52 - __main__ - INFO - [main_execution_logic:192] - Full run configuration: {'seed': 42, 'device': 'cuda', 'PACKAGE_ROOT_PATH': '/teamspace/studios/this_studio/cvpr25/phase4_finetuning', 'PROJECT_ROOT_PATH': '/teamspace/studios/this_studio/cvpr25', 'log_dir': 'logs_finetune_ssl_nonorm_lowlr_v1', 'log_file_finetune': 'finetune_hvt_ssl_nonorm_lowlr_v1.log', 'best_model_filename': 'best_finetuned_hvt_ssl_nonorm_lowlr_v1.pth', 'final_model_filename': 'final_finetuned_hvt_ssl_nonorm_lowlr_v1.pth', 'checkpoint_save_dir_name': 'checkpoints_ssl_nonorm_lowlr_v1', 'data_root': '/teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection', 'original_dataset_name': 'Original Dataset', 'augmented_dataset_name': 'Augmented Dataset', 'img_size': (448, 448), 'num_classes': 7, 'train_split_ratio': 0.8, 'normalize_data': False, 'use_weighted_sampler': True, 'weighted_sampler_mode': 'inv_freq', 'use_weighted_loss': True, 'num_workers': 4, 'prefetch_factor': 2, 'model_architecture_name': 'DiseaseAwareHVT_SSL_NoNorm_LowLR_Finetune_v1', 'pretrained_checkpoint_path': '/teamspace/studios/this_studio/cvpr25/phase3_pretraining/pretrain_checkpoints_hvt_xl/hvt_xl_simclr_t4_resumed_best_probe.pth', 'load_pretrained_backbone': True, 'hvt_params_for_model_init': {'patch_size': 14, 'embed_dim_rgb': 192, 'embed_dim_spectral': 192, 'spectral_channels': 0, 'depths': [3, 6, 24, 3], 'num_heads': [6, 12, 24, 48], 'mlp_ratio': 4.0, 'qkv_bias': True, 'model_drop_rate': 0.1, 'attn_drop_rate': 0.0, 'drop_path_rate': 0.1, 'norm_layer_name': 'LayerNorm', 'use_dfca': False, 'use_gradient_checkpointing': True, 'ssl_enable_mae': False, 'ssl_enable_contrastive': False, 'enable_consistency_loss_heads': False, 'dfca_embed_dim_match_rgb': True, 'dfca_num_heads': 32, 'dfca_drop_rate': 0.1, 'dfca_use_disease_mask': True, 'ssl_mae_mask_ratio': 0.75, 'ssl_mae_decoder_dim': 64, 'ssl_mae_norm_pix_loss': True, 'ssl_contrastive_projector_dim': 128, 'ssl_contrastive_projector_depth': 2}, 'enable_torch_compile': False, 'torch_compile_mode': 'reduce-overhead', 'matmul_precision': 'high', 'cudnn_benchmark': True, 'freeze_backbone_epochs': 10, 'epochs': 100, 'batch_size': 16, 'accumulation_steps': 2, 'amp_enabled': True, 'clip_grad_norm': 1.0, 'log_interval': 20, 'optimizer': 'AdamW', 'optimizer_params': {'betas': (0.9, 0.999), 'eps': 1e-08}, 'weight_decay': 0.05, 'lr_head_frozen_phase': 5e-05, 'lr_backbone_unfrozen_phase': 1e-05, 'lr_head_unfrozen_phase': 2e-05, 'scheduler': 'WarmupCosine', 'warmup_epochs': 5, 'eta_min_lr': 1e-07, 'loss_label_smoothing': 0.1, 'augmentations_enabled': True, 'evaluate_every_n_epochs': 1, 'early_stopping_patience': 15, 'metric_to_monitor_early_stopping': 'f1_macro', 'tta_enabled_val': False, 'ssl_pretrain_img_size_fallback': (448, 448)}
2025-05-29 08:38:52 - __main__ - INFO - [set_global_seed:69] - Global random seed set to: 42
2025-05-29 08:38:52 - __main__ - INFO - [main_execution_logic:196] - Using device: cuda. GPU: Tesla T4
2025-05-29 08:38:52 - phase4_finetuning.dataset - INFO - [__init__:53] - [DATASET INIT - train] Root: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection, ImgSize: (448, 448), Normalize: False
2025-05-29 08:38:52 - phase4_finetuning.dataset - INFO - [__init__:74] - [DATASET INIT - train] Scanning: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection/Original Dataset
2025-05-29 08:38:52 - phase4_finetuning.dataset - INFO - [__init__:74] - [DATASET INIT - train] Scanning: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection/Augmented Dataset
2025-05-29 08:38:53 - phase4_finetuning.dataset - INFO - [__init__:105] - [DATASET INIT - train] Total valid image paths collected: 9137 from ~9137 items considered.
2025-05-29 08:38:53 - phase4_finetuning.dataset - INFO - [__init__:117] - [DATASET INIT - train] Dataset split size: 7309 samples.
2025-05-29 08:38:53 - phase4_finetuning.dataset - INFO - [__init__:128] - [DATASET INIT - train] Base RGB Transforms: Compose(
      ToImage()
      ToDtype(scale=True)
      Resize(size=[448, 448], interpolation=InterpolationMode.BICUBIC, antialias=True)
)
2025-05-29 08:38:53 - phase4_finetuning.dataset - INFO - [__init__:53] - [DATASET INIT - val] Root: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection, ImgSize: (448, 448), Normalize: False
2025-05-29 08:38:53 - phase4_finetuning.dataset - INFO - [__init__:74] - [DATASET INIT - val] Scanning: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection/Original Dataset
2025-05-29 08:38:53 - phase4_finetuning.dataset - INFO - [__init__:74] - [DATASET INIT - val] Scanning: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection/Augmented Dataset
2025-05-29 08:38:53 - phase4_finetuning.dataset - INFO - [__init__:105] - [DATASET INIT - val] Total valid image paths collected: 9137 from ~9137 items considered.
2025-05-29 08:38:53 - phase4_finetuning.dataset - INFO - [__init__:117] - [DATASET INIT - val] Dataset split size: 1828 samples.
2025-05-29 08:38:53 - phase4_finetuning.dataset - INFO - [__init__:128] - [DATASET INIT - val] Base RGB Transforms: Compose(
      ToImage()
      ToDtype(scale=True)
      Resize(size=[448, 448], interpolation=InterpolationMode.BICUBIC, antialias=True)
)
2025-05-29 08:38:53 - phase4_finetuning.dataset - INFO - [get_class_weights:185] - Computed class weights (inv_freq for loss) for split 'train': [1.029 0.912 1.065 1.014 1.05  0.833 1.172]
2025-05-29 08:38:53 - __main__ - INFO - [main_execution_logic:237] - Using WeightedRandomSampler with 'inv_freq' mode. Per-class weights from dataset: [1.029 0.912 1.065 1.014 1.05  0.833 1.172]
2025-05-29 08:38:53 - __main__ - INFO - [main_execution_logic:254] - WeightedRandomSampler enabled (mode: inv_freq).
2025-05-29 08:38:53 - __main__ - INFO - [main_execution_logic:261] - Dataloaders created. Train batches: 456, Val batches: 115
2025-05-29 08:38:53 - phase2_model.models.hvt - INFO - [create_disease_aware_hvt:602] - Factory: Creating DiseaseAwareHVT for img_size: (448, 448), num_classes: 7
2025-05-29 08:38:56 - phase2_model.models.hvt - INFO - [__init__:325] - HVT: Running RGB stream only. No fusion.
2025-05-29 08:38:58 - phase2_model.models.hvt - INFO - [__init__:359] - DiseaseAwareHVT initialized for image size (448, 448) and 7 classes.
2025-05-29 08:38:58 - __main__.load_and_prepare_hvt_model - INFO - [load_and_prepare_hvt_model:121] - Loading SSL backbone weights from: /teamspace/studios/this_studio/cvpr25/phase3_pretraining/pretrain_checkpoints_hvt_xl/hvt_xl_simclr_t4_resumed_best_probe.pth
2025-05-29 08:39:01 - __main__.load_and_prepare_hvt_model - INFO - [load_and_prepare_hvt_model:133] - SSL and Finetune img_size match: (448, 448).
2025-05-29 08:39:01 - __main__.load_and_prepare_hvt_model - INFO - [load_and_prepare_hvt_model:159] - SSL Backbone weights loaded: 450 direct, 0 PE interpolated, 2 head layers skipped.
2025-05-29 08:39:01 - __main__.load_and_prepare_hvt_model - WARNING - [load_and_prepare_hvt_model:160] - Missing keys when loading SSL backbone: ['classifier_head.weight', 'classifier_head.bias']
2025-05-29 08:39:01 - __main__.load_and_prepare_hvt_model - INFO - [load_and_prepare_hvt_model:166] - Re-initialized HVT classifier_head for 7 classes (in_features=1536).
2025-05-29 08:39:02 - __main__ - INFO - [main_execution_logic:266] - Model ready. Total params: 273,615,751, Trainable params: 273,615,751
2025-05-29 08:39:02 - phase4_finetuning.utils.augmentations - INFO - [__init__:23] - FinetuneAugmentation initialized with enhanced transforms.
2025-05-29 08:39:02 - phase4_finetuning.utils.augmentations - DEBUG - [__init__:24] - Augmentation pipeline: Compose(
      RandomHorizontalFlip(p=0.5)
      RandomVerticalFlip(p=0.3)
      RandomRotation(degrees=[-30.0, 30.0], interpolation=InterpolationMode.NEAREST, expand=False, fill=0)
      ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.7, 1.3), hue=(-0.2, 0.2))
      RandomAffine(degrees=[-15.0, 15.0], translate=(0.2, 0.2), scale=(0.8, 1.2), shear=[-5.0, 5.0], interpolation=InterpolationMode.NEAREST, fill=0)
      RandomApply(    GaussianBlur(kernel_size=(3, 7), sigma=[0.1, 2.0]))
      RandomErasing(p=0.2, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=[0.0], inplace=False)
      RandomSolarize(p=0.1, threshold=0.5)
)
2025-05-29 08:39:02 - __main__ - INFO - [main_execution_logic:280] - Using weighted CrossEntropyLoss. Weights: [1.029 0.912 1.065 1.014 1.05  0.833 1.172]
2025-05-29 08:39:02 - __main__ - INFO - [main_execution_logic:297] - Optimizer initial setup: Backbone frozen. Head LR: 5.00e-05, Backbone LR: 0.00e+00
2025-05-29 08:39:02 - __main__ - INFO - [main_execution_logic:325] - Optimizer: AdamW created with effective defaults: {'lr': 2e-05, 'betas': (0.9, 0.999), 'eps': 1e-08, 'weight_decay': 0.05, 'amsgrad': False, 'foreach': None, 'maximize': False, 'capturable': False, 'differentiable': False, 'fused': None}
2025-05-29 08:39:02 - __main__ - INFO - [main_execution_logic:328] -   Group 'head': Initial LR 5.00e-05, Weight Decay 5.00e-02
2025-05-29 08:39:02 - __main__ - INFO - [main_execution_logic:328] -   Group 'backbone': Initial LR 0.00e+00, Weight Decay 5.00e-02
2025-05-29 08:39:02 - __main__ - INFO - [main_execution_logic:346] - Scheduler: WarmupCosine (per-step). WU Steps: 1140, Total Steps: 22800, Eta Min used by lambda: 1e-07
2025-05-29 08:39:02 - phase4_finetuning.finetune.trainer - INFO - [__init__:44] - Finetuner initialized: device=cuda, accum_steps=2, lr_sched_on_batch=True, AMP=True
2025-05-29 08:39:02 - phase4_finetuning.finetune.trainer - INFO - [__init__:46] - Using training augmentations: FinetuneAugmentation
2025-05-29 08:39:02 - __main__ - INFO - [main_execution_logic:376] - Checkpoints will be saved in: /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/checkpoints_ssl_nonorm_lowlr_v1
2025-05-29 08:39:02 - __main__ - DEBUG - [main_execution_logic:380] - DEBUG INIT: Opt Group 0 ('head'): Current LR 0.00e+00, Scheduler Base LR 5.00e-05
2025-05-29 08:39:02 - __main__ - DEBUG - [main_execution_logic:380] - DEBUG INIT: Opt Group 1 ('backbone'): Current LR 0.00e+00, Scheduler Base LR 0.00e+00
2025-05-29 08:39:02 - __main__ - INFO - [main_execution_logic:383] - Starting fine-tuning for 100 epochs. Monitor: 'f1_macro'. Backbone frozen for initial 10 epochs.
2025-05-29 08:39:02 - __main__ - INFO - [main_execution_logic:405] - Epoch 1: Starting in Frozen Backbone phase.
2025-05-29 08:39:02 - __main__ - INFO - [main_execution_logic:410] -   Param group 'head': Current optimizer LR at epoch start: 0.00e+00
2025-05-29 08:39:02 - __main__ - INFO - [main_execution_logic:412] -     LambdaLR base_lr for this group: 5.00e-05
2025-05-29 08:39:02 - __main__ - INFO - [main_execution_logic:410] -   Param group 'backbone': Current optimizer LR at epoch start: 0.00e+00
2025-05-29 08:39:02 - __main__ - INFO - [main_execution_logic:412] -     LambdaLR base_lr for this group: 0.00e+00
2025-05-29 08:40:13 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 1 training finished. Avg Loss: 2.0180, Final LR for epoch: 1.00e-05, Opt Steps: 228
2025-05-29 08:40:31 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.9465, accuracy: 0.1822, f1_macro: 0.1310, f1_weighted: 0.1250, precision_macro: 0.1384, precision_weighted: 0.1326, recall_macro: 0.1961, recall_weighted: 0.1822, f1_Bacterial_Blight: 0.0000, f1_Curl_Virus: 0.1129, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.5499, f1_Leaf_Hopper_Jassids: 0.2469, f1_Leaf_Redding: 0.0000, f1_Leaf_Variegation: 0.0074
2025-05-29 08:40:34 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:189] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/checkpoints_ssl_nonorm_lowlr_v1/best_finetuned_hvt_ssl_nonorm_lowlr_v1.pth
2025-05-29 08:40:34 - __main__ - INFO - [main_execution_logic:465] - E1: New best! Val f1_macro: 0.1310
2025-05-29 08:40:34 - __main__ - INFO - [main_execution_logic:478] - Epoch 1 completed in 92.21s.
2025-05-29 08:40:34 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E1 End: Alloc 1063.4MB, Reserved 1366.0MB
2025-05-29 08:41:43 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 2 training finished. Avg Loss: 1.8633, Final LR for epoch: 2.00e-05, Opt Steps: 228
2025-05-29 08:42:00 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.8099, accuracy: 0.2763, f1_macro: 0.1800, f1_weighted: 0.1654, precision_macro: 0.3023, precision_weighted: 0.2810, recall_macro: 0.3026, recall_weighted: 0.2763, f1_Bacterial_Blight: 0.0335, f1_Curl_Virus: 0.0576, f1_Healthy_Leaf: 0.0070, f1_Herbicide_Growth_Damage: 0.5408, f1_Leaf_Hopper_Jassids: 0.1828, f1_Leaf_Redding: 0.0000, f1_Leaf_Variegation: 0.4380
2025-05-29 08:42:05 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:189] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/checkpoints_ssl_nonorm_lowlr_v1/best_finetuned_hvt_ssl_nonorm_lowlr_v1.pth
2025-05-29 08:42:05 - __main__ - INFO - [main_execution_logic:465] - E2: New best! Val f1_macro: 0.1800
2025-05-29 08:42:05 - __main__ - INFO - [main_execution_logic:478] - Epoch 2 completed in 90.47s.
2025-05-29 08:42:05 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E2 End: Alloc 1063.4MB, Reserved 2384.0MB
2025-05-29 08:43:14 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 3 training finished. Avg Loss: 1.7807, Final LR for epoch: 3.00e-05, Opt Steps: 228
2025-05-29 08:43:31 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.7128, accuracy: 0.3419, f1_macro: 0.2471, f1_weighted: 0.2505, precision_macro: 0.3425, precision_weighted: 0.3549, recall_macro: 0.3530, recall_weighted: 0.3419, f1_Bacterial_Blight: 0.1300, f1_Curl_Virus: 0.0195, f1_Healthy_Leaf: 0.0211, f1_Herbicide_Growth_Damage: 0.5110, f1_Leaf_Hopper_Jassids: 0.1023, f1_Leaf_Redding: 0.5237, f1_Leaf_Variegation: 0.4218
2025-05-29 08:43:34 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:189] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/checkpoints_ssl_nonorm_lowlr_v1/best_finetuned_hvt_ssl_nonorm_lowlr_v1.pth
2025-05-29 08:43:34 - __main__ - INFO - [main_execution_logic:465] - E3: New best! Val f1_macro: 0.2471
2025-05-29 08:43:34 - __main__ - INFO - [main_execution_logic:478] - Epoch 3 completed in 89.29s.
2025-05-29 08:43:34 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E3 End: Alloc 1063.4MB, Reserved 2384.0MB
2025-05-29 08:44:44 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 4 training finished. Avg Loss: 1.7268, Final LR for epoch: 4.00e-05, Opt Steps: 228
2025-05-29 08:45:01 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.6618, accuracy: 0.3725, f1_macro: 0.2937, f1_weighted: 0.2980, precision_macro: 0.3770, precision_weighted: 0.3836, recall_macro: 0.3704, recall_weighted: 0.3725, f1_Bacterial_Blight: 0.2202, f1_Curl_Virus: 0.0964, f1_Healthy_Leaf: 0.1063, f1_Herbicide_Growth_Damage: 0.5067, f1_Leaf_Hopper_Jassids: 0.1086, f1_Leaf_Redding: 0.5578, f1_Leaf_Variegation: 0.4595
2025-05-29 08:45:05 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:189] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/checkpoints_ssl_nonorm_lowlr_v1/best_finetuned_hvt_ssl_nonorm_lowlr_v1.pth
2025-05-29 08:45:05 - __main__ - INFO - [main_execution_logic:465] - E4: New best! Val f1_macro: 0.2937
2025-05-29 08:45:05 - __main__ - INFO - [main_execution_logic:478] - Epoch 4 completed in 90.50s.
2025-05-29 08:45:05 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E4 End: Alloc 1063.4MB, Reserved 2384.0MB
2025-05-29 08:46:13 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 5 training finished. Avg Loss: 1.6885, Final LR for epoch: 5.00e-05, Opt Steps: 228
2025-05-29 08:46:31 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.6304, accuracy: 0.3687, f1_macro: 0.2955, f1_weighted: 0.2961, precision_macro: 0.3927, precision_weighted: 0.3907, recall_macro: 0.3607, recall_weighted: 0.3687, f1_Bacterial_Blight: 0.2895, f1_Curl_Virus: 0.0506, f1_Healthy_Leaf: 0.1720, f1_Herbicide_Growth_Damage: 0.5329, f1_Leaf_Hopper_Jassids: 0.1375, f1_Leaf_Redding: 0.4733, f1_Leaf_Variegation: 0.4125
2025-05-29 08:46:34 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:189] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/checkpoints_ssl_nonorm_lowlr_v1/best_finetuned_hvt_ssl_nonorm_lowlr_v1.pth
2025-05-29 08:46:34 - __main__ - INFO - [main_execution_logic:465] - E5: New best! Val f1_macro: 0.2955
2025-05-29 08:46:34 - __main__ - INFO - [main_execution_logic:478] - Epoch 5 completed in 89.83s.
2025-05-29 08:46:34 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E5 End: Alloc 1063.4MB, Reserved 2384.0MB
2025-05-29 08:47:45 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 6 training finished. Avg Loss: 1.6587, Final LR for epoch: 5.00e-05, Opt Steps: 228
2025-05-29 08:48:02 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.6660, accuracy: 0.3397, f1_macro: 0.2528, f1_weighted: 0.2536, precision_macro: 0.3663, precision_weighted: 0.3615, recall_macro: 0.3281, recall_weighted: 0.3397, f1_Bacterial_Blight: 0.2865, f1_Curl_Virus: 0.0121, f1_Healthy_Leaf: 0.0943, f1_Herbicide_Growth_Damage: 0.5192, f1_Leaf_Hopper_Jassids: 0.0959, f1_Leaf_Redding: 0.4374, f1_Leaf_Variegation: 0.3242
2025-05-29 08:48:02 - __main__ - INFO - [main_execution_logic:469] - E6: Val f1_macro (0.2528) not better than best (0.2955). Patience: 1/15
2025-05-29 08:48:02 - __main__ - INFO - [main_execution_logic:478] - Epoch 6 completed in 87.89s.
2025-05-29 08:48:02 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E6 End: Alloc 1063.4MB, Reserved 2384.0MB
2025-05-29 08:49:10 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 7 training finished. Avg Loss: 1.6537, Final LR for epoch: 4.99e-05, Opt Steps: 228
2025-05-29 08:49:27 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.6810, accuracy: 0.3326, f1_macro: 0.2440, f1_weighted: 0.2472, precision_macro: 0.3790, precision_weighted: 0.3752, recall_macro: 0.3191, recall_weighted: 0.3326, f1_Bacterial_Blight: 0.2762, f1_Curl_Virus: 0.0616, f1_Healthy_Leaf: 0.0878, f1_Herbicide_Growth_Damage: 0.5260, f1_Leaf_Hopper_Jassids: 0.0890, f1_Leaf_Redding: 0.4323, f1_Leaf_Variegation: 0.2349
2025-05-29 08:49:27 - __main__ - INFO - [main_execution_logic:469] - E7: Val f1_macro (0.2440) not better than best (0.2955). Patience: 2/15
2025-05-29 08:49:27 - __main__ - INFO - [main_execution_logic:478] - Epoch 7 completed in 84.94s.
2025-05-29 08:49:27 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E7 End: Alloc 1063.4MB, Reserved 2384.0MB
2025-05-29 08:50:36 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 8 training finished. Avg Loss: 1.6493, Final LR for epoch: 4.99e-05, Opt Steps: 228
2025-05-29 08:50:53 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.6983, accuracy: 0.3490, f1_macro: 0.2655, f1_weighted: 0.2678, precision_macro: 0.3267, precision_weighted: 0.3229, recall_macro: 0.3381, recall_weighted: 0.3490, f1_Bacterial_Blight: 0.2493, f1_Curl_Virus: 0.1307, f1_Healthy_Leaf: 0.0071, f1_Herbicide_Growth_Damage: 0.5132, f1_Leaf_Hopper_Jassids: 0.1220, f1_Leaf_Redding: 0.4751, f1_Leaf_Variegation: 0.3611
2025-05-29 08:50:53 - __main__ - INFO - [main_execution_logic:469] - E8: Val f1_macro (0.2655) not better than best (0.2955). Patience: 3/15
2025-05-29 08:50:53 - __main__ - INFO - [main_execution_logic:478] - Epoch 8 completed in 85.49s.
2025-05-29 08:50:53 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E8 End: Alloc 1063.4MB, Reserved 2384.0MB
2025-05-29 08:52:01 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 9 training finished. Avg Loss: 1.6365, Final LR for epoch: 4.98e-05, Opt Steps: 228
2025-05-29 08:52:18 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.6858, accuracy: 0.3534, f1_macro: 0.2637, f1_weighted: 0.2640, precision_macro: 0.3745, precision_weighted: 0.3721, recall_macro: 0.3435, recall_weighted: 0.3534, f1_Bacterial_Blight: 0.3115, f1_Curl_Virus: 0.0242, f1_Healthy_Leaf: 0.0819, f1_Herbicide_Growth_Damage: 0.5400, f1_Leaf_Hopper_Jassids: 0.0460, f1_Leaf_Redding: 0.4514, f1_Leaf_Variegation: 0.3908
2025-05-29 08:52:18 - __main__ - INFO - [main_execution_logic:469] - E9: Val f1_macro (0.2637) not better than best (0.2955). Patience: 4/15
2025-05-29 08:52:18 - __main__ - INFO - [main_execution_logic:478] - Epoch 9 completed in 85.08s.
2025-05-29 08:52:18 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E9 End: Alloc 1063.4MB, Reserved 2384.0MB
2025-05-29 08:53:26 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 10 training finished. Avg Loss: 1.6404, Final LR for epoch: 4.97e-05, Opt Steps: 228
2025-05-29 08:53:44 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.6675, accuracy: 0.3594, f1_macro: 0.2851, f1_weighted: 0.2873, precision_macro: 0.4086, precision_weighted: 0.4053, recall_macro: 0.3481, recall_weighted: 0.3594, f1_Bacterial_Blight: 0.3286, f1_Curl_Virus: 0.1036, f1_Healthy_Leaf: 0.1130, f1_Herbicide_Growth_Damage: 0.5485, f1_Leaf_Hopper_Jassids: 0.1607, f1_Leaf_Redding: 0.4660, f1_Leaf_Variegation: 0.2749
2025-05-29 08:53:44 - __main__ - INFO - [main_execution_logic:469] - E10: Val f1_macro (0.2851) not better than best (0.2955). Patience: 5/15
2025-05-29 08:53:44 - __main__ - INFO - [main_execution_logic:478] - Epoch 10 completed in 86.61s.
2025-05-29 08:53:44 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E10 End: Alloc 1063.4MB, Reserved 2384.0MB
2025-05-29 08:53:44 - __main__ - INFO - [main_execution_logic:415] - Epoch 11: Backbone UNPROZEN. Updating LRs to unfrozen phase values.
2025-05-29 08:53:44 - __main__ - INFO - [main_execution_logic:427] -   Updating head group optimizer LR from 4.97e-05 to 2.00e-05
2025-05-29 08:53:44 - __main__ - INFO - [main_execution_logic:432] -     Updating LambdaLR's base_lr for group 'head' (idx 0) from 5.00e-05 to 2.00e-05
2025-05-29 08:53:44 - __main__ - INFO - [main_execution_logic:427] -   Updating backbone group optimizer LR from 0.00e+00 to 1.00e-05
2025-05-29 08:53:44 - __main__ - INFO - [main_execution_logic:432] -     Updating LambdaLR's base_lr for group 'backbone' (idx 1) from 0.00e+00 to 1.00e-05
2025-05-29 08:53:44 - __main__ - INFO - [main_execution_logic:436] -   Effective Base LRs for scheduler (after unfreezing update):
2025-05-29 08:53:44 - __main__ - INFO - [main_execution_logic:443] -     Opt Group 0 ('head'): Current LR 2.000e-05 (Scheduler base: 2.000e-05)
2025-05-29 08:53:44 - __main__ - INFO - [main_execution_logic:443] -     Opt Group 1 ('backbone'): Current LR 1.000e-05 (Scheduler base: 1.000e-05)
2025-05-29 08:57:24 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 11 training finished. Avg Loss: 1.6033, Final LR for epoch: 1.98e-05, Opt Steps: 228
2025-05-29 08:57:41 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.6739, accuracy: 0.3796, f1_macro: 0.3120, f1_weighted: 0.3137, precision_macro: 0.4344, precision_weighted: 0.4332, recall_macro: 0.3701, recall_weighted: 0.3796, f1_Bacterial_Blight: 0.3519, f1_Curl_Virus: 0.1508, f1_Healthy_Leaf: 0.1074, f1_Herbicide_Growth_Damage: 0.5479, f1_Leaf_Hopper_Jassids: 0.1726, f1_Leaf_Redding: 0.4948, f1_Leaf_Variegation: 0.3585
2025-05-29 08:57:45 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:189] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/checkpoints_ssl_nonorm_lowlr_v1/best_finetuned_hvt_ssl_nonorm_lowlr_v1.pth
2025-05-29 08:57:45 - __main__ - INFO - [main_execution_logic:465] - E11: New best! Val f1_macro: 0.3120
2025-05-29 08:57:45 - __main__ - INFO - [main_execution_logic:478] - Epoch 11 completed in 240.19s.
2025-05-29 08:57:45 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E11 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 09:01:25 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 12 training finished. Avg Loss: 1.5671, Final LR for epoch: 1.97e-05, Opt Steps: 228
2025-05-29 09:01:43 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.5910, accuracy: 0.4207, f1_macro: 0.3646, f1_weighted: 0.3630, precision_macro: 0.4609, precision_weighted: 0.4614, recall_macro: 0.4170, recall_weighted: 0.4207, f1_Bacterial_Blight: 0.3903, f1_Curl_Virus: 0.1308, f1_Healthy_Leaf: 0.1564, f1_Herbicide_Growth_Damage: 0.5861, f1_Leaf_Hopper_Jassids: 0.2267, f1_Leaf_Redding: 0.5393, f1_Leaf_Variegation: 0.5224
2025-05-29 09:01:46 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:189] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/checkpoints_ssl_nonorm_lowlr_v1/best_finetuned_hvt_ssl_nonorm_lowlr_v1.pth
2025-05-29 09:01:46 - __main__ - INFO - [main_execution_logic:465] - E12: New best! Val f1_macro: 0.3646
2025-05-29 09:01:46 - __main__ - INFO - [main_execution_logic:478] - Epoch 12 completed in 241.58s.
2025-05-29 09:01:46 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E12 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 09:05:26 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 13 training finished. Avg Loss: 1.5281, Final LR for epoch: 1.97e-05, Opt Steps: 228
2025-05-29 09:05:42 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.5282, accuracy: 0.4535, f1_macro: 0.3951, f1_weighted: 0.3932, precision_macro: 0.4720, precision_weighted: 0.4745, recall_macro: 0.4536, recall_weighted: 0.4535, f1_Bacterial_Blight: 0.4113, f1_Curl_Virus: 0.1547, f1_Healthy_Leaf: 0.2141, f1_Herbicide_Growth_Damage: 0.6025, f1_Leaf_Hopper_Jassids: 0.1970, f1_Leaf_Redding: 0.5617, f1_Leaf_Variegation: 0.6245
2025-05-29 09:05:45 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:189] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/checkpoints_ssl_nonorm_lowlr_v1/best_finetuned_hvt_ssl_nonorm_lowlr_v1.pth
2025-05-29 09:05:45 - __main__ - INFO - [main_execution_logic:465] - E13: New best! Val f1_macro: 0.3951
2025-05-29 09:05:45 - __main__ - INFO - [main_execution_logic:478] - Epoch 13 completed in 239.16s.
2025-05-29 09:05:45 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E13 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 09:09:25 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 14 training finished. Avg Loss: 1.4804, Final LR for epoch: 1.96e-05, Opt Steps: 228
2025-05-29 09:09:42 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.5086, accuracy: 0.4721, f1_macro: 0.4189, f1_weighted: 0.4166, precision_macro: 0.5135, precision_weighted: 0.5180, recall_macro: 0.4738, recall_weighted: 0.4721, f1_Bacterial_Blight: 0.4362, f1_Curl_Virus: 0.2216, f1_Healthy_Leaf: 0.1847, f1_Herbicide_Growth_Damage: 0.6273, f1_Leaf_Hopper_Jassids: 0.2323, f1_Leaf_Redding: 0.5791, f1_Leaf_Variegation: 0.6509
2025-05-29 09:09:45 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:189] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/checkpoints_ssl_nonorm_lowlr_v1/best_finetuned_hvt_ssl_nonorm_lowlr_v1.pth
2025-05-29 09:09:45 - __main__ - INFO - [main_execution_logic:465] - E14: New best! Val f1_macro: 0.4189
2025-05-29 09:09:45 - __main__ - INFO - [main_execution_logic:478] - Epoch 14 completed in 239.69s.
2025-05-29 09:09:45 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E14 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 09:13:25 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 15 training finished. Avg Loss: 1.4473, Final LR for epoch: 1.95e-05, Opt Steps: 228
2025-05-29 09:13:42 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.4825, accuracy: 0.4814, f1_macro: 0.4375, f1_weighted: 0.4351, precision_macro: 0.5217, precision_weighted: 0.5255, recall_macro: 0.4826, recall_weighted: 0.4814, f1_Bacterial_Blight: 0.4270, f1_Curl_Virus: 0.2385, f1_Healthy_Leaf: 0.2174, f1_Herbicide_Growth_Damage: 0.6402, f1_Leaf_Hopper_Jassids: 0.2920, f1_Leaf_Redding: 0.5910, f1_Leaf_Variegation: 0.6561
2025-05-29 09:13:46 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:189] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/checkpoints_ssl_nonorm_lowlr_v1/best_finetuned_hvt_ssl_nonorm_lowlr_v1.pth
2025-05-29 09:13:46 - __main__ - INFO - [main_execution_logic:465] - E15: New best! Val f1_macro: 0.4375
2025-05-29 09:13:46 - __main__ - INFO - [main_execution_logic:478] - Epoch 15 completed in 241.02s.
2025-05-29 09:13:46 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E15 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 09:17:27 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 16 training finished. Avg Loss: 1.4245, Final LR for epoch: 1.93e-05, Opt Steps: 228
2025-05-29 09:17:44 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.4293, accuracy: 0.5098, f1_macro: 0.4681, f1_weighted: 0.4648, precision_macro: 0.5583, precision_weighted: 0.5661, recall_macro: 0.5169, recall_weighted: 0.5098, f1_Bacterial_Blight: 0.4584, f1_Curl_Virus: 0.2428, f1_Healthy_Leaf: 0.2583, f1_Herbicide_Growth_Damage: 0.6573, f1_Leaf_Hopper_Jassids: 0.3557, f1_Leaf_Redding: 0.6154, f1_Leaf_Variegation: 0.6892
2025-05-29 09:17:48 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:189] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/checkpoints_ssl_nonorm_lowlr_v1/best_finetuned_hvt_ssl_nonorm_lowlr_v1.pth
2025-05-29 09:17:48 - __main__ - INFO - [main_execution_logic:465] - E16: New best! Val f1_macro: 0.4681
2025-05-29 09:17:48 - __main__ - INFO - [main_execution_logic:478] - Epoch 16 completed in 241.82s.
2025-05-29 09:17:48 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E16 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 09:21:27 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 17 training finished. Avg Loss: 1.3970, Final LR for epoch: 1.92e-05, Opt Steps: 228
2025-05-29 09:21:44 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.4085, accuracy: 0.5159, f1_macro: 0.4769, f1_weighted: 0.4735, precision_macro: 0.5698, precision_weighted: 0.5777, recall_macro: 0.5227, recall_weighted: 0.5159, f1_Bacterial_Blight: 0.4441, f1_Curl_Virus: 0.2435, f1_Healthy_Leaf: 0.2959, f1_Herbicide_Growth_Damage: 0.6949, f1_Leaf_Hopper_Jassids: 0.3458, f1_Leaf_Redding: 0.6095, f1_Leaf_Variegation: 0.7047
2025-05-29 09:21:48 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:189] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/checkpoints_ssl_nonorm_lowlr_v1/best_finetuned_hvt_ssl_nonorm_lowlr_v1.pth
2025-05-29 09:21:48 - __main__ - INFO - [main_execution_logic:465] - E17: New best! Val f1_macro: 0.4769
2025-05-29 09:21:48 - __main__ - INFO - [main_execution_logic:478] - Epoch 17 completed in 240.00s.
2025-05-29 09:21:48 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E17 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 09:25:27 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 18 training finished. Avg Loss: 1.3906, Final LR for epoch: 1.91e-05, Opt Steps: 228
2025-05-29 09:25:45 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.3683, accuracy: 0.5350, f1_macro: 0.4998, f1_weighted: 0.4969, precision_macro: 0.5613, precision_weighted: 0.5672, recall_macro: 0.5414, recall_weighted: 0.5350, f1_Bacterial_Blight: 0.4700, f1_Curl_Virus: 0.2809, f1_Healthy_Leaf: 0.3520, f1_Herbicide_Growth_Damage: 0.6929, f1_Leaf_Hopper_Jassids: 0.3650, f1_Leaf_Redding: 0.6209, f1_Leaf_Variegation: 0.7170
2025-05-29 09:25:48 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:189] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/checkpoints_ssl_nonorm_lowlr_v1/best_finetuned_hvt_ssl_nonorm_lowlr_v1.pth
2025-05-29 09:25:48 - __main__ - INFO - [main_execution_logic:465] - E18: New best! Val f1_macro: 0.4998
2025-05-29 09:25:48 - __main__ - INFO - [main_execution_logic:478] - Epoch 18 completed in 240.49s.
2025-05-29 09:25:48 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E18 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 09:29:27 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 19 training finished. Avg Loss: 1.3839, Final LR for epoch: 1.89e-05, Opt Steps: 228
2025-05-29 09:29:44 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.3508, accuracy: 0.5394, f1_macro: 0.5099, f1_weighted: 0.5056, precision_macro: 0.5818, precision_weighted: 0.5877, recall_macro: 0.5490, recall_weighted: 0.5394, f1_Bacterial_Blight: 0.4758, f1_Curl_Virus: 0.3152, f1_Healthy_Leaf: 0.3134, f1_Herbicide_Growth_Damage: 0.7170, f1_Leaf_Hopper_Jassids: 0.3962, f1_Leaf_Redding: 0.6113, f1_Leaf_Variegation: 0.7402
2025-05-29 09:29:47 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:189] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/checkpoints_ssl_nonorm_lowlr_v1/best_finetuned_hvt_ssl_nonorm_lowlr_v1.pth
2025-05-29 09:29:47 - __main__ - INFO - [main_execution_logic:465] - E19: New best! Val f1_macro: 0.5099
2025-05-29 09:29:47 - __main__ - INFO - [main_execution_logic:478] - Epoch 19 completed in 238.92s.
2025-05-29 09:29:47 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E19 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 09:33:26 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 20 training finished. Avg Loss: 1.3722, Final LR for epoch: 1.88e-05, Opt Steps: 228
2025-05-29 09:33:43 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.3372, accuracy: 0.5547, f1_macro: 0.5321, f1_weighted: 0.5281, precision_macro: 0.5998, precision_weighted: 0.6057, recall_macro: 0.5626, recall_weighted: 0.5547, f1_Bacterial_Blight: 0.4784, f1_Curl_Virus: 0.3204, f1_Healthy_Leaf: 0.3861, f1_Herbicide_Growth_Damage: 0.7336, f1_Leaf_Hopper_Jassids: 0.4260, f1_Leaf_Redding: 0.6270, f1_Leaf_Variegation: 0.7531
2025-05-29 09:33:46 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:189] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/checkpoints_ssl_nonorm_lowlr_v1/best_finetuned_hvt_ssl_nonorm_lowlr_v1.pth
2025-05-29 09:33:46 - __main__ - INFO - [main_execution_logic:465] - E20: New best! Val f1_macro: 0.5321
2025-05-29 09:33:46 - __main__ - INFO - [main_execution_logic:478] - Epoch 20 completed in 239.10s.
2025-05-29 09:33:46 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E20 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 09:37:25 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 21 training finished. Avg Loss: 1.3328, Final LR for epoch: 1.86e-05, Opt Steps: 228
2025-05-29 09:37:42 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.3295, accuracy: 0.5585, f1_macro: 0.5302, f1_weighted: 0.5260, precision_macro: 0.5889, precision_weighted: 0.5939, recall_macro: 0.5665, recall_weighted: 0.5585, f1_Bacterial_Blight: 0.4764, f1_Curl_Virus: 0.2808, f1_Healthy_Leaf: 0.4099, f1_Herbicide_Growth_Damage: 0.7360, f1_Leaf_Hopper_Jassids: 0.4242, f1_Leaf_Redding: 0.6285, f1_Leaf_Variegation: 0.7557
2025-05-29 09:37:42 - __main__ - INFO - [main_execution_logic:469] - E21: Val f1_macro (0.5302) not better than best (0.5321). Patience: 1/15
2025-05-29 09:37:42 - __main__ - INFO - [main_execution_logic:478] - Epoch 21 completed in 235.83s.
2025-05-29 09:37:42 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E21 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 09:41:20 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 22 training finished. Avg Loss: 1.3293, Final LR for epoch: 1.85e-05, Opt Steps: 228
2025-05-29 09:41:37 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.2957, accuracy: 0.5766, f1_macro: 0.5549, f1_weighted: 0.5510, precision_macro: 0.6053, precision_weighted: 0.6118, recall_macro: 0.5859, recall_weighted: 0.5766, f1_Bacterial_Blight: 0.4920, f1_Curl_Virus: 0.2874, f1_Healthy_Leaf: 0.5011, f1_Herbicide_Growth_Damage: 0.7681, f1_Leaf_Hopper_Jassids: 0.4708, f1_Leaf_Redding: 0.6331, f1_Leaf_Variegation: 0.7320
2025-05-29 09:41:40 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:189] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/checkpoints_ssl_nonorm_lowlr_v1/best_finetuned_hvt_ssl_nonorm_lowlr_v1.pth
2025-05-29 09:41:40 - __main__ - INFO - [main_execution_logic:465] - E22: New best! Val f1_macro: 0.5549
2025-05-29 09:41:40 - __main__ - INFO - [main_execution_logic:478] - Epoch 22 completed in 238.08s.
2025-05-29 09:41:40 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E22 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 09:45:20 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 23 training finished. Avg Loss: 1.2988, Final LR for epoch: 1.83e-05, Opt Steps: 228
2025-05-29 09:45:36 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.2805, accuracy: 0.5842, f1_macro: 0.5658, f1_weighted: 0.5627, precision_macro: 0.6055, precision_weighted: 0.6113, recall_macro: 0.5927, recall_weighted: 0.5842, f1_Bacterial_Blight: 0.5077, f1_Curl_Virus: 0.3269, f1_Healthy_Leaf: 0.5413, f1_Herbicide_Growth_Damage: 0.7756, f1_Leaf_Hopper_Jassids: 0.4374, f1_Leaf_Redding: 0.6293, f1_Leaf_Variegation: 0.7425
2025-05-29 09:45:40 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:189] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/checkpoints_ssl_nonorm_lowlr_v1/best_finetuned_hvt_ssl_nonorm_lowlr_v1.pth
2025-05-29 09:45:40 - __main__ - INFO - [main_execution_logic:465] - E23: New best! Val f1_macro: 0.5658
2025-05-29 09:45:40 - __main__ - INFO - [main_execution_logic:478] - Epoch 23 completed in 239.54s.
2025-05-29 09:45:40 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E23 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 09:49:19 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 24 training finished. Avg Loss: 1.2877, Final LR for epoch: 1.81e-05, Opt Steps: 228
2025-05-29 09:49:36 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.3005, accuracy: 0.5766, f1_macro: 0.5567, f1_weighted: 0.5521, precision_macro: 0.6179, precision_weighted: 0.6233, recall_macro: 0.5850, recall_weighted: 0.5766, f1_Bacterial_Blight: 0.5000, f1_Curl_Virus: 0.2741, f1_Healthy_Leaf: 0.5023, f1_Herbicide_Growth_Damage: 0.7992, f1_Leaf_Hopper_Jassids: 0.4353, f1_Leaf_Redding: 0.6250, f1_Leaf_Variegation: 0.7612
2025-05-29 09:49:36 - __main__ - INFO - [main_execution_logic:469] - E24: Val f1_macro (0.5567) not better than best (0.5658). Patience: 1/15
2025-05-29 09:49:36 - __main__ - INFO - [main_execution_logic:478] - Epoch 24 completed in 235.64s.
2025-05-29 09:49:36 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E24 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 09:53:17 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 25 training finished. Avg Loss: 1.2915, Final LR for epoch: 1.79e-05, Opt Steps: 228
2025-05-29 09:53:38 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.2685, accuracy: 0.6028, f1_macro: 0.5852, f1_weighted: 0.5826, precision_macro: 0.6243, precision_weighted: 0.6318, recall_macro: 0.6118, recall_weighted: 0.6028, f1_Bacterial_Blight: 0.5050, f1_Curl_Virus: 0.3333, f1_Healthy_Leaf: 0.5779, f1_Herbicide_Growth_Damage: 0.7790, f1_Leaf_Hopper_Jassids: 0.5115, f1_Leaf_Redding: 0.6589, f1_Leaf_Variegation: 0.7309
2025-05-29 09:53:42 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:189] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/checkpoints_ssl_nonorm_lowlr_v1/best_finetuned_hvt_ssl_nonorm_lowlr_v1.pth
2025-05-29 09:53:42 - __main__ - INFO - [main_execution_logic:465] - E25: New best! Val f1_macro: 0.5852
2025-05-29 09:53:42 - __main__ - INFO - [main_execution_logic:478] - Epoch 25 completed in 246.61s.
2025-05-29 09:53:42 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E25 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 09:57:21 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 26 training finished. Avg Loss: 1.2700, Final LR for epoch: 1.77e-05, Opt Steps: 228
2025-05-29 09:57:38 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.2724, accuracy: 0.6007, f1_macro: 0.5801, f1_weighted: 0.5764, precision_macro: 0.6304, precision_weighted: 0.6373, recall_macro: 0.6097, recall_weighted: 0.6007, f1_Bacterial_Blight: 0.5269, f1_Curl_Virus: 0.2857, f1_Healthy_Leaf: 0.5726, f1_Herbicide_Growth_Damage: 0.7948, f1_Leaf_Hopper_Jassids: 0.4892, f1_Leaf_Redding: 0.6534, f1_Leaf_Variegation: 0.7382
2025-05-29 09:57:38 - __main__ - INFO - [main_execution_logic:469] - E26: Val f1_macro (0.5801) not better than best (0.5852). Patience: 1/15
2025-05-29 09:57:38 - __main__ - INFO - [main_execution_logic:478] - Epoch 26 completed in 236.07s.
2025-05-29 09:57:38 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E26 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 10:01:16 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 27 training finished. Avg Loss: 1.2751, Final LR for epoch: 1.75e-05, Opt Steps: 228
2025-05-29 10:01:33 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.2542, accuracy: 0.6214, f1_macro: 0.6085, f1_weighted: 0.6049, precision_macro: 0.6456, precision_weighted: 0.6507, recall_macro: 0.6298, recall_weighted: 0.6214, f1_Bacterial_Blight: 0.5259, f1_Curl_Virus: 0.3507, f1_Healthy_Leaf: 0.6080, f1_Herbicide_Growth_Damage: 0.8053, f1_Leaf_Hopper_Jassids: 0.5167, f1_Leaf_Redding: 0.6657, f1_Leaf_Variegation: 0.7873
2025-05-29 10:01:36 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:189] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/checkpoints_ssl_nonorm_lowlr_v1/best_finetuned_hvt_ssl_nonorm_lowlr_v1.pth
2025-05-29 10:01:36 - __main__ - INFO - [main_execution_logic:465] - E27: New best! Val f1_macro: 0.6085
2025-05-29 10:01:36 - __main__ - INFO - [main_execution_logic:478] - Epoch 27 completed in 237.86s.
2025-05-29 10:01:36 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E27 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 10:05:14 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 28 training finished. Avg Loss: 1.2561, Final LR for epoch: 1.72e-05, Opt Steps: 228
2025-05-29 10:05:32 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.2470, accuracy: 0.6193, f1_macro: 0.6053, f1_weighted: 0.6012, precision_macro: 0.6500, precision_weighted: 0.6546, recall_macro: 0.6270, recall_weighted: 0.6193, f1_Bacterial_Blight: 0.5273, f1_Curl_Virus: 0.3361, f1_Healthy_Leaf: 0.6045, f1_Herbicide_Growth_Damage: 0.8099, f1_Leaf_Hopper_Jassids: 0.4981, f1_Leaf_Redding: 0.6575, f1_Leaf_Variegation: 0.8040
2025-05-29 10:05:32 - __main__ - INFO - [main_execution_logic:469] - E28: Val f1_macro (0.6053) not better than best (0.6085). Patience: 1/15
2025-05-29 10:05:32 - __main__ - INFO - [main_execution_logic:478] - Epoch 28 completed in 235.66s.
2025-05-29 10:05:32 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E28 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 10:09:12 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 29 training finished. Avg Loss: 1.2361, Final LR for epoch: 1.70e-05, Opt Steps: 228
2025-05-29 10:09:29 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.2488, accuracy: 0.6236, f1_macro: 0.6036, f1_weighted: 0.5993, precision_macro: 0.6524, precision_weighted: 0.6584, recall_macro: 0.6332, recall_weighted: 0.6236, f1_Bacterial_Blight: 0.5066, f1_Curl_Virus: 0.3006, f1_Healthy_Leaf: 0.6097, f1_Herbicide_Growth_Damage: 0.8007, f1_Leaf_Hopper_Jassids: 0.5610, f1_Leaf_Redding: 0.6714, f1_Leaf_Variegation: 0.7750
2025-05-29 10:09:29 - __main__ - INFO - [main_execution_logic:469] - E29: Val f1_macro (0.6036) not better than best (0.6085). Patience: 2/15
2025-05-29 10:09:29 - __main__ - INFO - [main_execution_logic:478] - Epoch 29 completed in 237.47s.
2025-05-29 10:09:29 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E29 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 10:13:09 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 30 training finished. Avg Loss: 1.2396, Final LR for epoch: 1.68e-05, Opt Steps: 228
2025-05-29 10:13:26 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.2470, accuracy: 0.6258, f1_macro: 0.6084, f1_weighted: 0.6048, precision_macro: 0.6544, precision_weighted: 0.6616, recall_macro: 0.6360, recall_weighted: 0.6258, f1_Bacterial_Blight: 0.5422, f1_Curl_Virus: 0.3191, f1_Healthy_Leaf: 0.6023, f1_Herbicide_Growth_Damage: 0.8158, f1_Leaf_Hopper_Jassids: 0.5386, f1_Leaf_Redding: 0.6814, f1_Leaf_Variegation: 0.7594
2025-05-29 10:13:26 - __main__ - INFO - [main_execution_logic:469] - E30: Val f1_macro (0.6084) not better than best (0.6085). Patience: 3/15
2025-05-29 10:13:26 - __main__ - INFO - [main_execution_logic:478] - Epoch 30 completed in 236.97s.
2025-05-29 10:13:26 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E30 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 10:17:05 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 31 training finished. Avg Loss: 1.2072, Final LR for epoch: 1.65e-05, Opt Steps: 228
2025-05-29 10:17:22 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.2568, accuracy: 0.6302, f1_macro: 0.6159, f1_weighted: 0.6127, precision_macro: 0.6646, precision_weighted: 0.6724, recall_macro: 0.6403, recall_weighted: 0.6302, f1_Bacterial_Blight: 0.5397, f1_Curl_Virus: 0.3520, f1_Healthy_Leaf: 0.6008, f1_Herbicide_Growth_Damage: 0.8189, f1_Leaf_Hopper_Jassids: 0.5363, f1_Leaf_Redding: 0.6901, f1_Leaf_Variegation: 0.7732
2025-05-29 10:17:25 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:189] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/checkpoints_ssl_nonorm_lowlr_v1/best_finetuned_hvt_ssl_nonorm_lowlr_v1.pth
2025-05-29 10:17:25 - __main__ - INFO - [main_execution_logic:465] - E31: New best! Val f1_macro: 0.6159
2025-05-29 10:17:25 - __main__ - INFO - [main_execution_logic:478] - Epoch 31 completed in 238.85s.
2025-05-29 10:17:25 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E31 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 10:21:03 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 32 training finished. Avg Loss: 1.2251, Final LR for epoch: 1.63e-05, Opt Steps: 228
2025-05-29 10:21:20 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.2481, accuracy: 0.6193, f1_macro: 0.6115, f1_weighted: 0.6076, precision_macro: 0.6626, precision_weighted: 0.6684, recall_macro: 0.6289, recall_weighted: 0.6193, f1_Bacterial_Blight: 0.5326, f1_Curl_Virus: 0.3770, f1_Healthy_Leaf: 0.5653, f1_Herbicide_Growth_Damage: 0.8167, f1_Leaf_Hopper_Jassids: 0.5058, f1_Leaf_Redding: 0.6705, f1_Leaf_Variegation: 0.8124
2025-05-29 10:21:20 - __main__ - INFO - [main_execution_logic:469] - E32: Val f1_macro (0.6115) not better than best (0.6159). Patience: 1/15
2025-05-29 10:21:20 - __main__ - INFO - [main_execution_logic:478] - Epoch 32 completed in 235.06s.
2025-05-29 10:21:20 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E32 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 10:24:59 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 33 training finished. Avg Loss: 1.2096, Final LR for epoch: 1.60e-05, Opt Steps: 228
2025-05-29 10:25:17 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.2320, accuracy: 0.6461, f1_macro: 0.6349, f1_weighted: 0.6304, precision_macro: 0.6825, precision_weighted: 0.6878, recall_macro: 0.6560, recall_weighted: 0.6461, f1_Bacterial_Blight: 0.5691, f1_Curl_Virus: 0.3677, f1_Healthy_Leaf: 0.6224, f1_Herbicide_Growth_Damage: 0.8249, f1_Leaf_Hopper_Jassids: 0.5616, f1_Leaf_Redding: 0.6860, f1_Leaf_Variegation: 0.8127
2025-05-29 10:25:21 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:189] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/checkpoints_ssl_nonorm_lowlr_v1/best_finetuned_hvt_ssl_nonorm_lowlr_v1.pth
2025-05-29 10:25:21 - __main__ - INFO - [main_execution_logic:465] - E33: New best! Val f1_macro: 0.6349
2025-05-29 10:25:21 - __main__ - INFO - [main_execution_logic:478] - Epoch 33 completed in 240.49s.
2025-05-29 10:25:21 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E33 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 10:29:00 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 34 training finished. Avg Loss: 1.1883, Final LR for epoch: 1.57e-05, Opt Steps: 228
2025-05-29 10:29:17 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.2420, accuracy: 0.6220, f1_macro: 0.6094, f1_weighted: 0.6050, precision_macro: 0.6660, precision_weighted: 0.6703, recall_macro: 0.6293, recall_weighted: 0.6220, f1_Bacterial_Blight: 0.5320, f1_Curl_Virus: 0.3362, f1_Healthy_Leaf: 0.5948, f1_Herbicide_Growth_Damage: 0.8247, f1_Leaf_Hopper_Jassids: 0.5129, f1_Leaf_Redding: 0.6622, f1_Leaf_Variegation: 0.8032
2025-05-29 10:29:17 - __main__ - INFO - [main_execution_logic:469] - E34: Val f1_macro (0.6094) not better than best (0.6349). Patience: 1/15
2025-05-29 10:29:17 - __main__ - INFO - [main_execution_logic:478] - Epoch 34 completed in 236.34s.
2025-05-29 10:29:17 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E34 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 10:32:55 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 35 training finished. Avg Loss: 1.1941, Final LR for epoch: 1.55e-05, Opt Steps: 228
2025-05-29 10:33:12 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.2303, accuracy: 0.6373, f1_macro: 0.6258, f1_weighted: 0.6231, precision_macro: 0.6674, precision_weighted: 0.6747, recall_macro: 0.6470, recall_weighted: 0.6373, f1_Bacterial_Blight: 0.5288, f1_Curl_Virus: 0.3957, f1_Healthy_Leaf: 0.6211, f1_Herbicide_Growth_Damage: 0.8259, f1_Leaf_Hopper_Jassids: 0.5571, f1_Leaf_Redding: 0.6848, f1_Leaf_Variegation: 0.7670
2025-05-29 10:33:12 - __main__ - INFO - [main_execution_logic:469] - E35: Val f1_macro (0.6258) not better than best (0.6349). Patience: 2/15
2025-05-29 10:33:12 - __main__ - INFO - [main_execution_logic:478] - Epoch 35 completed in 234.75s.
2025-05-29 10:33:12 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E35 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 10:36:51 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 36 training finished. Avg Loss: 1.1870, Final LR for epoch: 1.52e-05, Opt Steps: 228
2025-05-29 10:37:08 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.1988, accuracy: 0.6630, f1_macro: 0.6561, f1_weighted: 0.6526, precision_macro: 0.6846, precision_weighted: 0.6892, recall_macro: 0.6716, recall_weighted: 0.6630, f1_Bacterial_Blight: 0.5781, f1_Curl_Virus: 0.4444, f1_Healthy_Leaf: 0.6231, f1_Herbicide_Growth_Damage: 0.8276, f1_Leaf_Hopper_Jassids: 0.5882, f1_Leaf_Redding: 0.7093, f1_Leaf_Variegation: 0.8216
2025-05-29 10:37:11 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:189] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_ssl_nonorm_lowlr_v1/checkpoints_ssl_nonorm_lowlr_v1/best_finetuned_hvt_ssl_nonorm_lowlr_v1.pth
2025-05-29 10:37:11 - __main__ - INFO - [main_execution_logic:465] - E36: New best! Val f1_macro: 0.6561
2025-05-29 10:37:11 - __main__ - INFO - [main_execution_logic:478] - Epoch 36 completed in 239.66s.
2025-05-29 10:37:11 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E36 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 10:40:52 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 37 training finished. Avg Loss: 1.1827, Final LR for epoch: 1.49e-05, Opt Steps: 228
2025-05-29 10:41:08 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.2100, accuracy: 0.6559, f1_macro: 0.6473, f1_weighted: 0.6437, precision_macro: 0.6926, precision_weighted: 0.6976, recall_macro: 0.6642, recall_weighted: 0.6559, f1_Bacterial_Blight: 0.5401, f1_Curl_Virus: 0.4119, f1_Healthy_Leaf: 0.6352, f1_Herbicide_Growth_Damage: 0.8316, f1_Leaf_Hopper_Jassids: 0.5781, f1_Leaf_Redding: 0.7018, f1_Leaf_Variegation: 0.8323
2025-05-29 10:41:08 - __main__ - INFO - [main_execution_logic:469] - E37: Val f1_macro (0.6473) not better than best (0.6561). Patience: 1/15
2025-05-29 10:41:08 - __main__ - INFO - [main_execution_logic:478] - Epoch 37 completed in 236.83s.
2025-05-29 10:41:08 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E37 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 10:44:47 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 38 training finished. Avg Loss: 1.1624, Final LR for epoch: 1.46e-05, Opt Steps: 228
2025-05-29 10:45:04 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.2026, accuracy: 0.6488, f1_macro: 0.6397, f1_weighted: 0.6354, precision_macro: 0.6819, precision_weighted: 0.6852, recall_macro: 0.6563, recall_weighted: 0.6488, f1_Bacterial_Blight: 0.5480, f1_Curl_Virus: 0.4011, f1_Healthy_Leaf: 0.6220, f1_Herbicide_Growth_Damage: 0.8371, f1_Leaf_Hopper_Jassids: 0.5562, f1_Leaf_Redding: 0.6814, f1_Leaf_Variegation: 0.8320
2025-05-29 10:45:04 - __main__ - INFO - [main_execution_logic:469] - E38: Val f1_macro (0.6397) not better than best (0.6561). Patience: 2/15
2025-05-29 10:45:04 - __main__ - INFO - [main_execution_logic:478] - Epoch 38 completed in 236.20s.
2025-05-29 10:45:04 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E38 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 10:48:43 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 39 training finished. Avg Loss: 1.1632, Final LR for epoch: 1.43e-05, Opt Steps: 228
2025-05-29 10:49:00 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.2129, accuracy: 0.6472, f1_macro: 0.6358, f1_weighted: 0.6327, precision_macro: 0.6785, precision_weighted: 0.6833, recall_macro: 0.6543, recall_weighted: 0.6472, f1_Bacterial_Blight: 0.5455, f1_Curl_Virus: 0.4054, f1_Healthy_Leaf: 0.6283, f1_Herbicide_Growth_Damage: 0.8354, f1_Leaf_Hopper_Jassids: 0.5432, f1_Leaf_Redding: 0.6891, f1_Leaf_Variegation: 0.8038
2025-05-29 10:49:00 - __main__ - INFO - [main_execution_logic:469] - E39: Val f1_macro (0.6358) not better than best (0.6561). Patience: 3/15
2025-05-29 10:49:00 - __main__ - INFO - [main_execution_logic:478] - Epoch 39 completed in 235.91s.
2025-05-29 10:49:00 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E39 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 10:52:39 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 40 training finished. Avg Loss: 1.1685, Final LR for epoch: 1.40e-05, Opt Steps: 228
2025-05-29 10:52:57 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.1880, accuracy: 0.6630, f1_macro: 0.6527, f1_weighted: 0.6491, precision_macro: 0.6914, precision_weighted: 0.6967, recall_macro: 0.6719, recall_weighted: 0.6630, f1_Bacterial_Blight: 0.5567, f1_Curl_Virus: 0.4097, f1_Healthy_Leaf: 0.6512, f1_Herbicide_Growth_Damage: 0.8340, f1_Leaf_Hopper_Jassids: 0.5912, f1_Leaf_Redding: 0.7041, f1_Leaf_Variegation: 0.8221
2025-05-29 10:52:57 - __main__ - INFO - [main_execution_logic:469] - E40: Val f1_macro (0.6527) not better than best (0.6561). Patience: 4/15
2025-05-29 10:52:57 - __main__ - INFO - [main_execution_logic:478] - Epoch 40 completed in 236.75s.
2025-05-29 10:52:57 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E40 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 10:56:37 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 41 training finished. Avg Loss: 1.1512, Final LR for epoch: 1.37e-05, Opt Steps: 228
2025-05-29 10:56:54 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.1802, accuracy: 0.6603, f1_macro: 0.6506, f1_weighted: 0.6475, precision_macro: 0.6910, precision_weighted: 0.6961, recall_macro: 0.6683, recall_weighted: 0.6603, f1_Bacterial_Blight: 0.5621, f1_Curl_Virus: 0.4278, f1_Healthy_Leaf: 0.6403, f1_Herbicide_Growth_Damage: 0.8320, f1_Leaf_Hopper_Jassids: 0.5759, f1_Leaf_Redding: 0.7028, f1_Leaf_Variegation: 0.8135
2025-05-29 10:56:54 - __main__ - INFO - [main_execution_logic:469] - E41: Val f1_macro (0.6506) not better than best (0.6561). Patience: 5/15
2025-05-29 10:56:54 - __main__ - INFO - [main_execution_logic:478] - Epoch 41 completed in 237.27s.
2025-05-29 10:56:54 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E41 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 11:00:32 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 42 training finished. Avg Loss: 1.1507, Final LR for epoch: 1.34e-05, Opt Steps: 228
2025-05-29 11:00:49 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.1905, accuracy: 0.6625, f1_macro: 0.6527, f1_weighted: 0.6493, precision_macro: 0.6937, precision_weighted: 0.6996, recall_macro: 0.6721, recall_weighted: 0.6625, f1_Bacterial_Blight: 0.5631, f1_Curl_Virus: 0.4140, f1_Healthy_Leaf: 0.6421, f1_Herbicide_Growth_Damage: 0.8395, f1_Leaf_Hopper_Jassids: 0.5915, f1_Leaf_Redding: 0.7073, f1_Leaf_Variegation: 0.8117
2025-05-29 11:00:49 - __main__ - INFO - [main_execution_logic:469] - E42: Val f1_macro (0.6527) not better than best (0.6561). Patience: 6/15
2025-05-29 11:00:49 - __main__ - INFO - [main_execution_logic:478] - Epoch 42 completed in 234.89s.
2025-05-29 11:00:49 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E42 End: Alloc 3161.3MB, Reserved 6628.0MB
2025-05-29 11:04:28 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:114] - Epoch 43 training finished. Avg Loss: 1.1173, Final LR for epoch: 1.31e-05, Opt Steps: 228
2025-05-29 11:04:46 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:182] - Validation finished. Avg Loss: 1.1931, accuracy: 0.6608, f1_macro: 0.6529, f1_weighted: 0.6492, precision_macro: 0.6924, precision_weighted: 0.6959, recall_macro: 0.6681, recall_weighted: 0.6608, f1_Bacterial_Blight: 0.5602, f1_Curl_Virus: 0.4297, f1_Healthy_Leaf: 0.6410, f1_Herbicide_Growth_Damage: 0.8434, f1_Leaf_Hopper_Jassids: 0.5760, f1_Leaf_Redding: 0.6938, f1_Leaf_Variegation: 0.8263
2025-05-29 11:04:46 - __main__ - INFO - [main_execution_logic:469] - E43: Val f1_macro (0.6529) not better than best (0.6561). Patience: 7/15
2025-05-29 11:04:46 - __main__ - INFO - [main_execution_logic:478] - Epoch 43 completed in 236.97s.
2025-05-29 11:04:46 - __main__ - DEBUG - [main_execution_logic:479] - CUDA Mem E43 End: Alloc 3161.3MB, Reserved 6628.0MB
