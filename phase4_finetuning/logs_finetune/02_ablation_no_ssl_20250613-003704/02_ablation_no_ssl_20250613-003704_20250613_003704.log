2025-06-13 00:37:04 - root - INFO - [setup_logging:75] - Logging configured. Log file: /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/02_ablation_no_ssl_20250613-003704_20250613_003704.log. Logger 'root' Effective Level: INFO
2025-06-13 00:37:04 - __main__ - INFO - [run:38] - Starting fine-tuning run: 02_ablation_no_ssl_20250613-003704
2025-06-13 00:37:04 - __main__ - INFO - [run:39] - Full configuration:
PACKAGE_ROOT_PATH: /teamspace/studios/this_studio/cvpr25/phase4_finetuning
PROJECT_ROOT_PATH: /teamspace/studios/this_studio/cvpr25
augmentations:
  cutmix_prob: 0.2
  mixup_alpha: 0.2
  severity: strong
  strategy: cotton_disease
cudnn_benchmark: true
data:
  augmented_dataset_name: Augmented Dataset
  img_size:
  - 448
  - 448
  num_workers: 4
  original_dataset_name: Original Dataset
  root_dir: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset
    for Cotton Leaf Disease Detection
  train_split_ratio: 0.9
  use_weighted_sampler: true
device: cuda
evaluation:
  early_stopping:
    metric: f1_macro
    min_delta: 0.001
    patience: 20
  ema_decay: 0.9999
  tta_enabled: true
  use_ema: true
model:
  hvt_params:
    depths:
    - 3
    - 6
    - 24
    - 3
    drop_path_rate: 0.2
    embed_dim_rgb: 192
    enable_consistency_loss_heads: false
    mlp_ratio: 4.0
    model_drop_rate: 0.1
    norm_layer_name: LayerNorm
    num_heads:
    - 6
    - 12
    - 24
    - 48
    patch_size: 14
    qkv_bias: true
    spectral_channels: 0
    use_dfca: false
    use_gradient_checkpointing: true
  resume_finetune_path: null
  ssl_pretrained_path: null
run_name_prefix: 02_ablation_no_ssl
seed: 42
torch_compile:
  enable: false
  mode: reduce-overhead
training:
  accumulation_steps: 2
  amp_enabled: true
  batch_size: 16
  clip_grad_norm: 1.0
  epochs: 100
  freeze_backbone_epochs: 10
  loss:
    focal_alpha: 0.5
    focal_gamma: 2.0
    label_smoothing: 0.1
    type: CombinedLoss
    use_class_weights: true
    weights:
      ce: 0.5
      focal: 0.5
  optimizer:
    lr_backbone_unfrozen: 2.0e-05
    lr_head_unfrozen: 0.0002
  scheduler:
    div_factor: 10
    final_div_factor: 1000
    name: onecyclelr
    pct_start: 0.1

2025-06-13 00:37:04 - __main__ - INFO - [run:50] - Setting up datasets and dataloaders...
2025-06-13 00:37:04 - phase4_finetuning.utils.augmentations - INFO - [create_cotton_leaf_augmentation:148] - Creating augmentation strategy: 'cotton_disease' for image size (448, 448)
2025-06-13 00:37:04 - phase4_finetuning.utils.augmentations - INFO - [__init__:134] - CottonLeafDiseaseAugmentation initialized with severity 'strong'.
2025-06-13 00:37:04 - phase4_finetuning.utils.augmentations - INFO - [create_cotton_leaf_augmentation:148] - Creating augmentation strategy: 'minimal' for image size (448, 448)
2025-06-13 00:37:04 - phase4_finetuning.dataset - INFO - [__init__:37] - Initializing Dataset for split 'train'...
2025-06-13 00:37:05 - phase4_finetuning.dataset - INFO - [__init__:53] - Found 9137 total image paths.
2025-06-13 00:37:05 - phase4_finetuning.dataset - INFO - [__init__:64] - Split 'train' size: 8223 samples.
2025-06-13 00:37:05 - phase4_finetuning.dataset - INFO - [__init__:37] - Initializing Dataset for split 'val'...
2025-06-13 00:37:05 - phase4_finetuning.dataset - INFO - [__init__:53] - Found 9137 total image paths.
2025-06-13 00:37:05 - phase4_finetuning.dataset - INFO - [__init__:64] - Split 'val' size: 914 samples.
2025-06-13 00:37:05 - __main__ - INFO - [run:87] - Discovered 7 classes.
2025-06-13 00:37:05 - __main__ - INFO - [run:97] - Using WeightedRandomSampler for training.
2025-06-13 00:37:05 - __main__ - INFO - [run:129] - Creating custom HVT model for fine-tuning...
2025-06-13 00:37:05 - phase2_model.models.hvt - INFO - [create_disease_aware_hvt:602] - Factory: Creating DiseaseAwareHVT for img_size: (448, 448), num_classes: 7
2025-06-13 00:37:08 - phase2_model.models.hvt - INFO - [__init__:325] - HVT: Running RGB stream only. No fusion.
2025-06-13 00:37:10 - phase2_model.models.hvt - INFO - [__init__:359] - DiseaseAwareHVT initialized for image size (448, 448) and 7 classes.
2025-06-13 00:37:10 - __main__ - INFO - [run:138] - Initializing EnhancedFinetuner...
2025-06-13 00:37:10 - phase4_finetuning.utils.ema - INFO - [_create_shadow_copy:32] - Creating EMA shadow model by re-instantiating custom HVT class.
2025-06-13 00:37:13 - phase2_model.models.hvt - INFO - [__init__:325] - HVT: Running RGB stream only. No fusion.
2025-06-13 00:37:15 - phase2_model.models.hvt - INFO - [__init__:359] - DiseaseAwareHVT initialized for image size (448, 448) and 7 classes.
2025-06-13 00:37:15 - phase4_finetuning.utils.ema - INFO - [__init__:23] - EMA helper initialized with decay=0.9999. Shadow model created.
2025-06-13 00:37:15 - phase4_finetuning.finetune.trainer - INFO - [_get_param_groups:304] - Optimizer parameter groups: Head (177,975,367 params) with LR 2.00e-04, Backbone (95,640,384 params) with LR 2.00e-05
2025-06-13 00:37:15 - phase4_finetuning.dataset - INFO - [get_class_weights:96] - Computed class weights for split 'train': [1.04  0.897 1.049 1.03  1.069 0.834 1.156]
2025-06-13 00:37:15 - phase4_finetuning.finetune.trainer - INFO - [_create_criterion:344] - Using class weights in loss function.
2025-06-13 00:37:15 - phase4_finetuning.finetune.trainer - INFO - [__init__:59] - Trainer initialized. Model has 273,615,751 trainable parameters.
2025-06-13 00:37:15 - __main__ - INFO - [run:149] - Starting the training and validation loop...
2025-06-13 00:37:15 - phase4_finetuning.finetune.trainer - INFO - [run:63] - Starting fine-tuning run. Monitoring 'f1_macro' for best model.
2025-06-13 00:37:15 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 1/100 ---
2025-06-13 00:37:15 - phase4_finetuning.finetune.trainer - INFO - [_set_parameter_groups_for_epoch:335] - Epoch 1: Setting backbone requires_grad to False
2025-06-13 00:37:15 - phase4_finetuning.finetune.trainer - INFO - [_set_parameter_groups_for_epoch:338] - Trainable params updated: 177,975,367
2025-06-13 00:41:02 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 1: Loss=1.9569, Accuracy=0.1455, F1-Macro=0.0682
2025-06-13 00:41:02 - phase4_finetuning.finetune.trainer - INFO - [run:83] - Epoch 1: New best metric! f1_macro = 0.0682 (previously -1.0000)
2025-06-13 00:41:02 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:388] - Saving best model checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/best_model.pth
2025-06-13 00:41:06 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 2/100 ---
2025-06-13 00:44:49 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 2: Loss=1.9429, Accuracy=0.1510, F1-Macro=0.0738
2025-06-13 00:44:49 - phase4_finetuning.finetune.trainer - INFO - [run:83] - Epoch 2: New best metric! f1_macro = 0.0738 (previously 0.0682)
2025-06-13 00:44:49 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:388] - Saving best model checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/best_model.pth
2025-06-13 00:45:01 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 3/100 ---
2025-06-13 00:48:44 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 3: Loss=1.9268, Accuracy=0.2002, F1-Macro=0.1416
2025-06-13 00:48:44 - phase4_finetuning.finetune.trainer - INFO - [run:83] - Epoch 3: New best metric! f1_macro = 0.1416 (previously 0.0738)
2025-06-13 00:48:44 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:388] - Saving best model checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/best_model.pth
2025-06-13 00:48:54 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 4/100 ---
2025-06-13 00:52:37 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 4: Loss=1.9097, Accuracy=0.3249, F1-Macro=0.2660
2025-06-13 00:52:37 - phase4_finetuning.finetune.trainer - INFO - [run:83] - Epoch 4: New best metric! f1_macro = 0.2660 (previously 0.1416)
2025-06-13 00:52:37 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:388] - Saving best model checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/best_model.pth
2025-06-13 00:52:48 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 5/100 ---
2025-06-13 00:56:31 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 5: Loss=1.8934, Accuracy=0.3665, F1-Macro=0.3097
2025-06-13 00:56:31 - phase4_finetuning.finetune.trainer - INFO - [run:83] - Epoch 5: New best metric! f1_macro = 0.3097 (previously 0.2660)
2025-06-13 00:56:31 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:388] - Saving best model checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/best_model.pth
2025-06-13 00:56:42 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 6/100 ---
2025-06-13 01:00:24 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 6: Loss=1.8770, Accuracy=0.3621, F1-Macro=0.2973
2025-06-13 01:00:24 - phase4_finetuning.finetune.trainer - INFO - [run:89] - No improvement in f1_macro. Best: 0.3097. Patience: 1/20
2025-06-13 01:00:24 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 7/100 ---
2025-06-13 01:04:05 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 7: Loss=1.8631, Accuracy=0.3457, F1-Macro=0.2661
2025-06-13 01:04:05 - phase4_finetuning.finetune.trainer - INFO - [run:89] - No improvement in f1_macro. Best: 0.3097. Patience: 2/20
2025-06-13 01:04:05 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 8/100 ---
2025-06-13 01:07:46 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 8: Loss=1.8509, Accuracy=0.3392, F1-Macro=0.2503
2025-06-13 01:07:46 - phase4_finetuning.finetune.trainer - INFO - [run:89] - No improvement in f1_macro. Best: 0.3097. Patience: 3/20
2025-06-13 01:07:46 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 9/100 ---
2025-06-13 01:11:28 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 9: Loss=1.8401, Accuracy=0.3392, F1-Macro=0.2467
2025-06-13 01:11:28 - phase4_finetuning.finetune.trainer - INFO - [run:89] - No improvement in f1_macro. Best: 0.3097. Patience: 4/20
2025-06-13 01:11:28 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 10/100 ---
2025-06-13 01:15:11 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 10: Loss=1.8324, Accuracy=0.3370, F1-Macro=0.2416
2025-06-13 01:15:11 - phase4_finetuning.finetune.trainer - INFO - [run:89] - No improvement in f1_macro. Best: 0.3097. Patience: 5/20
2025-06-13 01:15:11 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:394] - Saving periodic checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/checkpoint_epoch_10.pth
2025-06-13 01:15:17 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 11/100 ---
2025-06-13 01:15:17 - phase4_finetuning.finetune.trainer - INFO - [_set_parameter_groups_for_epoch:335] - Epoch 11: Setting backbone requires_grad to True
2025-06-13 01:15:17 - phase4_finetuning.finetune.trainer - INFO - [_set_parameter_groups_for_epoch:338] - Trainable params updated: 273,615,751
2025-06-13 01:19:33 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 11: Loss=1.8265, Accuracy=0.3392, F1-Macro=0.2441
2025-06-13 01:19:33 - phase4_finetuning.finetune.trainer - INFO - [run:89] - No improvement in f1_macro. Best: 0.3097. Patience: 6/20
2025-06-13 01:19:33 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 12/100 ---
2025-06-13 01:23:45 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 12: Loss=1.8223, Accuracy=0.3435, F1-Macro=0.2537
2025-06-13 01:23:45 - phase4_finetuning.finetune.trainer - INFO - [run:89] - No improvement in f1_macro. Best: 0.3097. Patience: 7/20
2025-06-13 01:23:45 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 13/100 ---
2025-06-13 01:27:57 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 13: Loss=1.8182, Accuracy=0.3523, F1-Macro=0.2698
2025-06-13 01:27:57 - phase4_finetuning.finetune.trainer - INFO - [run:89] - No improvement in f1_macro. Best: 0.3097. Patience: 8/20
2025-06-13 01:27:57 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 14/100 ---
2025-06-13 01:32:10 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 14: Loss=1.8151, Accuracy=0.3523, F1-Macro=0.2760
2025-06-13 01:32:10 - phase4_finetuning.finetune.trainer - INFO - [run:89] - No improvement in f1_macro. Best: 0.3097. Patience: 9/20
2025-06-13 01:32:10 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 15/100 ---
2025-06-13 01:36:22 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 15: Loss=1.8108, Accuracy=0.3665, F1-Macro=0.2962
2025-06-13 01:36:22 - phase4_finetuning.finetune.trainer - INFO - [run:89] - No improvement in f1_macro. Best: 0.3097. Patience: 10/20
2025-06-13 01:36:22 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 16/100 ---
2025-06-13 01:40:34 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 16: Loss=1.8068, Accuracy=0.3731, F1-Macro=0.3104
2025-06-13 01:40:34 - phase4_finetuning.finetune.trainer - INFO - [run:89] - No improvement in f1_macro. Best: 0.3097. Patience: 11/20
2025-06-13 01:40:34 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 17/100 ---
2025-06-13 01:44:47 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 17: Loss=1.8037, Accuracy=0.3818, F1-Macro=0.3238
2025-06-13 01:44:47 - phase4_finetuning.finetune.trainer - INFO - [run:83] - Epoch 17: New best metric! f1_macro = 0.3238 (previously 0.3097)
2025-06-13 01:44:47 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:388] - Saving best model checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/best_model.pth
2025-06-13 01:44:59 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 18/100 ---
2025-06-13 01:49:14 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 18: Loss=1.8003, Accuracy=0.3807, F1-Macro=0.3242
2025-06-13 01:49:14 - phase4_finetuning.finetune.trainer - INFO - [run:89] - No improvement in f1_macro. Best: 0.3238. Patience: 1/20
2025-06-13 01:49:14 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 19/100 ---
2025-06-13 01:53:27 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 19: Loss=1.7971, Accuracy=0.3840, F1-Macro=0.3290
2025-06-13 01:53:27 - phase4_finetuning.finetune.trainer - INFO - [run:83] - Epoch 19: New best metric! f1_macro = 0.3290 (previously 0.3238)
2025-06-13 01:53:27 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:388] - Saving best model checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/best_model.pth
2025-06-13 01:53:40 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 20/100 ---
2025-06-13 01:57:55 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 20: Loss=1.7932, Accuracy=0.3917, F1-Macro=0.3390
2025-06-13 01:57:55 - phase4_finetuning.finetune.trainer - INFO - [run:83] - Epoch 20: New best metric! f1_macro = 0.3390 (previously 0.3290)
2025-06-13 01:57:55 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:388] - Saving best model checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/best_model.pth
2025-06-13 01:58:09 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:394] - Saving periodic checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/checkpoint_epoch_20.pth
2025-06-13 01:58:15 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 21/100 ---
2025-06-13 02:02:30 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 21: Loss=1.7904, Accuracy=0.3928, F1-Macro=0.3410
2025-06-13 02:02:30 - phase4_finetuning.finetune.trainer - INFO - [run:83] - Epoch 21: New best metric! f1_macro = 0.3410 (previously 0.3390)
2025-06-13 02:02:30 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:388] - Saving best model checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/best_model.pth
2025-06-13 02:02:43 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 22/100 ---
2025-06-13 02:06:58 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 22: Loss=1.7878, Accuracy=0.4015, F1-Macro=0.3479
2025-06-13 02:06:58 - phase4_finetuning.finetune.trainer - INFO - [run:83] - Epoch 22: New best metric! f1_macro = 0.3479 (previously 0.3410)
2025-06-13 02:06:58 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:388] - Saving best model checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/best_model.pth
2025-06-13 02:07:11 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 23/100 ---
2025-06-13 02:11:26 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 23: Loss=1.7846, Accuracy=0.4179, F1-Macro=0.3631
2025-06-13 02:11:26 - phase4_finetuning.finetune.trainer - INFO - [run:83] - Epoch 23: New best metric! f1_macro = 0.3631 (previously 0.3479)
2025-06-13 02:11:26 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:388] - Saving best model checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/best_model.pth
2025-06-13 02:11:39 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 24/100 ---
2025-06-13 02:15:55 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 24: Loss=1.7813, Accuracy=0.4179, F1-Macro=0.3636
2025-06-13 02:15:55 - phase4_finetuning.finetune.trainer - INFO - [run:89] - No improvement in f1_macro. Best: 0.3631. Patience: 1/20
2025-06-13 02:15:55 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 25/100 ---
2025-06-13 02:20:07 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 25: Loss=1.7784, Accuracy=0.4289, F1-Macro=0.3784
2025-06-13 02:20:07 - phase4_finetuning.finetune.trainer - INFO - [run:83] - Epoch 25: New best metric! f1_macro = 0.3784 (previously 0.3631)
2025-06-13 02:20:07 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:388] - Saving best model checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/best_model.pth
2025-06-13 02:20:21 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 26/100 ---
2025-06-13 02:24:36 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 26: Loss=1.7758, Accuracy=0.4212, F1-Macro=0.3716
2025-06-13 02:24:36 - phase4_finetuning.finetune.trainer - INFO - [run:89] - No improvement in f1_macro. Best: 0.3784. Patience: 1/20
2025-06-13 02:24:36 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 27/100 ---
2025-06-13 02:28:49 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 27: Loss=1.7733, Accuracy=0.4278, F1-Macro=0.3821
2025-06-13 02:28:49 - phase4_finetuning.finetune.trainer - INFO - [run:83] - Epoch 27: New best metric! f1_macro = 0.3821 (previously 0.3784)
2025-06-13 02:28:49 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:388] - Saving best model checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/best_model.pth
2025-06-13 02:29:02 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 28/100 ---
2025-06-13 02:33:18 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 28: Loss=1.7711, Accuracy=0.4212, F1-Macro=0.3757
2025-06-13 02:33:18 - phase4_finetuning.finetune.trainer - INFO - [run:89] - No improvement in f1_macro. Best: 0.3821. Patience: 1/20
2025-06-13 02:33:18 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 29/100 ---
2025-06-13 02:37:30 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 29: Loss=1.7692, Accuracy=0.4168, F1-Macro=0.3716
2025-06-13 02:37:30 - phase4_finetuning.finetune.trainer - INFO - [run:89] - No improvement in f1_macro. Best: 0.3821. Patience: 2/20
2025-06-13 02:37:30 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 30/100 ---
2025-06-13 02:41:43 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 30: Loss=1.7676, Accuracy=0.4256, F1-Macro=0.3796
2025-06-13 02:41:43 - phase4_finetuning.finetune.trainer - INFO - [run:89] - No improvement in f1_macro. Best: 0.3821. Patience: 3/20
2025-06-13 02:41:43 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:394] - Saving periodic checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/checkpoint_epoch_30.pth
2025-06-13 02:41:49 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 31/100 ---
2025-06-13 02:46:05 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 31: Loss=1.7657, Accuracy=0.4256, F1-Macro=0.3828
2025-06-13 02:46:05 - phase4_finetuning.finetune.trainer - INFO - [run:89] - No improvement in f1_macro. Best: 0.3821. Patience: 4/20
2025-06-13 02:46:05 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 32/100 ---
2025-06-13 02:50:17 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 32: Loss=1.7632, Accuracy=0.4344, F1-Macro=0.3916
2025-06-13 02:50:17 - phase4_finetuning.finetune.trainer - INFO - [run:83] - Epoch 32: New best metric! f1_macro = 0.3916 (previously 0.3821)
2025-06-13 02:50:17 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:388] - Saving best model checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/best_model.pth
2025-06-13 02:50:31 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 33/100 ---
2025-06-13 02:54:46 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 33: Loss=1.7602, Accuracy=0.4431, F1-Macro=0.4055
2025-06-13 02:54:46 - phase4_finetuning.finetune.trainer - INFO - [run:83] - Epoch 33: New best metric! f1_macro = 0.4055 (previously 0.3916)
2025-06-13 02:54:46 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:388] - Saving best model checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/best_model.pth
2025-06-13 02:54:59 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 34/100 ---
2025-06-13 02:59:14 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 34: Loss=1.7577, Accuracy=0.4344, F1-Macro=0.3992
2025-06-13 02:59:14 - phase4_finetuning.finetune.trainer - INFO - [run:89] - No improvement in f1_macro. Best: 0.4055. Patience: 1/20
2025-06-13 02:59:14 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 35/100 ---
2025-06-13 03:03:26 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 35: Loss=1.7545, Accuracy=0.4344, F1-Macro=0.4003
2025-06-13 03:03:26 - phase4_finetuning.finetune.trainer - INFO - [run:89] - No improvement in f1_macro. Best: 0.4055. Patience: 2/20
2025-06-13 03:03:26 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 36/100 ---
2025-06-13 03:07:40 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 36: Loss=1.7508, Accuracy=0.4420, F1-Macro=0.4076
2025-06-13 03:07:40 - phase4_finetuning.finetune.trainer - INFO - [run:83] - Epoch 36: New best metric! f1_macro = 0.4076 (previously 0.4055)
2025-06-13 03:07:40 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:388] - Saving best model checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/best_model.pth
2025-06-13 03:07:53 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 37/100 ---
2025-06-13 03:12:13 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 37: Loss=1.7476, Accuracy=0.4464, F1-Macro=0.4133
2025-06-13 03:12:13 - phase4_finetuning.finetune.trainer - INFO - [run:83] - Epoch 37: New best metric! f1_macro = 0.4133 (previously 0.4076)
2025-06-13 03:12:13 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:388] - Saving best model checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/best_model.pth
2025-06-13 03:12:27 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 38/100 ---
2025-06-13 03:16:44 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 38: Loss=1.7444, Accuracy=0.4420, F1-Macro=0.4110
2025-06-13 03:16:44 - phase4_finetuning.finetune.trainer - INFO - [run:89] - No improvement in f1_macro. Best: 0.4133. Patience: 1/20
2025-06-13 03:16:44 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 39/100 ---
2025-06-13 03:20:59 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 39: Loss=1.7409, Accuracy=0.4409, F1-Macro=0.4109
2025-06-13 03:20:59 - phase4_finetuning.finetune.trainer - INFO - [run:89] - No improvement in f1_macro. Best: 0.4133. Patience: 2/20
2025-06-13 03:20:59 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 40/100 ---
2025-06-13 03:25:12 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 40: Loss=1.7373, Accuracy=0.4420, F1-Macro=0.4131
2025-06-13 03:25:12 - phase4_finetuning.finetune.trainer - INFO - [run:89] - No improvement in f1_macro. Best: 0.4133. Patience: 3/20
2025-06-13 03:25:12 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:394] - Saving periodic checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/checkpoint_epoch_40.pth
2025-06-13 03:25:19 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 41/100 ---
2025-06-13 03:29:39 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 41: Loss=1.7334, Accuracy=0.4431, F1-Macro=0.4151
2025-06-13 03:29:39 - phase4_finetuning.finetune.trainer - INFO - [run:83] - Epoch 41: New best metric! f1_macro = 0.4151 (previously 0.4133)
2025-06-13 03:29:39 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:388] - Saving best model checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/best_model.pth
2025-06-13 03:29:52 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 42/100 ---
2025-06-13 03:34:10 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 42: Loss=1.7290, Accuracy=0.4453, F1-Macro=0.4201
2025-06-13 03:34:10 - phase4_finetuning.finetune.trainer - INFO - [run:83] - Epoch 42: New best metric! f1_macro = 0.4201 (previously 0.4151)
2025-06-13 03:34:10 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:388] - Saving best model checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/best_model.pth
2025-06-13 03:34:23 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 43/100 ---
2025-06-13 03:38:41 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:187] - Validation Epoch 43: Loss=1.7247, Accuracy=0.4497, F1-Macro=0.4271
2025-06-13 03:38:41 - phase4_finetuning.finetune.trainer - INFO - [run:83] - Epoch 43: New best metric! f1_macro = 0.4271 (previously 0.4201)
2025-06-13 03:38:41 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:388] - Saving best model checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/02_ablation_no_ssl_20250613-003704/checkpoints/best_model.pth
2025-06-13 03:38:55 - phase4_finetuning.finetune.trainer - INFO - [run:72] - --- Starting Epoch 44/100 ---
