2025-06-11 20:17:40 - root - INFO - [setup_logging:75] - Logging configured. Log file: /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/HVT-XL_FineTune_Run_100epochs_20250611-201740/HVT-XL_FineTune_Run_100epochs_20250611-201740_20250611_201740.log. Logger 'root' Effective Level: INFO
2025-06-11 20:17:40 - __main__ - INFO - [run:37] - Starting fine-tuning run: HVT-XL_FineTune_Run_100epochs_20250611-201740
2025-06-11 20:17:40 - __main__ - INFO - [run:38] - Full configuration:
PACKAGE_ROOT_PATH: /teamspace/studios/this_studio/cvpr25/phase4_finetuning
PROJECT_ROOT_PATH: /teamspace/studios/this_studio/cvpr25
augmentations:
  cutmix_prob: 0.5
  enable: true
  mixup_alpha: 0.2
  severity: moderate
  strategy: cotton_disease
cudnn_benchmark: true
data:
  augmented_dataset_name: Augmented Dataset
  img_size:
  - 448
  - 448
  num_classes: 7
  num_workers: 4
  original_dataset_name: Original Dataset
  prefetch_factor: 2
  root_dir: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset
    for Cotton Leaf Disease Detection
  train_split_ratio: 0.95
  use_weighted_sampler: true
device: cuda
evaluation:
  early_stopping:
    metric: val_f1_macro
    min_delta: 0.0001
    patience: 20
  ema_decay: 0.9999
  tta_enabled: true
  use_ema: true
model:
  hvt_params:
    attn_drop_rate: 0.0
    depths:
    - 3
    - 6
    - 24
    - 3
    drop_path_rate: 0.2
    embed_dim_rgb: 192
    embed_dim_spectral: 0
    enable_consistency_loss_heads: false
    mlp_ratio: 4.0
    model_drop_rate: 0.0
    norm_layer_name: LayerNorm
    num_heads:
    - 6
    - 12
    - 24
    - 48
    patch_size: 14
    qkv_bias: true
    spectral_channels: 0
    ssl_enable_contrastive: false
    ssl_enable_mae: false
    use_dfca: false
    use_gradient_checkpointing: true
  resume_finetune_path: ''
  ssl_pretrained_path: /teamspace/studios/this_studio/cvpr25/phase3_pretraining/pretrain_checkpoints_hvt_xl/hvt_xl_simclr_t4_resumed_best_probe.pth
run_name_prefix: HVT-XL_FineTune_Run_100epochs
seed: 42
torch_compile:
  enable: false
  mode: reduce-overhead
training:
  accumulation_steps: 2
  amp_enabled: true
  batch_size: 16
  clip_grad_norm: 1.0
  epochs: 100
  freeze_backbone_epochs: 5
  loss:
    focal_alpha: 0.25
    focal_gamma: 2.0
    label_smoothing: 0.1
    type: combined
    use_class_weights: true
    weights:
      ce: 0.5
      focal: 0.5
  optimizer:
    lr_backbone_unfrozen: 5.0e-05
    lr_head_unfrozen: 0.001
  save_every_n_epochs: 10
  scheduler:
    div_factor: 25.0
    final_div_factor: 10000.0
    name: onecyclelr
    pct_start: 0.1

2025-06-11 20:17:40 - __main__ - INFO - [run:49] - Setting up datasets and dataloaders...
2025-06-11 20:17:40 - phase4_finetuning.utils.augmentations - INFO - [create_cotton_leaf_augmentation:148] - Creating augmentation strategy: 'cotton_disease' for image size (448, 448)
2025-06-11 20:17:40 - phase4_finetuning.utils.augmentations - INFO - [__init__:134] - CottonLeafDiseaseAugmentation initialized with severity 'moderate'.
2025-06-11 20:17:40 - phase4_finetuning.utils.augmentations - INFO - [create_cotton_leaf_augmentation:148] - Creating augmentation strategy: 'minimal' for image size (448, 448)
2025-06-11 20:17:40 - phase4_finetuning.dataset - INFO - [__init__:37] - Initializing Dataset for split 'train'...
2025-06-11 20:17:41 - phase4_finetuning.dataset - INFO - [__init__:53] - Found 9137 total image paths.
2025-06-11 20:17:41 - phase4_finetuning.dataset - INFO - [__init__:64] - Split 'train' size: 8680 samples.
2025-06-11 20:17:41 - phase4_finetuning.dataset - INFO - [__init__:37] - Initializing Dataset for split 'val'...
2025-06-11 20:17:43 - phase4_finetuning.dataset - INFO - [__init__:53] - Found 9137 total image paths.
2025-06-11 20:17:43 - phase4_finetuning.dataset - INFO - [__init__:64] - Split 'val' size: 457 samples.
2025-06-11 20:17:43 - __main__ - INFO - [run:86] - Discovered 7 classes.
2025-06-11 20:17:43 - __main__ - INFO - [run:96] - Using WeightedRandomSampler for training.
2025-06-11 20:17:43 - __main__ - INFO - [run:103] - Creating HVT model for fine-tuning...
2025-06-11 20:17:43 - phase2_model.models.hvt - INFO - [create_disease_aware_hvt:602] - Factory: Creating DiseaseAwareHVT for img_size: (448, 448), num_classes: 7
2025-06-11 20:17:46 - phase2_model.models.hvt - INFO - [__init__:325] - HVT: Running RGB stream only. No fusion.
2025-06-11 20:17:48 - phase2_model.models.hvt - INFO - [__init__:359] - DiseaseAwareHVT initialized for image size (448, 448) and 7 classes.
2025-06-11 20:17:48 - __main__ - INFO - [run:111] - Initializing EnhancedFinetuner...
2025-06-11 20:17:48 - phase4_finetuning.finetune.trainer - INFO - [_load_ssl_weights:284] - Attempting to load SSL backbone weights from: /teamspace/studios/this_studio/cvpr25/phase3_pretraining/pretrain_checkpoints_hvt_xl/hvt_xl_simclr_t4_resumed_best_probe.pth
2025-06-11 20:17:52 - phase4_finetuning.finetune.trainer - INFO - [_load_ssl_weights:293] - SSL weights loaded. Missing keys in model: []. Unexpected keys in checkpoint: []
2025-06-11 20:17:53 - phase4_finetuning.dataset - INFO - [get_class_weights:96] - Computed class weights for split 'train': [1.045 0.906 1.039 1.032 1.063 0.831 1.159]
2025-06-11 20:17:53 - phase4_finetuning.utils.losses - INFO - [__init__:21] - FocalLoss initialized with alpha=0.25, gamma=2.0.
2025-06-11 20:17:53 - phase4_finetuning.utils.losses - INFO - [__init__:54] - CombinedLoss initialized with CE weight=0.5, Focal weight=0.5, Smoothing=0.1.
2025-06-11 20:17:53 - phase4_finetuning.utils.ema - INFO - [_create_shadow_copy:55] - Creating EMA shadow model by re-instantiating HVT class.
2025-06-11 20:17:55 - phase2_model.models.hvt - INFO - [__init__:325] - HVT: Running RGB stream only. No fusion.
2025-06-11 20:17:57 - phase2_model.models.hvt - INFO - [__init__:359] - DiseaseAwareHVT initialized for image size (448, 448) and 7 classes.
2025-06-11 20:17:58 - phase4_finetuning.utils.ema - INFO - [__init__:44] - EMA helper initialized with decay=0.9999. Shadow model created.
2025-06-11 20:17:58 - phase4_finetuning.finetune.trainer - INFO - [__init__:49] - Trainer initialized. Model has 273,615,751 trainable parameters.
2025-06-11 20:17:58 - __main__ - INFO - [run:122] - Starting the training and validation loop...
2025-06-11 20:17:58 - phase4_finetuning.finetune.trainer - INFO - [run:53] - Starting fine-tuning run. Monitoring 'val_f1_macro' for best model.
2025-06-11 20:17:58 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 1/100 ---
2025-06-11 20:17:58 - phase4_finetuning.finetune.trainer - INFO - [_set_parameter_groups_for_epoch:261] - Epoch 1: Backbone FROZEN.
2025-06-11 20:17:58 - phase4_finetuning.finetune.trainer - INFO - [_set_parameter_groups_for_epoch:263] - Trainable params updated: 13,831
2025-06-11 20:20:22 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 1: Loss=1.1563, Accuracy=0.1291, F1-Macro=0.0657
2025-06-11 20:20:22 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 2/100 ---
2025-06-11 20:22:40 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 2: Loss=1.1551, Accuracy=0.1335, F1-Macro=0.0693
2025-06-11 20:22:40 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 3/100 ---
2025-06-11 20:24:58 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 3: Loss=1.1531, Accuracy=0.1400, F1-Macro=0.0725
2025-06-11 20:24:58 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 4/100 ---
2025-06-11 20:27:13 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 4: Loss=1.1509, Accuracy=0.1685, F1-Macro=0.0976
2025-06-11 20:27:13 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 5/100 ---
2025-06-11 20:29:34 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 5: Loss=1.1486, Accuracy=0.1860, F1-Macro=0.1145
2025-06-11 20:29:34 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 6/100 ---
2025-06-11 20:29:34 - phase4_finetuning.finetune.trainer - INFO - [_set_parameter_groups_for_epoch:259] - Epoch 6: Backbone UNFROZEN.
2025-06-11 20:29:34 - phase4_finetuning.finetune.trainer - INFO - [_set_parameter_groups_for_epoch:263] - Trainable params updated: 273,615,751
2025-06-11 20:33:47 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 6: Loss=1.1462, Accuracy=0.2079, F1-Macro=0.1298
2025-06-11 20:33:47 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 7/100 ---
2025-06-11 20:37:59 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 7: Loss=1.1436, Accuracy=0.2254, F1-Macro=0.1417
2025-06-11 20:37:59 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 8/100 ---
2025-06-11 20:42:11 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 8: Loss=1.1408, Accuracy=0.2363, F1-Macro=0.1454
2025-06-11 20:42:11 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 9/100 ---
2025-06-11 20:46:24 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 9: Loss=1.1378, Accuracy=0.2473, F1-Macro=0.1505
2025-06-11 20:46:24 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 10/100 ---
2025-06-11 20:50:36 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 10: Loss=1.1346, Accuracy=0.2560, F1-Macro=0.1529
2025-06-11 20:50:36 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:328] - Saving periodic checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/HVT-XL_FineTune_Run_100epochs_20250611-201740/checkpoints/checkpoint_epoch_10.pth
2025-06-11 20:50:43 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 11/100 ---
2025-06-11 20:54:58 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 11: Loss=1.1312, Accuracy=0.2670, F1-Macro=0.1570
2025-06-11 20:54:58 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 12/100 ---
2025-06-11 20:59:10 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 12: Loss=1.1276, Accuracy=0.2735, F1-Macro=0.1605
2025-06-11 20:59:10 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 13/100 ---
2025-06-11 21:03:21 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 13: Loss=1.1240, Accuracy=0.2845, F1-Macro=0.1785
2025-06-11 21:03:21 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 14/100 ---
2025-06-11 21:07:33 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 14: Loss=1.1201, Accuracy=0.2976, F1-Macro=0.1885
2025-06-11 21:07:33 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 15/100 ---
2025-06-11 21:11:45 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 15: Loss=1.1164, Accuracy=0.3020, F1-Macro=0.1920
2025-06-11 21:11:45 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 16/100 ---
2025-06-11 21:15:59 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 16: Loss=1.1127, Accuracy=0.3063, F1-Macro=0.1953
2025-06-11 21:15:59 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 17/100 ---
2025-06-11 21:20:11 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 17: Loss=1.1090, Accuracy=0.3107, F1-Macro=0.1970
2025-06-11 21:20:11 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 18/100 ---
2025-06-11 21:24:23 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 18: Loss=1.1055, Accuracy=0.3217, F1-Macro=0.2182
2025-06-11 21:24:23 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 19/100 ---
2025-06-11 21:28:36 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 19: Loss=1.1017, Accuracy=0.3304, F1-Macro=0.2266
2025-06-11 21:28:36 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 20/100 ---
2025-06-11 21:32:48 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 20: Loss=1.0981, Accuracy=0.3326, F1-Macro=0.2282
2025-06-11 21:32:48 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:328] - Saving periodic checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/HVT-XL_FineTune_Run_100epochs_20250611-201740/checkpoints/checkpoint_epoch_20.pth
2025-06-11 21:32:54 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 21/100 ---
2025-06-11 21:37:09 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 21: Loss=1.0945, Accuracy=0.3414, F1-Macro=0.2418
2025-06-11 21:37:09 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 22/100 ---
2025-06-11 21:41:22 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 22: Loss=1.0906, Accuracy=0.3545, F1-Macro=0.2581
2025-06-11 21:41:22 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 23/100 ---
2025-06-11 21:45:35 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 23: Loss=1.0866, Accuracy=0.3611, F1-Macro=0.2651
2025-06-11 21:45:35 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 24/100 ---
2025-06-11 21:49:48 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 24: Loss=1.0829, Accuracy=0.3654, F1-Macro=0.2702
2025-06-11 21:49:48 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 25/100 ---
2025-06-11 21:54:02 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 25: Loss=1.0793, Accuracy=0.3764, F1-Macro=0.2847
2025-06-11 21:54:02 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 26/100 ---
2025-06-11 21:58:16 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 26: Loss=1.0756, Accuracy=0.3873, F1-Macro=0.3047
2025-06-11 21:58:16 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 27/100 ---
2025-06-11 22:02:29 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 27: Loss=1.0718, Accuracy=0.4004, F1-Macro=0.3259
2025-06-11 22:02:29 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 28/100 ---
2025-06-11 22:06:42 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 28: Loss=1.0683, Accuracy=0.4070, F1-Macro=0.3388
2025-06-11 22:06:42 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 29/100 ---
2025-06-11 22:10:54 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 29: Loss=1.0648, Accuracy=0.4158, F1-Macro=0.3556
2025-06-11 22:10:54 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 30/100 ---
2025-06-11 22:15:06 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 30: Loss=1.0614, Accuracy=0.4267, F1-Macro=0.3691
2025-06-11 22:15:06 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:328] - Saving periodic checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/HVT-XL_FineTune_Run_100epochs_20250611-201740/checkpoints/checkpoint_epoch_30.pth
2025-06-11 22:15:12 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 31/100 ---
2025-06-11 22:19:25 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 31: Loss=1.0582, Accuracy=0.4420, F1-Macro=0.3911
2025-06-11 22:19:25 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 32/100 ---
2025-06-11 22:23:35 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 32: Loss=1.0545, Accuracy=0.4486, F1-Macro=0.4007
2025-06-11 22:23:35 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 33/100 ---
2025-06-11 22:27:47 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 33: Loss=1.0507, Accuracy=0.4726, F1-Macro=0.4262
2025-06-11 22:27:47 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 34/100 ---
2025-06-11 22:31:58 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 34: Loss=1.0469, Accuracy=0.4858, F1-Macro=0.4422
2025-06-11 22:31:58 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 35/100 ---
2025-06-11 22:36:08 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 35: Loss=1.0429, Accuracy=0.5098, F1-Macro=0.4715
2025-06-11 22:36:08 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 36/100 ---
2025-06-11 22:40:19 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 36: Loss=1.0389, Accuracy=0.5274, F1-Macro=0.4894
2025-06-11 22:40:19 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 37/100 ---
2025-06-11 22:44:31 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 37: Loss=1.0347, Accuracy=0.5295, F1-Macro=0.4927
2025-06-11 22:44:31 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 38/100 ---
2025-06-11 22:48:42 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 38: Loss=1.0306, Accuracy=0.5427, F1-Macro=0.5095
2025-06-11 22:48:42 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 39/100 ---
2025-06-11 22:52:53 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 39: Loss=1.0266, Accuracy=0.5558, F1-Macro=0.5237
2025-06-11 22:52:53 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 40/100 ---
2025-06-11 22:57:04 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 40: Loss=1.0229, Accuracy=0.5689, F1-Macro=0.5415
2025-06-11 22:57:04 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:328] - Saving periodic checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/HVT-XL_FineTune_Run_100epochs_20250611-201740/checkpoints/checkpoint_epoch_40.pth
2025-06-11 22:57:11 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 41/100 ---
2025-06-11 23:01:24 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 41: Loss=1.0190, Accuracy=0.5886, F1-Macro=0.5641
2025-06-11 23:01:24 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 42/100 ---
2025-06-11 23:05:35 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 42: Loss=1.0151, Accuracy=0.6018, F1-Macro=0.5796
2025-06-11 23:05:35 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 43/100 ---
2025-06-11 23:09:46 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 43: Loss=1.0110, Accuracy=0.6127, F1-Macro=0.5905
2025-06-11 23:09:46 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 44/100 ---
2025-06-11 23:13:58 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 44: Loss=1.0071, Accuracy=0.6368, F1-Macro=0.6192
2025-06-11 23:13:58 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 45/100 ---
2025-06-11 23:18:09 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 45: Loss=1.0032, Accuracy=0.6499, F1-Macro=0.6343
2025-06-11 23:18:09 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 46/100 ---
2025-06-11 23:22:20 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 46: Loss=0.9992, Accuracy=0.6586, F1-Macro=0.6435
2025-06-11 23:22:20 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 47/100 ---
2025-06-11 23:26:32 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 47: Loss=0.9952, Accuracy=0.6652, F1-Macro=0.6513
2025-06-11 23:26:32 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 48/100 ---
2025-06-11 23:30:43 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 48: Loss=0.9912, Accuracy=0.6805, F1-Macro=0.6674
2025-06-11 23:30:43 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 49/100 ---
2025-06-11 23:34:54 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 49: Loss=0.9872, Accuracy=0.6893, F1-Macro=0.6748
2025-06-11 23:34:54 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 50/100 ---
2025-06-11 23:39:05 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 50: Loss=0.9832, Accuracy=0.7002, F1-Macro=0.6883
2025-06-11 23:39:05 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:328] - Saving periodic checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/HVT-XL_FineTune_Run_100epochs_20250611-201740/checkpoints/checkpoint_epoch_50.pth
2025-06-11 23:39:12 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 51/100 ---
2025-06-11 23:43:25 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 51: Loss=0.9791, Accuracy=0.7046, F1-Macro=0.6934
2025-06-11 23:43:25 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 52/100 ---
2025-06-11 23:47:36 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 52: Loss=0.9750, Accuracy=0.7090, F1-Macro=0.6973
2025-06-11 23:47:36 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 53/100 ---
2025-06-11 23:51:47 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 53: Loss=0.9709, Accuracy=0.7177, F1-Macro=0.7076
2025-06-11 23:51:47 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 54/100 ---
2025-06-11 23:55:58 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 54: Loss=0.9668, Accuracy=0.7287, F1-Macro=0.7206
2025-06-11 23:55:58 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 55/100 ---
2025-06-12 00:00:10 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 55: Loss=0.9626, Accuracy=0.7396, F1-Macro=0.7338
2025-06-12 00:00:10 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 56/100 ---
2025-06-12 00:04:21 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 56: Loss=0.9584, Accuracy=0.7418, F1-Macro=0.7364
2025-06-12 00:04:21 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 57/100 ---
2025-06-12 00:08:31 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 57: Loss=0.9543, Accuracy=0.7440, F1-Macro=0.7400
2025-06-12 00:08:31 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 58/100 ---
2025-06-12 00:12:43 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 58: Loss=0.9504, Accuracy=0.7484, F1-Macro=0.7448
2025-06-12 00:12:43 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 59/100 ---
2025-06-12 00:16:53 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 59: Loss=0.9466, Accuracy=0.7484, F1-Macro=0.7445
2025-06-12 00:16:53 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 60/100 ---
2025-06-12 00:21:05 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 60: Loss=0.9430, Accuracy=0.7571, F1-Macro=0.7543
2025-06-12 00:21:05 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:328] - Saving periodic checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/HVT-XL_FineTune_Run_100epochs_20250611-201740/checkpoints/checkpoint_epoch_60.pth
2025-06-12 00:21:11 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 61/100 ---
2025-06-12 00:25:25 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 61: Loss=0.9393, Accuracy=0.7615, F1-Macro=0.7596
2025-06-12 00:25:25 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 62/100 ---
2025-06-12 00:29:37 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 62: Loss=0.9360, Accuracy=0.7702, F1-Macro=0.7679
2025-06-12 00:29:37 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 63/100 ---
2025-06-12 00:33:50 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 63: Loss=0.9325, Accuracy=0.7790, F1-Macro=0.7776
2025-06-12 00:33:50 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 64/100 ---
2025-06-12 00:38:01 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 64: Loss=0.9292, Accuracy=0.7856, F1-Macro=0.7835
2025-06-12 00:38:01 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 65/100 ---
2025-06-12 00:42:13 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 65: Loss=0.9258, Accuracy=0.7834, F1-Macro=0.7814
2025-06-12 00:42:13 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 66/100 ---
2025-06-12 00:46:25 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 66: Loss=0.9224, Accuracy=0.7965, F1-Macro=0.7951
2025-06-12 00:46:25 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 67/100 ---
2025-06-12 00:50:37 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 67: Loss=0.9191, Accuracy=0.8009, F1-Macro=0.7993
2025-06-12 00:50:37 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 68/100 ---
2025-06-12 00:54:49 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 68: Loss=0.9158, Accuracy=0.8053, F1-Macro=0.8033
2025-06-12 00:54:49 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 69/100 ---
2025-06-12 00:59:01 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 69: Loss=0.9127, Accuracy=0.8053, F1-Macro=0.8033
2025-06-12 00:59:01 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 70/100 ---
2025-06-12 01:03:13 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 70: Loss=0.9096, Accuracy=0.8140, F1-Macro=0.8124
2025-06-12 01:03:13 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:328] - Saving periodic checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/HVT-XL_FineTune_Run_100epochs_20250611-201740/checkpoints/checkpoint_epoch_70.pth
2025-06-12 01:03:19 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 71/100 ---
2025-06-12 01:07:33 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 71: Loss=0.9065, Accuracy=0.8228, F1-Macro=0.8212
2025-06-12 01:07:33 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 72/100 ---
2025-06-12 01:11:44 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 72: Loss=0.9036, Accuracy=0.8228, F1-Macro=0.8212
2025-06-12 01:11:44 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 73/100 ---
2025-06-12 01:15:55 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 73: Loss=0.9007, Accuracy=0.8271, F1-Macro=0.8259
2025-06-12 01:15:55 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 74/100 ---
2025-06-12 01:20:06 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 74: Loss=0.8978, Accuracy=0.8337, F1-Macro=0.8328
2025-06-12 01:20:06 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 75/100 ---
2025-06-12 01:24:16 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 75: Loss=0.8950, Accuracy=0.8403, F1-Macro=0.8399
2025-06-12 01:24:16 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 76/100 ---
2025-06-12 01:28:27 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 76: Loss=0.8923, Accuracy=0.8446, F1-Macro=0.8447
2025-06-12 01:28:27 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 77/100 ---
2025-06-12 01:32:38 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 77: Loss=0.8896, Accuracy=0.8425, F1-Macro=0.8423
2025-06-12 01:32:38 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 78/100 ---
2025-06-12 01:36:49 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 78: Loss=0.8870, Accuracy=0.8425, F1-Macro=0.8423
2025-06-12 01:36:49 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 79/100 ---
2025-06-12 01:40:59 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 79: Loss=0.8845, Accuracy=0.8512, F1-Macro=0.8515
2025-06-12 01:40:59 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 80/100 ---
2025-06-12 01:45:10 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 80: Loss=0.8821, Accuracy=0.8534, F1-Macro=0.8537
2025-06-12 01:45:10 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:328] - Saving periodic checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/HVT-XL_FineTune_Run_100epochs_20250611-201740/checkpoints/checkpoint_epoch_80.pth
2025-06-12 01:45:16 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 81/100 ---
2025-06-12 01:49:28 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 81: Loss=0.8798, Accuracy=0.8534, F1-Macro=0.8537
2025-06-12 01:49:28 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 82/100 ---
2025-06-12 01:53:39 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 82: Loss=0.8776, Accuracy=0.8621, F1-Macro=0.8626
2025-06-12 01:53:39 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 83/100 ---
2025-06-12 01:57:50 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 83: Loss=0.8754, Accuracy=0.8643, F1-Macro=0.8648
2025-06-12 01:57:50 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 84/100 ---
2025-06-12 02:02:00 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 84: Loss=0.8734, Accuracy=0.8665, F1-Macro=0.8670
2025-06-12 02:02:00 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 85/100 ---
2025-06-12 02:06:11 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 85: Loss=0.8714, Accuracy=0.8665, F1-Macro=0.8670
2025-06-12 02:06:11 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 86/100 ---
2025-06-12 02:10:22 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 86: Loss=0.8694, Accuracy=0.8643, F1-Macro=0.8648
2025-06-12 02:10:22 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 87/100 ---
2025-06-12 02:14:37 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 87: Loss=0.8674, Accuracy=0.8643, F1-Macro=0.8648
2025-06-12 02:14:37 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 88/100 ---
2025-06-12 02:18:50 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 88: Loss=0.8656, Accuracy=0.8709, F1-Macro=0.8713
2025-06-12 02:18:50 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 89/100 ---
2025-06-12 02:23:02 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 89: Loss=0.8638, Accuracy=0.8731, F1-Macro=0.8736
2025-06-12 02:23:02 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 90/100 ---
2025-06-12 02:27:14 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 90: Loss=0.8620, Accuracy=0.8775, F1-Macro=0.8777
2025-06-12 02:27:14 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:328] - Saving periodic checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/HVT-XL_FineTune_Run_100epochs_20250611-201740/checkpoints/checkpoint_epoch_90.pth
2025-06-12 02:27:20 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 91/100 ---
2025-06-12 02:31:35 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 91: Loss=0.8603, Accuracy=0.8796, F1-Macro=0.8796
2025-06-12 02:31:35 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 92/100 ---
2025-06-12 02:35:47 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 92: Loss=0.8586, Accuracy=0.8796, F1-Macro=0.8796
2025-06-12 02:35:47 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 93/100 ---
2025-06-12 02:39:59 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 93: Loss=0.8570, Accuracy=0.8884, F1-Macro=0.8884
2025-06-12 02:39:59 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 94/100 ---
2025-06-12 02:44:11 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 94: Loss=0.8555, Accuracy=0.8884, F1-Macro=0.8884
2025-06-12 02:44:11 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 95/100 ---
2025-06-12 02:48:22 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 95: Loss=0.8540, Accuracy=0.8906, F1-Macro=0.8904
2025-06-12 02:48:22 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 96/100 ---
2025-06-12 02:52:34 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 96: Loss=0.8525, Accuracy=0.8906, F1-Macro=0.8904
2025-06-12 02:52:34 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 97/100 ---
2025-06-12 02:56:45 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 97: Loss=0.8512, Accuracy=0.8928, F1-Macro=0.8926
2025-06-12 02:56:45 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 98/100 ---
2025-06-12 03:00:58 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 98: Loss=0.8499, Accuracy=0.8928, F1-Macro=0.8926
2025-06-12 03:00:58 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 99/100 ---
2025-06-12 03:05:09 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 99: Loss=0.8486, Accuracy=0.8950, F1-Macro=0.8954
2025-06-12 03:05:09 - phase4_finetuning.finetune.trainer - INFO - [run:62] - --- Starting Epoch 100/100 ---
2025-06-12 03:09:24 - phase4_finetuning.finetune.trainer - INFO - [_validate_one_epoch:178] - Validation Epoch 100: Loss=0.8474, Accuracy=0.9015, F1-Macro=0.9024
2025-06-12 03:09:24 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:328] - Saving periodic checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/HVT-XL_FineTune_Run_100epochs_20250611-201740/checkpoints/checkpoint_epoch_100.pth
2025-06-12 03:09:30 - phase4_finetuning.finetune.trainer - INFO - [run:95] - Training finished. Saving final model state.
2025-06-12 03:09:30 - phase4_finetuning.finetune.trainer - INFO - [_save_checkpoint:325] - Saving final model checkpoint to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/HVT-XL_FineTune_Run_100epochs_20250611-201740/checkpoints/checkpoint_epoch_100_final.pth
2025-06-12 03:09:40 - __main__ - INFO - [run:124] - Fine-tuning run 'HVT-XL_FineTune_Run_100epochs_20250611-201740' finished successfully.
