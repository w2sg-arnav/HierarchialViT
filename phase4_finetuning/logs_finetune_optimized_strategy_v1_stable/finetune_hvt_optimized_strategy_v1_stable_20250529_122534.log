2025-05-29 12:25:34 - root - INFO - [setup_logging:75] - Logging configured. Log file: /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/finetune_hvt_optimized_strategy_v1_stable_20250529_122534.log. Logger 'root' Effective Level: DEBUG
2025-05-29 12:25:34 - __main__ - INFO - [main_execution_logic:243] - ======== Starting Phase 4: HVT Fine-tuning (Run ID: 20250529_122534) ========
2025-05-29 12:25:34 - __main__ - INFO - [main_execution_logic:244] - Full run configuration: {'seed': 42, 'device': 'cuda', 'PACKAGE_ROOT_PATH': '/teamspace/studios/this_studio/cvpr25/phase4_finetuning', 'PROJECT_ROOT_PATH': '/teamspace/studios/this_studio/cvpr25', 'log_dir': 'logs_finetune_optimized_strategy_v1_stable', 'log_file_finetune': 'finetune_hvt_optimized_strategy_v1_stable.log', 'best_model_filename': 'best_finetuned_hvt_optimized_strategy_v1_stable.pth', 'final_model_filename': 'final_finetuned_hvt_optimized_strategy_v1_stable.pth', 'checkpoint_save_dir_name': 'checkpoints_optimized_strategy_v1_stable', 'data_root': '/teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection', 'original_dataset_name': 'Original Dataset', 'augmented_dataset_name': 'Augmented Dataset', 'img_size': (448, 448), 'num_classes': 7, 'train_split_ratio': 0.85, 'normalize_data': True, 'use_weighted_sampler': True, 'weighted_sampler_mode': 'sqrt_inv_count', 'use_weighted_loss': True, 'num_workers': 4, 'prefetch_factor': 2, 'model_architecture_name': 'DiseaseAwareHVT_Optimized_Strategy_Finetune_v1_Stable', 'pretrained_checkpoint_path': '/teamspace/studios/this_studio/cvpr25/phase3_pretraining/pretrain_checkpoints_hvt_xl/hvt_xl_simclr_t4_resumed_best_probe.pth', 'load_pretrained_backbone': True, 'hvt_params_for_model_init': {'patch_size': 14, 'embed_dim_rgb': 192, 'embed_dim_spectral': 192, 'spectral_channels': 0, 'depths': [3, 6, 24, 3], 'num_heads': [6, 12, 24, 48], 'mlp_ratio': 4.0, 'qkv_bias': True, 'model_drop_rate': 0.1, 'attn_drop_rate': 0.0, 'drop_path_rate': 0.05, 'norm_layer_name': 'LayerNorm', 'use_dfca': False, 'use_gradient_checkpointing': True, 'ssl_enable_mae': False, 'ssl_enable_contrastive': False, 'enable_consistency_loss_heads': False, 'dfca_embed_dim_match_rgb': True, 'dfca_num_heads': 32, 'dfca_drop_rate': 0.1, 'dfca_use_disease_mask': True, 'ssl_mae_mask_ratio': 0.75, 'ssl_mae_decoder_dim': 64, 'ssl_mae_norm_pix_loss': True, 'ssl_contrastive_projector_dim': 128, 'ssl_contrastive_projector_depth': 2}, 'enable_torch_compile': False, 'torch_compile_mode': 'reduce-overhead', 'matmul_precision': 'high', 'cudnn_benchmark': True, 'freeze_backbone_epochs': 5, 'epochs': 150, 'batch_size': 8, 'accumulation_steps': 6, 'amp_enabled': False, 'clip_grad_norm': 0.5, 'optimizer': 'AdamW', 'optimizer_params': {'betas': (0.9, 0.999), 'eps': 1e-07}, 'weight_decay': 0.05, 'lr_head_frozen_phase': 0.0001, 'lr_backbone_unfrozen_phase': 1e-05, 'lr_head_unfrozen_phase': 0.0001, 'scheduler': 'WarmupCosine', 'warmup_epochs': 15, 'eta_min_lr': 1e-07, 'loss_label_smoothing': 0.1, 'augmentations_enabled': True, 'augmentation_strategy': 'stable_enhanced', 'augmentation_severity': 'mild', 'evaluate_every_n_epochs': 1, 'early_stopping_patience': 25, 'metric_to_monitor_early_stopping': 'f1_macro', 'tta_enabled_val': True, 'ssl_pretrain_img_size_fallback': (448, 448), 'debug_nan_detection': True, 'stop_on_nan_threshold': 5, 'monitor_gradients': True, 'gradient_log_interval': 50, 'save_checkpoint_every_n_epochs': 10}
2025-05-29 12:25:34 - __main__ - INFO - [set_global_seed:66] - Global random seed set to: 42
2025-05-29 12:25:34 - __main__ - INFO - [main_execution_logic:248] - Using device: cuda. GPU: Tesla T4
2025-05-29 12:25:34 - phase4_finetuning.dataset - INFO - [__init__:54] - [DATASET INIT - train] Root: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection, ImgSize: (448, 448), Normalize: True
2025-05-29 12:25:34 - phase4_finetuning.dataset - INFO - [__init__:74] - [DATASET INIT - train] Scanning: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection/Original Dataset
2025-05-29 12:25:34 - phase4_finetuning.dataset - INFO - [__init__:74] - [DATASET INIT - train] Scanning: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection/Augmented Dataset
2025-05-29 12:25:35 - phase4_finetuning.dataset - INFO - [__init__:105] - [DATASET INIT - train] Total valid image paths collected: 9137 from ~9137 items considered.
2025-05-29 12:25:35 - phase4_finetuning.dataset - INFO - [__init__:117] - [DATASET INIT - train] Dataset split size: 7766 samples.
2025-05-29 12:25:35 - phase4_finetuning.dataset - INFO - [__init__:128] - [DATASET INIT - train] Base RGB Transforms: Compose(
      ToImage()
      ToDtype(scale=True)
      Resize(size=[448, 448], interpolation=InterpolationMode.BICUBIC, antialias=True)
      Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225], inplace=False)
)
2025-05-29 12:25:35 - phase4_finetuning.dataset - INFO - [__init__:54] - [DATASET INIT - val] Root: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection, ImgSize: (448, 448), Normalize: True
2025-05-29 12:25:35 - phase4_finetuning.dataset - INFO - [__init__:74] - [DATASET INIT - val] Scanning: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection/Original Dataset
2025-05-29 12:25:35 - phase4_finetuning.dataset - INFO - [__init__:74] - [DATASET INIT - val] Scanning: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection/Augmented Dataset
2025-05-29 12:25:37 - phase4_finetuning.dataset - INFO - [__init__:105] - [DATASET INIT - val] Total valid image paths collected: 9137 from ~9137 items considered.
2025-05-29 12:25:37 - phase4_finetuning.dataset - INFO - [__init__:117] - [DATASET INIT - val] Dataset split size: 1371 samples.
2025-05-29 12:25:37 - phase4_finetuning.dataset - INFO - [__init__:128] - [DATASET INIT - val] Base RGB Transforms: Compose(
      ToImage()
      ToDtype(scale=True)
      Resize(size=[448, 448], interpolation=InterpolationMode.BICUBIC, antialias=True)
      Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225], inplace=False)
)
2025-05-29 12:25:37 - __main__ - INFO - [main_execution_logic:276] - Using WeightedRandomSampler with 'sqrt_inv_count' mode. Per-class weights: [0.031 0.029 0.031 0.03  0.031 0.027 0.032]
2025-05-29 12:25:37 - __main__ - INFO - [main_execution_logic:287] - WeightedRandomSampler enabled (mode: sqrt_inv_count).
2025-05-29 12:25:37 - __main__ - INFO - [main_execution_logic:293] - Dataloaders created. Train batches: 970, Val batches: 172
2025-05-29 12:25:37 - phase2_model.models.hvt - INFO - [create_disease_aware_hvt:602] - Factory: Creating DiseaseAwareHVT for img_size: (448, 448), num_classes: 7
2025-05-29 12:25:40 - phase2_model.models.hvt - INFO - [__init__:325] - HVT: Running RGB stream only. No fusion.
2025-05-29 12:25:42 - phase2_model.models.hvt - INFO - [__init__:359] - DiseaseAwareHVT initialized for image size (448, 448) and 7 classes.
2025-05-29 12:25:42 - __main__.load_and_prepare_hvt_model - INFO - [load_and_prepare_hvt_model:136] - Loading SSL backbone weights from: /teamspace/studios/this_studio/cvpr25/phase3_pretraining/pretrain_checkpoints_hvt_xl/hvt_xl_simclr_t4_resumed_best_probe.pth
2025-05-29 12:25:45 - __main__.load_and_prepare_hvt_model - INFO - [load_and_prepare_hvt_model:149] - SSL and Finetune img_size match: (448, 448).
2025-05-29 12:25:45 - __main__.load_and_prepare_hvt_model - INFO - [load_and_prepare_hvt_model:186] - PE rgb_pos_embed: Shape matches. Loading directly.
2025-05-29 12:25:45 - __main__.load_and_prepare_hvt_model - INFO - [load_and_prepare_hvt_model:197] - SSL Backbone weights loaded: 450 direct, 0 PE interpolated, 2 head layers skipped.
2025-05-29 12:25:45 - __main__.load_and_prepare_hvt_model - WARNING - [load_and_prepare_hvt_model:198] - Missing keys when loading SSL backbone: ['classifier_head.weight', 'classifier_head.bias']
2025-05-29 12:25:45 - __main__.load_and_prepare_hvt_model - INFO - [load_and_prepare_hvt_model:218] - Re-initialized HVT classifier_head for 7 classes (in_features=1536).
2025-05-29 12:25:46 - __main__ - INFO - [main_execution_logic:298] - Model ready. Total params: 273,615,751, Trainable params: 273,615,751
2025-05-29 12:25:46 - phase4_finetuning.utils.augmentations - INFO - [create_augmentation:228] - Creating augmentation strategy: 'stable_enhanced' with img_size: (448, 448), kwargs: {'severity': 'mild'}
2025-05-29 12:25:46 - phase4_finetuning.utils.augmentations - INFO - [__init__:104] - StableEnhancedFinetuneAugmentation initialized with 'mild' severity for stability.
2025-05-29 12:25:46 - phase4_finetuning.utils.augmentations - DEBUG - [__init__:105] - Augmentation pipeline: Compose(
      RandomHorizontalFlip(p=0.5)
      RandomVerticalFlip(p=0.3)
      RandomRotation(degrees=[-10.0, 10.0], interpolation=InterpolationMode.BILINEAR, expand=False, fill=0.0)
      StableColorJitter()
      RandomAffine(degrees=[-5.0, 5.0], translate=(0.05, 0.05), scale=(0.95, 1.05), shear=[-5.0, 5.0], interpolation=InterpolationMode.BILINEAR, fill=0.0)
      RandomPerspective(p=0.15, distortion_scale=0.1, interpolation=InterpolationMode.BILINEAR, fill=0.0)
      RandomApply(    GaussianBlur(kernel_size=(3, 3), sigma=[0.1, 0.5]))
      StableRandomErasing()
)
2025-05-29 12:25:46 - phase4_finetuning.dataset - INFO - [get_class_weights:196] - Computed class weights (inv_freq for loss) for split 'train': [1.034 0.905 1.061 1.02  1.065 0.829 1.164]
2025-05-29 12:25:46 - __main__ - INFO - [main_execution_logic:318] - Using weighted CrossEntropyLoss. Weights: [1.034 0.905 1.061 1.02  1.065 0.829 1.164]
2025-05-29 12:25:46 - __main__ - INFO - [main_execution_logic:329] - Optimizer initial setup: Backbone frozen. Head LR: 1.00e-04, Backbone LR: 0.00e+00
2025-05-29 12:25:46 - __main__ - INFO - [main_execution_logic:347] - Optimizer: AdamW created with overall defaults: {'lr': 0.0001, 'betas': (0.9, 0.999), 'eps': 1e-07, 'weight_decay': 0.05, 'amsgrad': False, 'foreach': None, 'maximize': False, 'capturable': False, 'differentiable': False, 'fused': None}
2025-05-29 12:25:46 - __main__ - INFO - [main_execution_logic:349] -   Group 'head': Configured LR 1.00e-04, WD 5.00e-02
2025-05-29 12:25:46 - __main__ - INFO - [main_execution_logic:349] -   Group 'backbone': Configured LR 0.00e+00, WD 5.00e-02
2025-05-29 12:25:46 - __main__ - INFO - [main_execution_logic:367] - Scheduler: WarmupCosine (per-step). WU Steps: 2415, Total Steps: 24150
2025-05-29 12:25:46 - phase4_finetuning.finetune.trainer - INFO - [__init__:54] - Finetuner initialized: device=cuda, accum_steps=6, AMP=False
2025-05-29 12:25:46 - phase4_finetuning.finetune.trainer - INFO - [__init__:55] - Using training augmentations: StableEnhancedFinetuneAugmentation
2025-05-29 12:25:46 - phase4_finetuning.finetune.trainer - INFO - [__init__:56] - Test-Time Augmentation (TTA) enabled for validation.
2025-05-29 12:25:46 - phase4_finetuning.finetune.trainer - INFO - [__init__:57] - NaN detection enabled. Stop threshold: 5 NaNs/epoch.
2025-05-29 12:25:46 - phase4_finetuning.finetune.trainer - INFO - [__init__:58] - Gradient monitoring enabled. Log interval: 50 optimizer steps.
2025-05-29 12:25:46 - __main__ - INFO - [main_execution_logic:401] - Checkpoints will be saved in: /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable
2025-05-29 12:25:46 - __main__ - INFO - [main_execution_logic:404] - LRs after scheduler initialization:
2025-05-29 12:25:46 - __main__ - INFO - [main_execution_logic:409] -   Opt Group 0 ('head'): Current LR in optimizer 0.00e+00, Scheduler Base LR 1.00e-04
2025-05-29 12:25:46 - __main__ - INFO - [main_execution_logic:409] -   Opt Group 1 ('backbone'): Current LR in optimizer 0.00e+00, Scheduler Base LR 0.00e+00
2025-05-29 12:25:46 - __main__ - INFO - [main_execution_logic:412] - Starting fine-tuning for 150 epochs. Monitor: 'f1_macro'. Backbone frozen for initial 5 epochs.
2025-05-29 12:25:46 - __main__ - INFO - [main_execution_logic:434] - Epoch 1: Starting in Frozen Backbone phase.
2025-05-29 12:26:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E1 OptStep 50: Grad Norm: 10.4876
2025-05-29 12:27:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E1 OptStep 100: Grad Norm: 7.4451
2025-05-29 12:27:51 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E1 OptStep 150: Grad Norm: 5.9138
2025-05-29 12:28:00 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 1 training finished. Avg Loss: 2.0754, Final LR: 6.67e-06, Opt Steps: 161, NaN count: 0
2025-05-29 12:29:02 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 2.0073, accuracy: 0.1889, f1_macro: 0.0840, f1_weighted: 0.0812, precision_macro: 0.0655, precision_weighted: 0.0642, recall_macro: 0.1953, recall_weighted: 0.1889, f1_Bacterial_Blight: 0.0000, f1_Curl_Virus: 0.0177, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.3660, f1_Leaf_Hopper_Jassids: 0.2041, f1_Leaf_Redding: 0.0000, f1_Leaf_Variegation: 0.0000
2025-05-29 12:29:04 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 12:29:04 - __main__ - INFO - [main_execution_logic:479] - E1: New best! Val f1_macro: 0.0840
2025-05-29 12:29:04 - __main__ - INFO - [main_execution_logic:496] - Epoch 1 completed in 197.71s.
2025-05-29 12:29:04 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E1 End: Alloc 1063.5MB, Reserved 1388.0MB
2025-05-29 12:29:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E2 OptStep 50: Grad Norm: 5.1011
2025-05-29 12:30:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E2 OptStep 100: Grad Norm: 5.2977
2025-05-29 12:31:06 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E2 OptStep 150: Grad Norm: 6.0707
2025-05-29 12:31:15 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 2 training finished. Avg Loss: 1.9199, Final LR: 1.33e-05, Opt Steps: 161, NaN count: 0
2025-05-29 12:32:17 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.8970, accuracy: 0.2553, f1_macro: 0.2193, f1_weighted: 0.2259, precision_macro: 0.2262, precision_weighted: 0.2312, recall_macro: 0.2487, recall_weighted: 0.2553, f1_Bacterial_Blight: 0.1945, f1_Curl_Virus: 0.0000, f1_Healthy_Leaf: 0.0980, f1_Herbicide_Growth_Damage: 0.2836, f1_Leaf_Hopper_Jassids: 0.1721, f1_Leaf_Redding: 0.5247, f1_Leaf_Variegation: 0.2625
2025-05-29 12:32:20 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 12:32:20 - __main__ - INFO - [main_execution_logic:479] - E2: New best! Val f1_macro: 0.2193
2025-05-29 12:32:20 - __main__ - INFO - [main_execution_logic:496] - Epoch 2 completed in 196.53s.
2025-05-29 12:32:20 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E2 End: Alloc 1063.5MB, Reserved 1774.0MB
2025-05-29 12:33:01 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E3 OptStep 50: Grad Norm: 3.0100
2025-05-29 12:33:42 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E3 OptStep 100: Grad Norm: 3.0865
2025-05-29 12:34:22 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E3 OptStep 150: Grad Norm: 4.2261
2025-05-29 12:34:32 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 3 training finished. Avg Loss: 1.8286, Final LR: 2.00e-05, Opt Steps: 161, NaN count: 0
2025-05-29 12:35:34 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.8281, accuracy: 0.3107, f1_macro: 0.2567, f1_weighted: 0.2660, precision_macro: 0.3307, precision_weighted: 0.3293, recall_macro: 0.2959, recall_weighted: 0.3107, f1_Bacterial_Blight: 0.2469, f1_Curl_Virus: 0.0000, f1_Healthy_Leaf: 0.3006, f1_Herbicide_Growth_Damage: 0.3323, f1_Leaf_Hopper_Jassids: 0.1000, f1_Leaf_Redding: 0.5502, f1_Leaf_Variegation: 0.2667
2025-05-29 12:35:37 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 12:35:37 - __main__ - INFO - [main_execution_logic:479] - E3: New best! Val f1_macro: 0.2567
2025-05-29 12:35:37 - __main__ - INFO - [main_execution_logic:496] - Epoch 3 completed in 196.90s.
2025-05-29 12:35:37 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E3 End: Alloc 1063.5MB, Reserved 1774.0MB
2025-05-29 12:36:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E4 OptStep 50: Grad Norm: 4.3155
2025-05-29 12:36:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E4 OptStep 100: Grad Norm: 5.9793
2025-05-29 12:37:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E4 OptStep 150: Grad Norm: 3.9461
2025-05-29 12:37:48 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 4 training finished. Avg Loss: 1.7608, Final LR: 2.67e-05, Opt Steps: 161, NaN count: 0
2025-05-29 12:38:50 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.7617, accuracy: 0.3392, f1_macro: 0.2755, f1_weighted: 0.2836, precision_macro: 0.3079, precision_weighted: 0.3080, recall_macro: 0.3255, recall_weighted: 0.3392, f1_Bacterial_Blight: 0.2387, f1_Curl_Virus: 0.0170, f1_Healthy_Leaf: 0.3447, f1_Herbicide_Growth_Damage: 0.3780, f1_Leaf_Hopper_Jassids: 0.0208, f1_Leaf_Redding: 0.5505, f1_Leaf_Variegation: 0.3791
2025-05-29 12:38:55 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 12:38:55 - __main__ - INFO - [main_execution_logic:479] - E4: New best! Val f1_macro: 0.2755
2025-05-29 12:38:55 - __main__ - INFO - [main_execution_logic:496] - Epoch 4 completed in 197.32s.
2025-05-29 12:38:55 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E4 End: Alloc 1063.5MB, Reserved 1774.0MB
2025-05-29 12:39:36 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E5 OptStep 50: Grad Norm: 4.6034
2025-05-29 12:40:16 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E5 OptStep 100: Grad Norm: 3.2151
2025-05-29 12:40:56 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E5 OptStep 150: Grad Norm: 5.2377
2025-05-29 12:41:06 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 5 training finished. Avg Loss: 1.7026, Final LR: 3.33e-05, Opt Steps: 161, NaN count: 0
2025-05-29 12:42:08 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.7094, accuracy: 0.3654, f1_macro: 0.3072, f1_weighted: 0.3133, precision_macro: 0.3618, precision_weighted: 0.3583, recall_macro: 0.3529, recall_weighted: 0.3654, f1_Bacterial_Blight: 0.2520, f1_Curl_Virus: 0.0252, f1_Healthy_Leaf: 0.3862, f1_Herbicide_Growth_Damage: 0.4054, f1_Leaf_Hopper_Jassids: 0.0882, f1_Leaf_Redding: 0.5511, f1_Leaf_Variegation: 0.4421
2025-05-29 12:42:11 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 12:42:11 - __main__ - INFO - [main_execution_logic:479] - E5: New best! Val f1_macro: 0.3072
2025-05-29 12:42:11 - __main__ - INFO - [main_execution_logic:496] - Epoch 5 completed in 196.40s.
2025-05-29 12:42:11 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E5 End: Alloc 1063.5MB, Reserved 1774.0MB
2025-05-29 12:42:11 - __main__ - INFO - [main_execution_logic:437] - Epoch 6: Backbone UNPROZEN. Updating LRs.
2025-05-29 12:42:11 - __main__ - INFO - [main_execution_logic:446] -   Updating head group optimizer LR to 1.00e-04
2025-05-29 12:42:11 - __main__ - INFO - [main_execution_logic:446] -   Updating backbone group optimizer LR to 1.00e-05
2025-05-29 12:42:11 - __main__ - INFO - [main_execution_logic:450] -     Updating Scheduler's base_lr for group 'backbone' to 1.00e-05
2025-05-29 12:42:11 - __main__ - INFO - [main_execution_logic:453] -   Effective LRs for scheduler after unfreezing update:
2025-05-29 12:42:11 - __main__ - INFO - [main_execution_logic:454] -     Opt Group 0 ('head'): LR 1.000e-04, Scheduler base 1.000e-04
2025-05-29 12:42:11 - __main__ - INFO - [main_execution_logic:454] -     Opt Group 1 ('backbone'): LR 1.000e-05, Scheduler base 1.000e-05
2025-05-29 12:44:42 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E6 OptStep 50: Grad Norm: 3.4508
2025-05-29 12:47:12 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E6 OptStep 100: Grad Norm: 5.1939
2025-05-29 12:49:43 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E6 OptStep 150: Grad Norm: 5.1568
2025-05-29 12:50:18 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 6 training finished. Avg Loss: 1.6323, Final LR: 4.00e-05, Opt Steps: 161, NaN count: 0
2025-05-29 12:51:20 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.5833, accuracy: 0.4245, f1_macro: 0.3628, f1_weighted: 0.3692, precision_macro: 0.4369, precision_weighted: 0.4326, recall_macro: 0.4122, recall_weighted: 0.4245, f1_Bacterial_Blight: 0.3026, f1_Curl_Virus: 0.1060, f1_Healthy_Leaf: 0.4497, f1_Herbicide_Growth_Damage: 0.5346, f1_Leaf_Hopper_Jassids: 0.0718, f1_Leaf_Redding: 0.5851, f1_Leaf_Variegation: 0.4895
2025-05-29 12:51:24 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 12:51:24 - __main__ - INFO - [main_execution_logic:479] - E6: New best! Val f1_macro: 0.3628
2025-05-29 12:51:24 - __main__ - INFO - [main_execution_logic:496] - Epoch 6 completed in 552.80s.
2025-05-29 12:51:24 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E6 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 12:53:55 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E7 OptStep 50: Grad Norm: 2.8626
2025-05-29 12:56:26 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E7 OptStep 100: Grad Norm: 4.6691
2025-05-29 12:58:56 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E7 OptStep 150: Grad Norm: 4.5146
2025-05-29 12:59:31 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 7 training finished. Avg Loss: 1.5424, Final LR: 4.67e-05, Opt Steps: 161, NaN count: 0
2025-05-29 13:00:33 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.4907, accuracy: 0.4588, f1_macro: 0.3886, f1_weighted: 0.3946, precision_macro: 0.4218, precision_weighted: 0.4240, recall_macro: 0.4499, recall_weighted: 0.4588, f1_Bacterial_Blight: 0.0755, f1_Curl_Virus: 0.1061, f1_Healthy_Leaf: 0.4511, f1_Herbicide_Growth_Damage: 0.6208, f1_Leaf_Hopper_Jassids: 0.2302, f1_Leaf_Redding: 0.6204, f1_Leaf_Variegation: 0.6163
2025-05-29 13:00:37 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 13:00:37 - __main__ - INFO - [main_execution_logic:479] - E7: New best! Val f1_macro: 0.3886
2025-05-29 13:00:37 - __main__ - INFO - [main_execution_logic:496] - Epoch 7 completed in 552.90s.
2025-05-29 13:00:37 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E7 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 13:03:08 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E8 OptStep 50: Grad Norm: 4.0781
2025-05-29 13:05:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E8 OptStep 100: Grad Norm: 6.4445
2025-05-29 13:08:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E8 OptStep 150: Grad Norm: 3.2179
2025-05-29 13:08:45 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 8 training finished. Avg Loss: 1.4817, Final LR: 5.33e-05, Opt Steps: 161, NaN count: 0
2025-05-29 13:09:47 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.4502, accuracy: 0.5004, f1_macro: 0.4652, f1_weighted: 0.4675, precision_macro: 0.4829, precision_weighted: 0.4829, recall_macro: 0.4962, recall_weighted: 0.5004, f1_Bacterial_Blight: 0.3077, f1_Curl_Virus: 0.2177, f1_Healthy_Leaf: 0.5000, f1_Herbicide_Growth_Damage: 0.6565, f1_Leaf_Hopper_Jassids: 0.2867, f1_Leaf_Redding: 0.6230, f1_Leaf_Variegation: 0.6647
2025-05-29 13:09:50 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 13:09:50 - __main__ - INFO - [main_execution_logic:479] - E8: New best! Val f1_macro: 0.4652
2025-05-29 13:09:50 - __main__ - INFO - [main_execution_logic:496] - Epoch 8 completed in 553.28s.
2025-05-29 13:09:50 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E8 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 13:12:21 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E9 OptStep 50: Grad Norm: 3.7256
2025-05-29 13:14:52 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E9 OptStep 100: Grad Norm: 4.9311
2025-05-29 13:17:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E9 OptStep 150: Grad Norm: 3.7982
2025-05-29 13:17:58 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 9 training finished. Avg Loss: 1.4435, Final LR: 6.00e-05, Opt Steps: 161, NaN count: 0
2025-05-29 13:19:00 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.4231, accuracy: 0.5084, f1_macro: 0.4473, f1_weighted: 0.4549, precision_macro: 0.5261, precision_weighted: 0.5296, recall_macro: 0.5008, recall_weighted: 0.5084, f1_Bacterial_Blight: 0.0729, f1_Curl_Virus: 0.3475, f1_Healthy_Leaf: 0.4871, f1_Herbicide_Growth_Damage: 0.7343, f1_Leaf_Hopper_Jassids: 0.1732, f1_Leaf_Redding: 0.6425, f1_Leaf_Variegation: 0.6738
2025-05-29 13:19:00 - __main__ - INFO - [main_execution_logic:482] - E9: Val f1_macro (0.4473) not better. Patience: 1/25
2025-05-29 13:19:00 - __main__ - INFO - [main_execution_logic:496] - Epoch 9 completed in 549.98s.
2025-05-29 13:19:00 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E9 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 13:21:31 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E10 OptStep 50: Grad Norm: 5.3538
2025-05-29 13:24:02 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E10 OptStep 100: Grad Norm: 5.2769
2025-05-29 13:26:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E10 OptStep 150: Grad Norm: 3.2215
2025-05-29 13:27:08 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 10 training finished. Avg Loss: 1.4213, Final LR: 6.67e-05, Opt Steps: 161, NaN count: 0
2025-05-29 13:28:10 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.4097, accuracy: 0.5150, f1_macro: 0.4427, f1_weighted: 0.4490, precision_macro: 0.5261, precision_weighted: 0.5264, recall_macro: 0.5064, recall_weighted: 0.5150, f1_Bacterial_Blight: 0.1268, f1_Curl_Virus: 0.2721, f1_Healthy_Leaf: 0.4993, f1_Herbicide_Growth_Damage: 0.7220, f1_Leaf_Hopper_Jassids: 0.1143, f1_Leaf_Redding: 0.6506, f1_Leaf_Variegation: 0.7135
2025-05-29 13:28:10 - __main__ - INFO - [main_execution_logic:482] - E10: Val f1_macro (0.4427) not better. Patience: 2/25
2025-05-29 13:28:12 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/checkpoint_epoch_10.pth
2025-05-29 13:28:12 - __main__ - INFO - [main_execution_logic:496] - Epoch 10 completed in 551.78s.
2025-05-29 13:28:12 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E10 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 13:30:43 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E11 OptStep 50: Grad Norm: 3.0696
2025-05-29 13:33:14 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E11 OptStep 100: Grad Norm: 3.8036
2025-05-29 13:35:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E11 OptStep 150: Grad Norm: 5.8745
2025-05-29 13:36:20 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 11 training finished. Avg Loss: 1.3912, Final LR: 7.33e-05, Opt Steps: 161, NaN count: 0
2025-05-29 13:37:22 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.3632, accuracy: 0.5281, f1_macro: 0.4644, f1_weighted: 0.4703, precision_macro: 0.5582, precision_weighted: 0.5604, recall_macro: 0.5225, recall_weighted: 0.5281, f1_Bacterial_Blight: 0.1569, f1_Curl_Virus: 0.2748, f1_Healthy_Leaf: 0.5136, f1_Herbicide_Growth_Damage: 0.7380, f1_Leaf_Hopper_Jassids: 0.1992, f1_Leaf_Redding: 0.6638, f1_Leaf_Variegation: 0.7044
2025-05-29 13:37:22 - __main__ - INFO - [main_execution_logic:482] - E11: Val f1_macro (0.4644) not better. Patience: 3/25
2025-05-29 13:37:22 - __main__ - INFO - [main_execution_logic:496] - Epoch 11 completed in 549.87s.
2025-05-29 13:37:22 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E11 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 13:39:53 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E12 OptStep 50: Grad Norm: 4.3740
2025-05-29 13:42:24 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E12 OptStep 100: Grad Norm: 3.5084
2025-05-29 13:44:54 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E12 OptStep 150: Grad Norm: 3.5673
2025-05-29 13:45:29 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 12 training finished. Avg Loss: 1.3640, Final LR: 8.00e-05, Opt Steps: 161, NaN count: 0
2025-05-29 13:46:31 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.3413, accuracy: 0.5587, f1_macro: 0.5092, f1_weighted: 0.5103, precision_macro: 0.5592, precision_weighted: 0.5605, recall_macro: 0.5593, recall_weighted: 0.5587, f1_Bacterial_Blight: 0.4955, f1_Curl_Virus: 0.2727, f1_Healthy_Leaf: 0.5490, f1_Herbicide_Growth_Damage: 0.7269, f1_Leaf_Hopper_Jassids: 0.1395, f1_Leaf_Redding: 0.6488, f1_Leaf_Variegation: 0.7323
2025-05-29 13:46:34 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 13:46:34 - __main__ - INFO - [main_execution_logic:479] - E12: New best! Val f1_macro: 0.5092
2025-05-29 13:46:34 - __main__ - INFO - [main_execution_logic:496] - Epoch 12 completed in 552.88s.
2025-05-29 13:46:34 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E12 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 13:49:06 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E13 OptStep 50: Grad Norm: 4.1284
2025-05-29 13:51:36 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E13 OptStep 100: Grad Norm: 4.4284
2025-05-29 13:54:07 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E13 OptStep 150: Grad Norm: 4.6806
2025-05-29 13:54:42 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 13 training finished. Avg Loss: 1.3341, Final LR: 8.67e-05, Opt Steps: 161, NaN count: 0
2025-05-29 13:55:44 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.2974, accuracy: 0.5864, f1_macro: 0.5557, f1_weighted: 0.5564, precision_macro: 0.5916, precision_weighted: 0.5981, recall_macro: 0.5913, recall_weighted: 0.5864, f1_Bacterial_Blight: 0.5269, f1_Curl_Virus: 0.3723, f1_Healthy_Leaf: 0.5969, f1_Herbicide_Growth_Damage: 0.7393, f1_Leaf_Hopper_Jassids: 0.2595, f1_Leaf_Redding: 0.6560, f1_Leaf_Variegation: 0.7392
2025-05-29 13:55:47 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 13:55:47 - __main__ - INFO - [main_execution_logic:479] - E13: New best! Val f1_macro: 0.5557
2025-05-29 13:55:47 - __main__ - INFO - [main_execution_logic:496] - Epoch 13 completed in 552.97s.
2025-05-29 13:55:47 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E13 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 13:58:19 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E14 OptStep 50: Grad Norm: 4.3136
2025-05-29 14:00:50 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E14 OptStep 100: Grad Norm: 4.1974
2025-05-29 14:03:20 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E14 OptStep 150: Grad Norm: 5.6294
2025-05-29 14:03:55 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 14 training finished. Avg Loss: 1.3064, Final LR: 9.33e-05, Opt Steps: 161, NaN count: 0
2025-05-29 14:04:57 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.2777, accuracy: 0.5959, f1_macro: 0.5781, f1_weighted: 0.5771, precision_macro: 0.6042, precision_weighted: 0.6076, recall_macro: 0.6019, recall_weighted: 0.5959, f1_Bacterial_Blight: 0.5333, f1_Curl_Virus: 0.3662, f1_Healthy_Leaf: 0.5812, f1_Herbicide_Growth_Damage: 0.7720, f1_Leaf_Hopper_Jassids: 0.3586, f1_Leaf_Redding: 0.6652, f1_Leaf_Variegation: 0.7701
2025-05-29 14:05:01 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 14:05:01 - __main__ - INFO - [main_execution_logic:479] - E14: New best! Val f1_macro: 0.5781
2025-05-29 14:05:01 - __main__ - INFO - [main_execution_logic:496] - Epoch 14 completed in 553.21s.
2025-05-29 14:05:01 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E14 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 14:07:32 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E15 OptStep 50: Grad Norm: 3.9173
2025-05-29 14:10:03 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E15 OptStep 100: Grad Norm: 5.3750
2025-05-29 14:12:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E15 OptStep 150: Grad Norm: 3.3027
2025-05-29 14:13:08 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 15 training finished. Avg Loss: 1.3014, Final LR: 1.00e-04, Opt Steps: 161, NaN count: 0
2025-05-29 14:14:10 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.2674, accuracy: 0.5974, f1_macro: 0.5804, f1_weighted: 0.5787, precision_macro: 0.6178, precision_weighted: 0.6208, recall_macro: 0.6044, recall_weighted: 0.5974, f1_Bacterial_Blight: 0.5276, f1_Curl_Virus: 0.3564, f1_Healthy_Leaf: 0.5829, f1_Herbicide_Growth_Damage: 0.7642, f1_Leaf_Hopper_Jassids: 0.3864, f1_Leaf_Redding: 0.6610, f1_Leaf_Variegation: 0.7847
2025-05-29 14:14:14 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 14:14:14 - __main__ - INFO - [main_execution_logic:479] - E15: New best! Val f1_macro: 0.5804
2025-05-29 14:14:14 - __main__ - INFO - [main_execution_logic:496] - Epoch 15 completed in 553.58s.
2025-05-29 14:14:14 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E15 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 14:16:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E16 OptStep 50: Grad Norm: 2.5446
2025-05-29 14:19:17 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E16 OptStep 100: Grad Norm: 3.8515
2025-05-29 14:21:48 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E16 OptStep 150: Grad Norm: 6.1229
2025-05-29 14:22:23 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 16 training finished. Avg Loss: 1.2806, Final LR: 1.00e-04, Opt Steps: 161, NaN count: 0
2025-05-29 14:23:25 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.2184, accuracy: 0.6404, f1_macro: 0.6279, f1_weighted: 0.6271, precision_macro: 0.6523, precision_weighted: 0.6544, recall_macro: 0.6437, recall_weighted: 0.6404, f1_Bacterial_Blight: 0.5561, f1_Curl_Virus: 0.4906, f1_Healthy_Leaf: 0.6455, f1_Herbicide_Growth_Damage: 0.8145, f1_Leaf_Hopper_Jassids: 0.4057, f1_Leaf_Redding: 0.6773, f1_Leaf_Variegation: 0.8058
2025-05-29 14:23:28 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 14:23:28 - __main__ - INFO - [main_execution_logic:479] - E16: New best! Val f1_macro: 0.6279
2025-05-29 14:23:28 - __main__ - INFO - [main_execution_logic:496] - Epoch 16 completed in 554.21s.
2025-05-29 14:23:28 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E16 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 14:26:00 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E17 OptStep 50: Grad Norm: 5.5725
2025-05-29 14:28:31 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E17 OptStep 100: Grad Norm: 5.1697
2025-05-29 14:31:02 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E17 OptStep 150: Grad Norm: 3.1763
2025-05-29 14:31:37 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 17 training finished. Avg Loss: 1.2565, Final LR: 9.99e-05, Opt Steps: 161, NaN count: 0
2025-05-29 14:32:39 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.2023, accuracy: 0.6448, f1_macro: 0.6263, f1_weighted: 0.6243, precision_macro: 0.6570, precision_weighted: 0.6589, recall_macro: 0.6497, recall_weighted: 0.6448, f1_Bacterial_Blight: 0.5626, f1_Curl_Virus: 0.3927, f1_Healthy_Leaf: 0.6803, f1_Herbicide_Growth_Damage: 0.7982, f1_Leaf_Hopper_Jassids: 0.4371, f1_Leaf_Redding: 0.6809, f1_Leaf_Variegation: 0.8319
2025-05-29 14:32:39 - __main__ - INFO - [main_execution_logic:482] - E17: Val f1_macro (0.6263) not better. Patience: 1/25
2025-05-29 14:32:39 - __main__ - INFO - [main_execution_logic:496] - Epoch 17 completed in 550.06s.
2025-05-29 14:32:39 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E17 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 14:35:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E18 OptStep 50: Grad Norm: 4.4494
2025-05-29 14:37:41 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E18 OptStep 100: Grad Norm: 5.0939
2025-05-29 14:40:12 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E18 OptStep 150: Grad Norm: 4.5287
2025-05-29 14:40:47 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 18 training finished. Avg Loss: 1.2453, Final LR: 9.99e-05, Opt Steps: 161, NaN count: 0
2025-05-29 14:41:49 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.2004, accuracy: 0.6448, f1_macro: 0.6353, f1_weighted: 0.6338, precision_macro: 0.6575, precision_weighted: 0.6595, recall_macro: 0.6489, recall_weighted: 0.6448, f1_Bacterial_Blight: 0.5547, f1_Curl_Virus: 0.4863, f1_Healthy_Leaf: 0.6510, f1_Herbicide_Growth_Damage: 0.8112, f1_Leaf_Hopper_Jassids: 0.4483, f1_Leaf_Redding: 0.6776, f1_Leaf_Variegation: 0.8179
2025-05-29 14:41:52 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 14:41:52 - __main__ - INFO - [main_execution_logic:479] - E18: New best! Val f1_macro: 0.6353
2025-05-29 14:41:52 - __main__ - INFO - [main_execution_logic:496] - Epoch 18 completed in 553.95s.
2025-05-29 14:41:52 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E18 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 14:44:24 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E19 OptStep 50: Grad Norm: 3.4653
2025-05-29 14:46:55 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E19 OptStep 100: Grad Norm: 3.7981
2025-05-29 14:49:26 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E19 OptStep 150: Grad Norm: 4.2579
2025-05-29 14:50:01 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 19 training finished. Avg Loss: 1.2286, Final LR: 9.98e-05, Opt Steps: 161, NaN count: 0
2025-05-29 14:51:03 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.1700, accuracy: 0.6601, f1_macro: 0.6516, f1_weighted: 0.6500, precision_macro: 0.6773, precision_weighted: 0.6823, recall_macro: 0.6679, recall_weighted: 0.6601, f1_Bacterial_Blight: 0.5647, f1_Curl_Virus: 0.5188, f1_Healthy_Leaf: 0.6904, f1_Herbicide_Growth_Damage: 0.8085, f1_Leaf_Hopper_Jassids: 0.4558, f1_Leaf_Redding: 0.6796, f1_Leaf_Variegation: 0.8433
2025-05-29 14:51:07 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 14:51:07 - __main__ - INFO - [main_execution_logic:479] - E19: New best! Val f1_macro: 0.6516
2025-05-29 14:51:07 - __main__ - INFO - [main_execution_logic:496] - Epoch 19 completed in 554.40s.
2025-05-29 14:51:07 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E19 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 14:53:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E20 OptStep 50: Grad Norm: 3.2412
2025-05-29 14:56:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E20 OptStep 100: Grad Norm: 4.1479
2025-05-29 14:58:41 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E20 OptStep 150: Grad Norm: 4.6487
2025-05-29 14:59:16 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 20 training finished. Avg Loss: 1.2333, Final LR: 9.97e-05, Opt Steps: 161, NaN count: 0
2025-05-29 15:00:18 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.1475, accuracy: 0.6667, f1_macro: 0.6528, f1_weighted: 0.6519, precision_macro: 0.6726, precision_weighted: 0.6751, recall_macro: 0.6717, recall_weighted: 0.6667, f1_Bacterial_Blight: 0.5882, f1_Curl_Virus: 0.4805, f1_Healthy_Leaf: 0.6996, f1_Herbicide_Growth_Damage: 0.8074, f1_Leaf_Hopper_Jassids: 0.4742, f1_Leaf_Redding: 0.7000, f1_Leaf_Variegation: 0.8199
2025-05-29 15:00:22 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 15:00:22 - __main__ - INFO - [main_execution_logic:479] - E20: New best! Val f1_macro: 0.6528
2025-05-29 15:00:24 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/checkpoint_epoch_20.pth
2025-05-29 15:00:24 - __main__ - INFO - [main_execution_logic:496] - Epoch 20 completed in 556.65s.
2025-05-29 15:00:24 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E20 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 15:02:55 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E21 OptStep 50: Grad Norm: 3.0022
2025-05-29 15:05:26 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E21 OptStep 100: Grad Norm: 4.6595
2025-05-29 15:07:57 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E21 OptStep 150: Grad Norm: 4.4888
2025-05-29 15:08:33 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 21 training finished. Avg Loss: 1.1984, Final LR: 9.95e-05, Opt Steps: 161, NaN count: 0
2025-05-29 15:09:35 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.1398, accuracy: 0.6776, f1_macro: 0.6700, f1_weighted: 0.6680, precision_macro: 0.6875, precision_weighted: 0.6910, recall_macro: 0.6844, recall_weighted: 0.6776, f1_Bacterial_Blight: 0.5990, f1_Curl_Virus: 0.5493, f1_Healthy_Leaf: 0.7078, f1_Herbicide_Growth_Damage: 0.8111, f1_Leaf_Hopper_Jassids: 0.5157, f1_Leaf_Redding: 0.6766, f1_Leaf_Variegation: 0.8305
2025-05-29 15:09:38 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 15:09:38 - __main__ - INFO - [main_execution_logic:479] - E21: New best! Val f1_macro: 0.6700
2025-05-29 15:09:38 - __main__ - INFO - [main_execution_logic:496] - Epoch 21 completed in 554.52s.
2025-05-29 15:09:38 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E21 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 15:12:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E22 OptStep 50: Grad Norm: 4.8670
2025-05-29 15:14:41 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E22 OptStep 100: Grad Norm: 5.2243
2025-05-29 15:17:12 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E22 OptStep 150: Grad Norm: 4.6022
2025-05-29 15:17:47 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 22 training finished. Avg Loss: 1.1924, Final LR: 9.93e-05, Opt Steps: 161, NaN count: 0
2025-05-29 15:18:49 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.1231, accuracy: 0.6740, f1_macro: 0.6621, f1_weighted: 0.6612, precision_macro: 0.6890, precision_weighted: 0.6934, recall_macro: 0.6815, recall_weighted: 0.6740, f1_Bacterial_Blight: 0.5859, f1_Curl_Virus: 0.5178, f1_Healthy_Leaf: 0.6914, f1_Herbicide_Growth_Damage: 0.8146, f1_Leaf_Hopper_Jassids: 0.4948, f1_Leaf_Redding: 0.7067, f1_Leaf_Variegation: 0.8235
2025-05-29 15:18:49 - __main__ - INFO - [main_execution_logic:482] - E22: Val f1_macro (0.6621) not better. Patience: 1/25
2025-05-29 15:18:49 - __main__ - INFO - [main_execution_logic:496] - Epoch 22 completed in 550.63s.
2025-05-29 15:18:49 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E22 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 15:21:20 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E23 OptStep 50: Grad Norm: 3.0741
2025-05-29 15:23:51 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E23 OptStep 100: Grad Norm: 4.1149
2025-05-29 15:26:22 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E23 OptStep 150: Grad Norm: 2.3563
2025-05-29 15:26:57 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 23 training finished. Avg Loss: 1.1754, Final LR: 9.91e-05, Opt Steps: 161, NaN count: 0
2025-05-29 15:27:59 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.1314, accuracy: 0.6783, f1_macro: 0.6718, f1_weighted: 0.6695, precision_macro: 0.6956, precision_weighted: 0.6980, recall_macro: 0.6843, recall_weighted: 0.6783, f1_Bacterial_Blight: 0.5877, f1_Curl_Virus: 0.4933, f1_Healthy_Leaf: 0.6892, f1_Herbicide_Growth_Damage: 0.8168, f1_Leaf_Hopper_Jassids: 0.5515, f1_Leaf_Redding: 0.7091, f1_Leaf_Variegation: 0.8547
2025-05-29 15:28:03 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 15:28:03 - __main__ - INFO - [main_execution_logic:479] - E23: New best! Val f1_macro: 0.6718
2025-05-29 15:28:03 - __main__ - INFO - [main_execution_logic:496] - Epoch 23 completed in 554.15s.
2025-05-29 15:28:03 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E23 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 15:30:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E24 OptStep 50: Grad Norm: 3.7022
2025-05-29 15:33:05 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E24 OptStep 100: Grad Norm: 2.4786
2025-05-29 15:35:36 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E24 OptStep 150: Grad Norm: 4.5021
2025-05-29 15:36:11 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 24 training finished. Avg Loss: 1.1612, Final LR: 9.89e-05, Opt Steps: 161, NaN count: 0
2025-05-29 15:37:14 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.1081, accuracy: 0.6988, f1_macro: 0.6920, f1_weighted: 0.6900, precision_macro: 0.7079, precision_weighted: 0.7122, recall_macro: 0.7056, recall_weighted: 0.6988, f1_Bacterial_Blight: 0.6138, f1_Curl_Virus: 0.5460, f1_Healthy_Leaf: 0.7189, f1_Herbicide_Growth_Damage: 0.8454, f1_Leaf_Hopper_Jassids: 0.5549, f1_Leaf_Redding: 0.7109, f1_Leaf_Variegation: 0.8539
2025-05-29 15:37:17 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 15:37:17 - __main__ - INFO - [main_execution_logic:479] - E24: New best! Val f1_macro: 0.6920
2025-05-29 15:37:17 - __main__ - INFO - [main_execution_logic:496] - Epoch 24 completed in 554.12s.
2025-05-29 15:37:17 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E24 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 15:39:48 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E25 OptStep 50: Grad Norm: 4.6416
2025-05-29 15:42:19 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E25 OptStep 100: Grad Norm: 3.8440
2025-05-29 15:44:50 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E25 OptStep 150: Grad Norm: 4.1767
2025-05-29 15:45:25 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 25 training finished. Avg Loss: 1.1581, Final LR: 9.87e-05, Opt Steps: 161, NaN count: 0
2025-05-29 15:46:27 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.0942, accuracy: 0.6980, f1_macro: 0.6901, f1_weighted: 0.6883, precision_macro: 0.7088, precision_weighted: 0.7107, recall_macro: 0.7024, recall_weighted: 0.6980, f1_Bacterial_Blight: 0.6138, f1_Curl_Virus: 0.5421, f1_Healthy_Leaf: 0.7099, f1_Herbicide_Growth_Damage: 0.8544, f1_Leaf_Hopper_Jassids: 0.5414, f1_Leaf_Redding: 0.7172, f1_Leaf_Variegation: 0.8522
2025-05-29 15:46:27 - __main__ - INFO - [main_execution_logic:482] - E25: Val f1_macro (0.6901) not better. Patience: 1/25
2025-05-29 15:46:27 - __main__ - INFO - [main_execution_logic:496] - Epoch 25 completed in 550.30s.
2025-05-29 15:46:27 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E25 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 15:48:58 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E26 OptStep 50: Grad Norm: 16.6045
2025-05-29 15:51:29 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E26 OptStep 100: Grad Norm: 3.9986
2025-05-29 15:54:01 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E26 OptStep 150: Grad Norm: 3.8520
2025-05-29 15:54:36 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 26 training finished. Avg Loss: 1.1442, Final LR: 9.84e-05, Opt Steps: 161, NaN count: 0
2025-05-29 15:55:38 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.0695, accuracy: 0.7024, f1_macro: 0.6978, f1_weighted: 0.6963, precision_macro: 0.7140, precision_weighted: 0.7155, recall_macro: 0.7075, recall_weighted: 0.7024, f1_Bacterial_Blight: 0.5973, f1_Curl_Virus: 0.5488, f1_Healthy_Leaf: 0.7317, f1_Herbicide_Growth_Damage: 0.8447, f1_Leaf_Hopper_Jassids: 0.5788, f1_Leaf_Redding: 0.7249, f1_Leaf_Variegation: 0.8588
2025-05-29 15:55:41 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 15:55:41 - __main__ - INFO - [main_execution_logic:479] - E26: New best! Val f1_macro: 0.6978
2025-05-29 15:55:41 - __main__ - INFO - [main_execution_logic:496] - Epoch 26 completed in 554.09s.
2025-05-29 15:55:41 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E26 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 15:58:13 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E27 OptStep 50: Grad Norm: 3.3213
2025-05-29 16:00:44 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E27 OptStep 100: Grad Norm: 4.2743
2025-05-29 16:03:15 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E27 OptStep 150: Grad Norm: 2.5264
2025-05-29 16:03:50 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 27 training finished. Avg Loss: 1.1484, Final LR: 9.81e-05, Opt Steps: 161, NaN count: 0
2025-05-29 16:04:52 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.0664, accuracy: 0.7112, f1_macro: 0.7025, f1_weighted: 0.7004, precision_macro: 0.7223, precision_weighted: 0.7224, recall_macro: 0.7144, recall_weighted: 0.7112, f1_Bacterial_Blight: 0.6146, f1_Curl_Virus: 0.5263, f1_Healthy_Leaf: 0.7291, f1_Herbicide_Growth_Damage: 0.8310, f1_Leaf_Hopper_Jassids: 0.6224, f1_Leaf_Redding: 0.7323, f1_Leaf_Variegation: 0.8622
2025-05-29 16:04:55 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 16:04:55 - __main__ - INFO - [main_execution_logic:479] - E27: New best! Val f1_macro: 0.7025
2025-05-29 16:04:55 - __main__ - INFO - [main_execution_logic:496] - Epoch 27 completed in 553.95s.
2025-05-29 16:04:55 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E27 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 16:07:27 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E28 OptStep 50: Grad Norm: 3.7135
2025-05-29 16:09:58 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E28 OptStep 100: Grad Norm: 5.3658
2025-05-29 16:12:29 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E28 OptStep 150: Grad Norm: 6.5530
2025-05-29 16:13:05 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 28 training finished. Avg Loss: 1.1426, Final LR: 9.77e-05, Opt Steps: 161, NaN count: 0
2025-05-29 16:14:07 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.0412, accuracy: 0.7163, f1_macro: 0.7140, f1_weighted: 0.7122, precision_macro: 0.7235, precision_weighted: 0.7252, recall_macro: 0.7210, recall_weighted: 0.7163, f1_Bacterial_Blight: 0.6216, f1_Curl_Virus: 0.5801, f1_Healthy_Leaf: 0.7346, f1_Herbicide_Growth_Damage: 0.8437, f1_Leaf_Hopper_Jassids: 0.6106, f1_Leaf_Redding: 0.7366, f1_Leaf_Variegation: 0.8709
2025-05-29 16:14:10 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 16:14:10 - __main__ - INFO - [main_execution_logic:479] - E28: New best! Val f1_macro: 0.7140
2025-05-29 16:14:10 - __main__ - INFO - [main_execution_logic:496] - Epoch 28 completed in 554.46s.
2025-05-29 16:14:10 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E28 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 16:16:41 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E29 OptStep 50: Grad Norm: 3.0449
2025-05-29 16:19:12 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E29 OptStep 100: Grad Norm: 5.5478
2025-05-29 16:21:43 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E29 OptStep 150: Grad Norm: 4.0953
2025-05-29 16:22:19 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 29 training finished. Avg Loss: 1.1312, Final LR: 9.74e-05, Opt Steps: 161, NaN count: 0
2025-05-29 16:23:20 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.0565, accuracy: 0.7148, f1_macro: 0.7085, f1_weighted: 0.7067, precision_macro: 0.7356, precision_weighted: 0.7381, recall_macro: 0.7214, recall_weighted: 0.7148, f1_Bacterial_Blight: 0.6313, f1_Curl_Virus: 0.5793, f1_Healthy_Leaf: 0.7418, f1_Herbicide_Growth_Damage: 0.8341, f1_Leaf_Hopper_Jassids: 0.6021, f1_Leaf_Redding: 0.7206, f1_Leaf_Variegation: 0.8500
2025-05-29 16:23:20 - __main__ - INFO - [main_execution_logic:482] - E29: Val f1_macro (0.7085) not better. Patience: 1/25
2025-05-29 16:23:20 - __main__ - INFO - [main_execution_logic:496] - Epoch 29 completed in 550.63s.
2025-05-29 16:23:20 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E29 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 16:25:52 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E30 OptStep 50: Grad Norm: 3.1347
2025-05-29 16:28:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E30 OptStep 100: Grad Norm: 3.7023
2025-05-29 16:30:54 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E30 OptStep 150: Grad Norm: 5.6899
2025-05-29 16:31:29 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 30 training finished. Avg Loss: 1.1157, Final LR: 9.70e-05, Opt Steps: 161, NaN count: 0
2025-05-29 16:32:31 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.0444, accuracy: 0.7228, f1_macro: 0.7176, f1_weighted: 0.7161, precision_macro: 0.7349, precision_weighted: 0.7376, recall_macro: 0.7280, recall_weighted: 0.7228, f1_Bacterial_Blight: 0.6247, f1_Curl_Virus: 0.5952, f1_Healthy_Leaf: 0.7302, f1_Herbicide_Growth_Damage: 0.8621, f1_Leaf_Hopper_Jassids: 0.6149, f1_Leaf_Redding: 0.7390, f1_Leaf_Variegation: 0.8571
2025-05-29 16:32:34 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 16:32:34 - __main__ - INFO - [main_execution_logic:479] - E30: New best! Val f1_macro: 0.7176
2025-05-29 16:32:36 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/checkpoint_epoch_30.pth
2025-05-29 16:32:36 - __main__ - INFO - [main_execution_logic:496] - Epoch 30 completed in 555.38s.
2025-05-29 16:32:36 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E30 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 16:35:07 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E31 OptStep 50: Grad Norm: 3.0664
2025-05-29 16:37:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E31 OptStep 100: Grad Norm: 4.7072
2025-05-29 16:40:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E31 OptStep 150: Grad Norm: 4.0901
2025-05-29 16:40:45 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 31 training finished. Avg Loss: 1.1058, Final LR: 9.66e-05, Opt Steps: 161, NaN count: 0
2025-05-29 16:41:47 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.0323, accuracy: 0.7272, f1_macro: 0.7211, f1_weighted: 0.7185, precision_macro: 0.7426, precision_weighted: 0.7415, recall_macro: 0.7313, recall_weighted: 0.7272, f1_Bacterial_Blight: 0.6456, f1_Curl_Virus: 0.5615, f1_Healthy_Leaf: 0.7443, f1_Herbicide_Growth_Damage: 0.8482, f1_Leaf_Hopper_Jassids: 0.6250, f1_Leaf_Redding: 0.7384, f1_Leaf_Variegation: 0.8850
2025-05-29 16:41:51 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 16:41:51 - __main__ - INFO - [main_execution_logic:479] - E31: New best! Val f1_macro: 0.7211
2025-05-29 16:41:51 - __main__ - INFO - [main_execution_logic:496] - Epoch 31 completed in 554.74s.
2025-05-29 16:41:51 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E31 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 16:44:22 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E32 OptStep 50: Grad Norm: 3.1556
2025-05-29 16:46:53 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E32 OptStep 100: Grad Norm: 3.9218
2025-05-29 16:49:24 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E32 OptStep 150: Grad Norm: 3.8990
2025-05-29 16:49:59 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 32 training finished. Avg Loss: 1.1023, Final LR: 9.61e-05, Opt Steps: 161, NaN count: 0
2025-05-29 16:51:01 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.0262, accuracy: 0.7192, f1_macro: 0.7152, f1_weighted: 0.7122, precision_macro: 0.7353, precision_weighted: 0.7379, recall_macro: 0.7266, recall_weighted: 0.7192, f1_Bacterial_Blight: 0.6207, f1_Curl_Virus: 0.5769, f1_Healthy_Leaf: 0.7302, f1_Herbicide_Growth_Damage: 0.8398, f1_Leaf_Hopper_Jassids: 0.6313, f1_Leaf_Redding: 0.7193, f1_Leaf_Variegation: 0.8883
2025-05-29 16:51:01 - __main__ - INFO - [main_execution_logic:482] - E32: Val f1_macro (0.7152) not better. Patience: 1/25
2025-05-29 16:51:01 - __main__ - INFO - [main_execution_logic:496] - Epoch 32 completed in 550.13s.
2025-05-29 16:51:01 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E32 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 16:53:32 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E33 OptStep 50: Grad Norm: 3.8740
2025-05-29 16:56:04 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E33 OptStep 100: Grad Norm: 3.7238
2025-05-29 16:58:35 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E33 OptStep 150: Grad Norm: 3.7673
2025-05-29 16:59:10 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 33 training finished. Avg Loss: 1.1021, Final LR: 9.57e-05, Opt Steps: 161, NaN count: 0
2025-05-29 17:00:12 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.0156, accuracy: 0.7352, f1_macro: 0.7290, f1_weighted: 0.7261, precision_macro: 0.7469, precision_weighted: 0.7493, recall_macro: 0.7426, recall_weighted: 0.7352, f1_Bacterial_Blight: 0.6600, f1_Curl_Virus: 0.5732, f1_Healthy_Leaf: 0.7598, f1_Herbicide_Growth_Damage: 0.8469, f1_Leaf_Hopper_Jassids: 0.6463, f1_Leaf_Redding: 0.7323, f1_Leaf_Variegation: 0.8845
2025-05-29 17:00:15 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 17:00:15 - __main__ - INFO - [main_execution_logic:479] - E33: New best! Val f1_macro: 0.7290
2025-05-29 17:00:15 - __main__ - INFO - [main_execution_logic:496] - Epoch 33 completed in 554.79s.
2025-05-29 17:00:15 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E33 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 17:02:47 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E34 OptStep 50: Grad Norm: 3.7894
2025-05-29 17:05:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E34 OptStep 100: Grad Norm: 5.3888
2025-05-29 17:07:50 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E34 OptStep 150: Grad Norm: 3.3899
2025-05-29 17:08:25 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 34 training finished. Avg Loss: 1.0861, Final LR: 9.52e-05, Opt Steps: 161, NaN count: 0
2025-05-29 17:09:27 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 1.0047, accuracy: 0.7345, f1_macro: 0.7317, f1_weighted: 0.7298, precision_macro: 0.7466, precision_weighted: 0.7507, recall_macro: 0.7414, recall_weighted: 0.7345, f1_Bacterial_Blight: 0.6455, f1_Curl_Virus: 0.6182, f1_Healthy_Leaf: 0.7490, f1_Herbicide_Growth_Damage: 0.8450, f1_Leaf_Hopper_Jassids: 0.6372, f1_Leaf_Redding: 0.7465, f1_Leaf_Variegation: 0.8807
2025-05-29 17:09:31 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 17:09:31 - __main__ - INFO - [main_execution_logic:479] - E34: New best! Val f1_macro: 0.7317
2025-05-29 17:09:31 - __main__ - INFO - [main_execution_logic:496] - Epoch 34 completed in 555.20s.
2025-05-29 17:09:31 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E34 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 17:12:02 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E35 OptStep 50: Grad Norm: 3.7686
2025-05-29 17:14:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E35 OptStep 100: Grad Norm: 4.8886
2025-05-29 17:17:05 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E35 OptStep 150: Grad Norm: 3.6706
2025-05-29 17:17:40 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 35 training finished. Avg Loss: 1.0738, Final LR: 9.47e-05, Opt Steps: 161, NaN count: 0
2025-05-29 17:18:42 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.9892, accuracy: 0.7367, f1_macro: 0.7329, f1_weighted: 0.7310, precision_macro: 0.7425, precision_weighted: 0.7435, recall_macro: 0.7411, recall_weighted: 0.7367, f1_Bacterial_Blight: 0.6260, f1_Curl_Virus: 0.6084, f1_Healthy_Leaf: 0.7443, f1_Herbicide_Growth_Damage: 0.8529, f1_Leaf_Hopper_Jassids: 0.6627, f1_Leaf_Redding: 0.7511, f1_Leaf_Variegation: 0.8851
2025-05-29 17:18:46 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 17:18:46 - __main__ - INFO - [main_execution_logic:479] - E35: New best! Val f1_macro: 0.7329
2025-05-29 17:18:46 - __main__ - INFO - [main_execution_logic:496] - Epoch 35 completed in 554.88s.
2025-05-29 17:18:46 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E35 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 17:21:17 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E36 OptStep 50: Grad Norm: 5.4406
2025-05-29 17:23:48 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E36 OptStep 100: Grad Norm: 4.2350
2025-05-29 17:26:19 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E36 OptStep 150: Grad Norm: 3.6767
2025-05-29 17:26:55 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 36 training finished. Avg Loss: 1.0694, Final LR: 9.41e-05, Opt Steps: 161, NaN count: 0
2025-05-29 17:27:57 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.9998, accuracy: 0.7309, f1_macro: 0.7238, f1_weighted: 0.7218, precision_macro: 0.7453, precision_weighted: 0.7476, recall_macro: 0.7364, recall_weighted: 0.7309, f1_Bacterial_Blight: 0.6390, f1_Curl_Virus: 0.5916, f1_Healthy_Leaf: 0.7480, f1_Herbicide_Growth_Damage: 0.8482, f1_Leaf_Hopper_Jassids: 0.6355, f1_Leaf_Redding: 0.7366, f1_Leaf_Variegation: 0.8674
2025-05-29 17:27:57 - __main__ - INFO - [main_execution_logic:482] - E36: Val f1_macro (0.7238) not better. Patience: 1/25
2025-05-29 17:27:57 - __main__ - INFO - [main_execution_logic:496] - Epoch 36 completed in 551.00s.
2025-05-29 17:27:57 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E36 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 17:30:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E37 OptStep 50: Grad Norm: 3.9243
2025-05-29 17:32:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E37 OptStep 100: Grad Norm: 3.4484
2025-05-29 17:35:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E37 OptStep 150: Grad Norm: 5.2088
2025-05-29 17:36:05 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 37 training finished. Avg Loss: 1.0851, Final LR: 9.36e-05, Opt Steps: 161, NaN count: 0
2025-05-29 17:37:07 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.9787, accuracy: 0.7498, f1_macro: 0.7467, f1_weighted: 0.7445, precision_macro: 0.7593, precision_weighted: 0.7622, recall_macro: 0.7560, recall_weighted: 0.7498, f1_Bacterial_Blight: 0.6612, f1_Curl_Virus: 0.6361, f1_Healthy_Leaf: 0.7571, f1_Herbicide_Growth_Damage: 0.8607, f1_Leaf_Hopper_Jassids: 0.6975, f1_Leaf_Redding: 0.7465, f1_Leaf_Variegation: 0.8676
2025-05-29 17:37:11 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 17:37:11 - __main__ - INFO - [main_execution_logic:479] - E37: New best! Val f1_macro: 0.7467
2025-05-29 17:37:11 - __main__ - INFO - [main_execution_logic:496] - Epoch 37 completed in 554.46s.
2025-05-29 17:37:11 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E37 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 17:39:43 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E38 OptStep 50: Grad Norm: 6.9615
2025-05-29 17:42:14 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E38 OptStep 100: Grad Norm: 3.5877
2025-05-29 17:44:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E38 OptStep 150: Grad Norm: 4.9117
2025-05-29 17:45:20 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 38 training finished. Avg Loss: 1.0581, Final LR: 9.30e-05, Opt Steps: 161, NaN count: 0
2025-05-29 17:46:22 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.9738, accuracy: 0.7440, f1_macro: 0.7381, f1_weighted: 0.7362, precision_macro: 0.7482, precision_weighted: 0.7510, recall_macro: 0.7500, recall_weighted: 0.7440, f1_Bacterial_Blight: 0.6466, f1_Curl_Virus: 0.6031, f1_Healthy_Leaf: 0.7718, f1_Herbicide_Growth_Damage: 0.8585, f1_Leaf_Hopper_Jassids: 0.6781, f1_Leaf_Redding: 0.7432, f1_Leaf_Variegation: 0.8658
2025-05-29 17:46:22 - __main__ - INFO - [main_execution_logic:482] - E38: Val f1_macro (0.7381) not better. Patience: 1/25
2025-05-29 17:46:22 - __main__ - INFO - [main_execution_logic:496] - Epoch 38 completed in 550.94s.
2025-05-29 17:46:22 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E38 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 17:48:53 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E39 OptStep 50: Grad Norm: 4.7147
2025-05-29 17:51:24 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E39 OptStep 100: Grad Norm: 4.0425
2025-05-29 17:53:55 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E39 OptStep 150: Grad Norm: 4.0667
2025-05-29 17:54:30 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 39 training finished. Avg Loss: 1.0421, Final LR: 9.24e-05, Opt Steps: 161, NaN count: 0
2025-05-29 17:55:32 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.9616, accuracy: 0.7505, f1_macro: 0.7471, f1_weighted: 0.7449, precision_macro: 0.7614, precision_weighted: 0.7633, recall_macro: 0.7557, recall_weighted: 0.7505, f1_Bacterial_Blight: 0.6316, f1_Curl_Virus: 0.6246, f1_Healthy_Leaf: 0.7653, f1_Herbicide_Growth_Damage: 0.8544, f1_Leaf_Hopper_Jassids: 0.6943, f1_Leaf_Redding: 0.7572, f1_Leaf_Variegation: 0.9021
2025-05-29 17:55:36 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 17:55:36 - __main__ - INFO - [main_execution_logic:479] - E39: New best! Val f1_macro: 0.7471
2025-05-29 17:55:36 - __main__ - INFO - [main_execution_logic:496] - Epoch 39 completed in 553.95s.
2025-05-29 17:55:36 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E39 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 17:58:07 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E40 OptStep 50: Grad Norm: 7.5537
2025-05-29 18:00:38 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E40 OptStep 100: Grad Norm: 3.9860
2025-05-29 18:03:09 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E40 OptStep 150: Grad Norm: 5.3972
2025-05-29 18:03:44 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 40 training finished. Avg Loss: 1.0614, Final LR: 9.18e-05, Opt Steps: 161, NaN count: 0
2025-05-29 18:04:46 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.9476, accuracy: 0.7564, f1_macro: 0.7539, f1_weighted: 0.7518, precision_macro: 0.7620, precision_weighted: 0.7653, recall_macro: 0.7628, recall_weighted: 0.7564, f1_Bacterial_Blight: 0.6446, f1_Curl_Virus: 0.6529, f1_Healthy_Leaf: 0.7766, f1_Herbicide_Growth_Damage: 0.8627, f1_Leaf_Hopper_Jassids: 0.7003, f1_Leaf_Redding: 0.7494, f1_Leaf_Variegation: 0.8908
2025-05-29 18:04:50 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 18:04:50 - __main__ - INFO - [main_execution_logic:479] - E40: New best! Val f1_macro: 0.7539
2025-05-29 18:04:51 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/checkpoint_epoch_40.pth
2025-05-29 18:04:51 - __main__ - INFO - [main_execution_logic:496] - Epoch 40 completed in 555.55s.
2025-05-29 18:04:51 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E40 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 18:07:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E41 OptStep 50: Grad Norm: 6.3094
2025-05-29 18:09:54 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E41 OptStep 100: Grad Norm: 4.2002
2025-05-29 18:12:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E41 OptStep 150: Grad Norm: 3.2593
2025-05-29 18:13:00 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 41 training finished. Avg Loss: 1.0511, Final LR: 9.11e-05, Opt Steps: 161, NaN count: 0
2025-05-29 18:14:02 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.9626, accuracy: 0.7571, f1_macro: 0.7542, f1_weighted: 0.7515, precision_macro: 0.7740, precision_weighted: 0.7749, recall_macro: 0.7622, recall_weighted: 0.7571, f1_Bacterial_Blight: 0.6684, f1_Curl_Virus: 0.6435, f1_Healthy_Leaf: 0.7644, f1_Herbicide_Growth_Damage: 0.8614, f1_Leaf_Hopper_Jassids: 0.6765, f1_Leaf_Redding: 0.7556, f1_Leaf_Variegation: 0.9096
2025-05-29 18:14:06 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 18:14:06 - __main__ - INFO - [main_execution_logic:479] - E41: New best! Val f1_macro: 0.7542
2025-05-29 18:14:06 - __main__ - INFO - [main_execution_logic:496] - Epoch 41 completed in 554.32s.
2025-05-29 18:14:06 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E41 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 18:16:37 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E42 OptStep 50: Grad Norm: 3.4737
2025-05-29 18:19:08 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E42 OptStep 100: Grad Norm: 5.3307
2025-05-29 18:21:40 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E42 OptStep 150: Grad Norm: 4.3732
2025-05-29 18:22:15 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 42 training finished. Avg Loss: 1.0394, Final LR: 9.05e-05, Opt Steps: 161, NaN count: 0
2025-05-29 18:23:17 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.9355, accuracy: 0.7753, f1_macro: 0.7758, f1_weighted: 0.7736, precision_macro: 0.7832, precision_weighted: 0.7852, recall_macro: 0.7813, recall_weighted: 0.7753, f1_Bacterial_Blight: 0.6935, f1_Curl_Virus: 0.6801, f1_Healthy_Leaf: 0.8000, f1_Herbicide_Growth_Damage: 0.8657, f1_Leaf_Hopper_Jassids: 0.7131, f1_Leaf_Redding: 0.7699, f1_Leaf_Variegation: 0.9085
2025-05-29 18:23:21 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 18:23:21 - __main__ - INFO - [main_execution_logic:479] - E42: New best! Val f1_macro: 0.7758
2025-05-29 18:23:21 - __main__ - INFO - [main_execution_logic:496] - Epoch 42 completed in 554.84s.
2025-05-29 18:23:21 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E42 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 18:25:52 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E43 OptStep 50: Grad Norm: 4.6809
2025-05-29 18:28:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E43 OptStep 100: Grad Norm: 5.3496
2025-05-29 18:30:55 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E43 OptStep 150: Grad Norm: 5.7027
2025-05-29 18:31:30 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 43 training finished. Avg Loss: 1.0328, Final LR: 8.98e-05, Opt Steps: 161, NaN count: 0
2025-05-29 18:32:32 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.9452, accuracy: 0.7695, f1_macro: 0.7677, f1_weighted: 0.7652, precision_macro: 0.7803, precision_weighted: 0.7839, recall_macro: 0.7767, recall_weighted: 0.7695, f1_Bacterial_Blight: 0.6907, f1_Curl_Virus: 0.6627, f1_Healthy_Leaf: 0.7835, f1_Herbicide_Growth_Damage: 0.8606, f1_Leaf_Hopper_Jassids: 0.7211, f1_Leaf_Redding: 0.7608, f1_Leaf_Variegation: 0.8947
2025-05-29 18:32:32 - __main__ - INFO - [main_execution_logic:482] - E43: Val f1_macro (0.7677) not better. Patience: 1/25
2025-05-29 18:32:32 - __main__ - INFO - [main_execution_logic:496] - Epoch 43 completed in 551.30s.
2025-05-29 18:32:32 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E43 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 18:35:03 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E44 OptStep 50: Grad Norm: 3.8076
2025-05-29 18:37:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E44 OptStep 100: Grad Norm: 4.1721
2025-05-29 18:40:05 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E44 OptStep 150: Grad Norm: 4.1320
2025-05-29 18:40:41 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 44 training finished. Avg Loss: 1.0278, Final LR: 8.90e-05, Opt Steps: 161, NaN count: 0
2025-05-29 18:41:43 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.9313, accuracy: 0.7651, f1_macro: 0.7651, f1_weighted: 0.7623, precision_macro: 0.7738, precision_weighted: 0.7755, recall_macro: 0.7714, recall_weighted: 0.7651, f1_Bacterial_Blight: 0.6838, f1_Curl_Virus: 0.6590, f1_Healthy_Leaf: 0.7826, f1_Herbicide_Growth_Damage: 0.8477, f1_Leaf_Hopper_Jassids: 0.7127, f1_Leaf_Redding: 0.7593, f1_Leaf_Variegation: 0.9107
2025-05-29 18:41:43 - __main__ - INFO - [main_execution_logic:482] - E44: Val f1_macro (0.7651) not better. Patience: 2/25
2025-05-29 18:41:43 - __main__ - INFO - [main_execution_logic:496] - Epoch 44 completed in 550.85s.
2025-05-29 18:41:43 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E44 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 18:44:14 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E45 OptStep 50: Grad Norm: 3.8960
2025-05-29 18:46:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E45 OptStep 100: Grad Norm: 5.4034
2025-05-29 18:49:16 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E45 OptStep 150: Grad Norm: 5.1269
2025-05-29 18:49:51 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 45 training finished. Avg Loss: 1.0258, Final LR: 8.83e-05, Opt Steps: 161, NaN count: 0
2025-05-29 18:50:53 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.9562, accuracy: 0.7622, f1_macro: 0.7618, f1_weighted: 0.7579, precision_macro: 0.7821, precision_weighted: 0.7835, recall_macro: 0.7701, recall_weighted: 0.7622, f1_Bacterial_Blight: 0.6895, f1_Curl_Virus: 0.6422, f1_Healthy_Leaf: 0.7564, f1_Herbicide_Growth_Damage: 0.8672, f1_Leaf_Hopper_Jassids: 0.7186, f1_Leaf_Redding: 0.7465, f1_Leaf_Variegation: 0.9123
2025-05-29 18:50:53 - __main__ - INFO - [main_execution_logic:482] - E45: Val f1_macro (0.7618) not better. Patience: 3/25
2025-05-29 18:50:53 - __main__ - INFO - [main_execution_logic:496] - Epoch 45 completed in 550.39s.
2025-05-29 18:50:53 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E45 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 18:53:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E46 OptStep 50: Grad Norm: 3.1738
2025-05-29 18:55:56 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E46 OptStep 100: Grad Norm: 3.6795
2025-05-29 18:58:27 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E46 OptStep 150: Grad Norm: 4.4529
2025-05-29 18:59:02 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 46 training finished. Avg Loss: 1.0351, Final LR: 8.75e-05, Opt Steps: 161, NaN count: 0
2025-05-29 19:00:04 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.9453, accuracy: 0.7673, f1_macro: 0.7668, f1_weighted: 0.7636, precision_macro: 0.7817, precision_weighted: 0.7838, recall_macro: 0.7744, recall_weighted: 0.7673, f1_Bacterial_Blight: 0.6990, f1_Curl_Virus: 0.6402, f1_Healthy_Leaf: 0.7596, f1_Herbicide_Growth_Damage: 0.8680, f1_Leaf_Hopper_Jassids: 0.7308, f1_Leaf_Redding: 0.7674, f1_Leaf_Variegation: 0.9027
2025-05-29 19:00:04 - __main__ - INFO - [main_execution_logic:482] - E46: Val f1_macro (0.7668) not better. Patience: 4/25
2025-05-29 19:00:04 - __main__ - INFO - [main_execution_logic:496] - Epoch 46 completed in 550.91s.
2025-05-29 19:00:04 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E46 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 19:02:35 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E47 OptStep 50: Grad Norm: 3.8136
2025-05-29 19:05:06 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E47 OptStep 100: Grad Norm: 3.8163
2025-05-29 19:07:37 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E47 OptStep 150: Grad Norm: 4.3548
2025-05-29 19:08:12 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 47 training finished. Avg Loss: 1.0101, Final LR: 8.68e-05, Opt Steps: 161, NaN count: 0
2025-05-29 19:09:15 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.9288, accuracy: 0.7812, f1_macro: 0.7816, f1_weighted: 0.7782, precision_macro: 0.7919, precision_weighted: 0.7936, recall_macro: 0.7883, recall_weighted: 0.7812, f1_Bacterial_Blight: 0.7087, f1_Curl_Virus: 0.6784, f1_Healthy_Leaf: 0.7835, f1_Herbicide_Growth_Damage: 0.8750, f1_Leaf_Hopper_Jassids: 0.7413, f1_Leaf_Redding: 0.7653, f1_Leaf_Variegation: 0.9189
2025-05-29 19:09:18 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 19:09:19 - __main__ - INFO - [main_execution_logic:479] - E47: New best! Val f1_macro: 0.7816
2025-05-29 19:09:19 - __main__ - INFO - [main_execution_logic:496] - Epoch 47 completed in 554.76s.
2025-05-29 19:09:19 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E47 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 19:11:50 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E48 OptStep 50: Grad Norm: 3.6483
2025-05-29 19:14:21 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E48 OptStep 100: Grad Norm: 3.9574
2025-05-29 19:16:53 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E48 OptStep 150: Grad Norm: 3.5124
2025-05-29 19:17:28 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 48 training finished. Avg Loss: 1.0019, Final LR: 8.60e-05, Opt Steps: 161, NaN count: 0
2025-05-29 19:18:30 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.9085, accuracy: 0.7775, f1_macro: 0.7781, f1_weighted: 0.7754, precision_macro: 0.7886, precision_weighted: 0.7906, recall_macro: 0.7842, recall_weighted: 0.7775, f1_Bacterial_Blight: 0.6880, f1_Curl_Virus: 0.6821, f1_Healthy_Leaf: 0.7916, f1_Herbicide_Growth_Damage: 0.8832, f1_Leaf_Hopper_Jassids: 0.7273, f1_Leaf_Redding: 0.7639, f1_Leaf_Variegation: 0.9107
2025-05-29 19:18:30 - __main__ - INFO - [main_execution_logic:482] - E48: Val f1_macro (0.7781) not better. Patience: 1/25
2025-05-29 19:18:30 - __main__ - INFO - [main_execution_logic:496] - Epoch 48 completed in 550.92s.
2025-05-29 19:18:30 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E48 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 19:21:01 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E49 OptStep 50: Grad Norm: 5.5984
2025-05-29 19:23:32 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E49 OptStep 100: Grad Norm: 3.8261
2025-05-29 19:26:03 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E49 OptStep 150: Grad Norm: 6.6261
2025-05-29 19:26:38 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 49 training finished. Avg Loss: 1.0090, Final LR: 8.51e-05, Opt Steps: 161, NaN count: 0
2025-05-29 19:27:40 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.9180, accuracy: 0.7768, f1_macro: 0.7778, f1_weighted: 0.7748, precision_macro: 0.7900, precision_weighted: 0.7890, recall_macro: 0.7813, recall_weighted: 0.7768, f1_Bacterial_Blight: 0.6902, f1_Curl_Virus: 0.6706, f1_Healthy_Leaf: 0.7810, f1_Herbicide_Growth_Damage: 0.8821, f1_Leaf_Hopper_Jassids: 0.7320, f1_Leaf_Redding: 0.7686, f1_Leaf_Variegation: 0.9202
2025-05-29 19:27:40 - __main__ - INFO - [main_execution_logic:482] - E49: Val f1_macro (0.7778) not better. Patience: 2/25
2025-05-29 19:27:40 - __main__ - INFO - [main_execution_logic:496] - Epoch 49 completed in 550.78s.
2025-05-29 19:27:40 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E49 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 19:30:12 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E50 OptStep 50: Grad Norm: 5.2042
2025-05-29 19:32:43 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E50 OptStep 100: Grad Norm: 4.0014
2025-05-29 19:35:14 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E50 OptStep 150: Grad Norm: 4.0984
2025-05-29 19:35:49 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 50 training finished. Avg Loss: 1.0002, Final LR: 8.43e-05, Opt Steps: 161, NaN count: 0
2025-05-29 19:36:51 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.9164, accuracy: 0.7659, f1_macro: 0.7618, f1_weighted: 0.7584, precision_macro: 0.7820, precision_weighted: 0.7813, recall_macro: 0.7709, recall_weighted: 0.7659, f1_Bacterial_Blight: 0.6738, f1_Curl_Virus: 0.5894, f1_Healthy_Leaf: 0.8009, f1_Herbicide_Growth_Damage: 0.8759, f1_Leaf_Hopper_Jassids: 0.7095, f1_Leaf_Redding: 0.7569, f1_Leaf_Variegation: 0.9264
2025-05-29 19:36:51 - __main__ - INFO - [main_execution_logic:482] - E50: Val f1_macro (0.7618) not better. Patience: 3/25
2025-05-29 19:36:53 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/checkpoint_epoch_50.pth
2025-05-29 19:36:53 - __main__ - INFO - [main_execution_logic:496] - Epoch 50 completed in 552.26s.
2025-05-29 19:36:53 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E50 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 19:39:24 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E51 OptStep 50: Grad Norm: 5.8258
2025-05-29 19:41:56 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E51 OptStep 100: Grad Norm: 3.7324
2025-05-29 19:44:27 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E51 OptStep 150: Grad Norm: 14.3788
2025-05-29 19:45:02 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 51 training finished. Avg Loss: 1.0006, Final LR: 8.35e-05, Opt Steps: 161, NaN count: 0
2025-05-29 19:46:04 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.9071, accuracy: 0.7841, f1_macro: 0.7845, f1_weighted: 0.7813, precision_macro: 0.7916, precision_weighted: 0.7950, recall_macro: 0.7927, recall_weighted: 0.7841, f1_Bacterial_Blight: 0.7016, f1_Curl_Virus: 0.6989, f1_Healthy_Leaf: 0.7923, f1_Herbicide_Growth_Damage: 0.8866, f1_Leaf_Hopper_Jassids: 0.7382, f1_Leaf_Redding: 0.7578, f1_Leaf_Variegation: 0.9159
2025-05-29 19:46:08 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 19:46:08 - __main__ - INFO - [main_execution_logic:479] - E51: New best! Val f1_macro: 0.7845
2025-05-29 19:46:08 - __main__ - INFO - [main_execution_logic:496] - Epoch 51 completed in 554.79s.
2025-05-29 19:46:08 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E51 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 19:48:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E52 OptStep 50: Grad Norm: 4.1077
2025-05-29 19:51:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E52 OptStep 100: Grad Norm: 4.5112
2025-05-29 19:53:41 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E52 OptStep 150: Grad Norm: 3.9332
2025-05-29 19:54:16 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 52 training finished. Avg Loss: 0.9937, Final LR: 8.26e-05, Opt Steps: 161, NaN count: 0
2025-05-29 19:55:18 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.9184, accuracy: 0.7717, f1_macro: 0.7702, f1_weighted: 0.7664, precision_macro: 0.7857, precision_weighted: 0.7860, recall_macro: 0.7782, recall_weighted: 0.7717, f1_Bacterial_Blight: 0.6984, f1_Curl_Virus: 0.6335, f1_Healthy_Leaf: 0.7711, f1_Herbicide_Growth_Damage: 0.8747, f1_Leaf_Hopper_Jassids: 0.7383, f1_Leaf_Redding: 0.7591, f1_Leaf_Variegation: 0.9162
2025-05-29 19:55:18 - __main__ - INFO - [main_execution_logic:482] - E52: Val f1_macro (0.7702) not better. Patience: 1/25
2025-05-29 19:55:18 - __main__ - INFO - [main_execution_logic:496] - Epoch 52 completed in 550.70s.
2025-05-29 19:55:18 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E52 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 19:57:50 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E53 OptStep 50: Grad Norm: 3.6844
2025-05-29 20:00:21 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E53 OptStep 100: Grad Norm: 3.6353
2025-05-29 20:02:52 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E53 OptStep 150: Grad Norm: 3.8968
2025-05-29 20:03:27 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 53 training finished. Avg Loss: 0.9813, Final LR: 8.17e-05, Opt Steps: 161, NaN count: 0
2025-05-29 20:04:29 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8934, accuracy: 0.7848, f1_macro: 0.7845, f1_weighted: 0.7814, precision_macro: 0.7937, precision_weighted: 0.7949, recall_macro: 0.7912, recall_weighted: 0.7848, f1_Bacterial_Blight: 0.7068, f1_Curl_Virus: 0.6903, f1_Healthy_Leaf: 0.7932, f1_Herbicide_Growth_Damage: 0.8592, f1_Leaf_Hopper_Jassids: 0.7467, f1_Leaf_Redding: 0.7706, f1_Leaf_Variegation: 0.9245
2025-05-29 20:04:29 - __main__ - INFO - [main_execution_logic:482] - E53: Val f1_macro (0.7845) not better. Patience: 2/25
2025-05-29 20:04:29 - __main__ - INFO - [main_execution_logic:496] - Epoch 53 completed in 550.50s.
2025-05-29 20:04:29 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E53 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 20:07:00 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E54 OptStep 50: Grad Norm: 4.1848
2025-05-29 20:09:32 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E54 OptStep 100: Grad Norm: 4.3635
2025-05-29 20:12:03 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E54 OptStep 150: Grad Norm: 4.1628
2025-05-29 20:12:38 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 54 training finished. Avg Loss: 0.9864, Final LR: 8.08e-05, Opt Steps: 161, NaN count: 0
2025-05-29 20:13:40 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8895, accuracy: 0.7958, f1_macro: 0.7952, f1_weighted: 0.7929, precision_macro: 0.8008, precision_weighted: 0.8026, recall_macro: 0.8013, recall_weighted: 0.7958, f1_Bacterial_Blight: 0.7202, f1_Curl_Virus: 0.7216, f1_Healthy_Leaf: 0.7966, f1_Herbicide_Growth_Damage: 0.8696, f1_Leaf_Hopper_Jassids: 0.7642, f1_Leaf_Redding: 0.7882, f1_Leaf_Variegation: 0.9059
2025-05-29 20:13:43 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 20:13:43 - __main__ - INFO - [main_execution_logic:479] - E54: New best! Val f1_macro: 0.7952
2025-05-29 20:13:43 - __main__ - INFO - [main_execution_logic:496] - Epoch 54 completed in 554.60s.
2025-05-29 20:13:43 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E54 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 20:16:15 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E55 OptStep 50: Grad Norm: 3.9181
2025-05-29 20:18:47 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E55 OptStep 100: Grad Norm: 3.6691
2025-05-29 20:21:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E55 OptStep 150: Grad Norm: 5.4322
2025-05-29 20:21:53 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 55 training finished. Avg Loss: 1.0079, Final LR: 7.99e-05, Opt Steps: 161, NaN count: 0
2025-05-29 20:22:55 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8839, accuracy: 0.7856, f1_macro: 0.7847, f1_weighted: 0.7817, precision_macro: 0.7928, precision_weighted: 0.7930, recall_macro: 0.7911, recall_weighted: 0.7856, f1_Bacterial_Blight: 0.7078, f1_Curl_Virus: 0.6903, f1_Healthy_Leaf: 0.7975, f1_Herbicide_Growth_Damage: 0.8747, f1_Leaf_Hopper_Jassids: 0.7451, f1_Leaf_Redding: 0.7655, f1_Leaf_Variegation: 0.9118
2025-05-29 20:22:55 - __main__ - INFO - [main_execution_logic:482] - E55: Val f1_macro (0.7847) not better. Patience: 1/25
2025-05-29 20:22:55 - __main__ - INFO - [main_execution_logic:496] - Epoch 55 completed in 551.50s.
2025-05-29 20:22:55 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E55 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 20:25:26 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E56 OptStep 50: Grad Norm: 3.8220
2025-05-29 20:27:57 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E56 OptStep 100: Grad Norm: 4.0088
2025-05-29 20:30:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E56 OptStep 150: Grad Norm: 4.4796
2025-05-29 20:31:03 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 56 training finished. Avg Loss: 0.9770, Final LR: 7.89e-05, Opt Steps: 161, NaN count: 0
2025-05-29 20:32:05 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8894, accuracy: 0.7907, f1_macro: 0.7900, f1_weighted: 0.7874, precision_macro: 0.7962, precision_weighted: 0.7980, recall_macro: 0.7970, recall_weighted: 0.7907, f1_Bacterial_Blight: 0.7056, f1_Curl_Virus: 0.7126, f1_Healthy_Leaf: 0.8060, f1_Herbicide_Growth_Damage: 0.8790, f1_Leaf_Hopper_Jassids: 0.7486, f1_Leaf_Redding: 0.7682, f1_Leaf_Variegation: 0.9101
2025-05-29 20:32:05 - __main__ - INFO - [main_execution_logic:482] - E56: Val f1_macro (0.7900) not better. Patience: 2/25
2025-05-29 20:32:05 - __main__ - INFO - [main_execution_logic:496] - Epoch 56 completed in 550.28s.
2025-05-29 20:32:05 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E56 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 20:34:37 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E57 OptStep 50: Grad Norm: 5.3049
2025-05-29 20:37:08 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E57 OptStep 100: Grad Norm: 4.5183
2025-05-29 20:39:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E57 OptStep 150: Grad Norm: 6.2431
2025-05-29 20:40:14 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 57 training finished. Avg Loss: 0.9782, Final LR: 7.80e-05, Opt Steps: 161, NaN count: 0
2025-05-29 20:41:16 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8866, accuracy: 0.7834, f1_macro: 0.7829, f1_weighted: 0.7805, precision_macro: 0.7914, precision_weighted: 0.7936, recall_macro: 0.7893, recall_weighted: 0.7834, f1_Bacterial_Blight: 0.6898, f1_Curl_Virus: 0.6877, f1_Healthy_Leaf: 0.7984, f1_Herbicide_Growth_Damage: 0.8844, f1_Leaf_Hopper_Jassids: 0.7507, f1_Leaf_Redding: 0.7681, f1_Leaf_Variegation: 0.9015
2025-05-29 20:41:16 - __main__ - INFO - [main_execution_logic:482] - E57: Val f1_macro (0.7829) not better. Patience: 3/25
2025-05-29 20:41:16 - __main__ - INFO - [main_execution_logic:496] - Epoch 57 completed in 550.81s.
2025-05-29 20:41:16 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E57 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 20:43:47 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E58 OptStep 50: Grad Norm: 3.6015
2025-05-29 20:46:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E58 OptStep 100: Grad Norm: 4.9663
2025-05-29 20:48:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E58 OptStep 150: Grad Norm: 2.8268
2025-05-29 20:49:24 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 58 training finished. Avg Loss: 0.9736, Final LR: 7.70e-05, Opt Steps: 161, NaN count: 0
2025-05-29 20:50:26 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8833, accuracy: 0.7819, f1_macro: 0.7804, f1_weighted: 0.7777, precision_macro: 0.7937, precision_weighted: 0.7945, recall_macro: 0.7870, recall_weighted: 0.7819, f1_Bacterial_Blight: 0.6893, f1_Curl_Virus: 0.6748, f1_Healthy_Leaf: 0.7870, f1_Herbicide_Growth_Damage: 0.8834, f1_Leaf_Hopper_Jassids: 0.7344, f1_Leaf_Redding: 0.7748, f1_Leaf_Variegation: 0.9194
2025-05-29 20:50:26 - __main__ - INFO - [main_execution_logic:482] - E58: Val f1_macro (0.7804) not better. Patience: 4/25
2025-05-29 20:50:26 - __main__ - INFO - [main_execution_logic:496] - Epoch 58 completed in 550.04s.
2025-05-29 20:50:26 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E58 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 20:52:57 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E59 OptStep 50: Grad Norm: 5.8667
2025-05-29 20:55:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E59 OptStep 100: Grad Norm: 3.4992
2025-05-29 20:57:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E59 OptStep 150: Grad Norm: 5.5328
2025-05-29 20:58:34 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 59 training finished. Avg Loss: 0.9739, Final LR: 7.60e-05, Opt Steps: 161, NaN count: 0
2025-05-29 20:59:36 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8887, accuracy: 0.7885, f1_macro: 0.7871, f1_weighted: 0.7846, precision_macro: 0.7941, precision_weighted: 0.7933, recall_macro: 0.7920, recall_weighted: 0.7885, f1_Bacterial_Blight: 0.7062, f1_Curl_Virus: 0.6879, f1_Healthy_Leaf: 0.8000, f1_Herbicide_Growth_Damage: 0.8844, f1_Leaf_Hopper_Jassids: 0.7318, f1_Leaf_Redding: 0.7819, f1_Leaf_Variegation: 0.9172
2025-05-29 20:59:36 - __main__ - INFO - [main_execution_logic:482] - E59: Val f1_macro (0.7871) not better. Patience: 5/25
2025-05-29 20:59:36 - __main__ - INFO - [main_execution_logic:496] - Epoch 59 completed in 550.22s.
2025-05-29 20:59:36 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E59 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 21:02:08 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E60 OptStep 50: Grad Norm: 3.0081
2025-05-29 21:04:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E60 OptStep 100: Grad Norm: 3.8461
2025-05-29 21:07:09 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E60 OptStep 150: Grad Norm: 4.0685
2025-05-29 21:07:45 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 60 training finished. Avg Loss: 0.9723, Final LR: 7.50e-05, Opt Steps: 161, NaN count: 0
2025-05-29 21:08:46 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8892, accuracy: 0.7921, f1_macro: 0.7931, f1_weighted: 0.7900, precision_macro: 0.8018, precision_weighted: 0.8040, recall_macro: 0.7990, recall_weighted: 0.7921, f1_Bacterial_Blight: 0.7234, f1_Curl_Virus: 0.7171, f1_Healthy_Leaf: 0.7967, f1_Herbicide_Growth_Damage: 0.8810, f1_Leaf_Hopper_Jassids: 0.7487, f1_Leaf_Redding: 0.7685, f1_Leaf_Variegation: 0.9162
2025-05-29 21:08:46 - __main__ - INFO - [main_execution_logic:482] - E60: Val f1_macro (0.7931) not better. Patience: 6/25
2025-05-29 21:08:48 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/checkpoint_epoch_60.pth
2025-05-29 21:08:48 - __main__ - INFO - [main_execution_logic:496] - Epoch 60 completed in 551.96s.
2025-05-29 21:08:48 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E60 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 21:11:19 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E61 OptStep 50: Grad Norm: 4.2625
2025-05-29 21:13:51 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E61 OptStep 100: Grad Norm: 4.0624
2025-05-29 21:16:22 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E61 OptStep 150: Grad Norm: 5.4361
2025-05-29 21:16:57 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 61 training finished. Avg Loss: 0.9659, Final LR: 7.40e-05, Opt Steps: 161, NaN count: 0
2025-05-29 21:17:58 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8910, accuracy: 0.7950, f1_macro: 0.7957, f1_weighted: 0.7925, precision_macro: 0.8054, precision_weighted: 0.8058, recall_macro: 0.8009, recall_weighted: 0.7950, f1_Bacterial_Blight: 0.7183, f1_Curl_Virus: 0.6954, f1_Healthy_Leaf: 0.7984, f1_Herbicide_Growth_Damage: 0.8900, f1_Leaf_Hopper_Jassids: 0.7684, f1_Leaf_Redding: 0.7780, f1_Leaf_Variegation: 0.9212
2025-05-29 21:18:02 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 21:18:02 - __main__ - INFO - [main_execution_logic:479] - E61: New best! Val f1_macro: 0.7957
2025-05-29 21:18:02 - __main__ - INFO - [main_execution_logic:496] - Epoch 61 completed in 553.90s.
2025-05-29 21:18:02 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E61 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 21:20:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E62 OptStep 50: Grad Norm: 4.6928
2025-05-29 21:23:05 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E62 OptStep 100: Grad Norm: 3.9167
2025-05-29 21:25:36 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E62 OptStep 150: Grad Norm: 4.4710
2025-05-29 21:26:11 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 62 training finished. Avg Loss: 0.9643, Final LR: 7.30e-05, Opt Steps: 161, NaN count: 0
2025-05-29 21:27:13 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8789, accuracy: 0.7921, f1_macro: 0.7918, f1_weighted: 0.7893, precision_macro: 0.7967, precision_weighted: 0.7974, recall_macro: 0.7973, recall_weighted: 0.7921, f1_Bacterial_Blight: 0.6900, f1_Curl_Virus: 0.7143, f1_Healthy_Leaf: 0.8017, f1_Herbicide_Growth_Damage: 0.8911, f1_Leaf_Hopper_Jassids: 0.7535, f1_Leaf_Redding: 0.7743, f1_Leaf_Variegation: 0.9176
2025-05-29 21:27:13 - __main__ - INFO - [main_execution_logic:482] - E62: Val f1_macro (0.7918) not better. Patience: 1/25
2025-05-29 21:27:13 - __main__ - INFO - [main_execution_logic:496] - Epoch 62 completed in 550.83s.
2025-05-29 21:27:13 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E62 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 21:29:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E63 OptStep 50: Grad Norm: 6.3094
2025-05-29 21:32:16 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E63 OptStep 100: Grad Norm: 6.3065
2025-05-29 21:34:47 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E63 OptStep 150: Grad Norm: 4.0361
2025-05-29 21:35:22 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 63 training finished. Avg Loss: 0.9724, Final LR: 7.19e-05, Opt Steps: 161, NaN count: 0
2025-05-29 21:36:24 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8725, accuracy: 0.7972, f1_macro: 0.7975, f1_weighted: 0.7944, precision_macro: 0.8060, precision_weighted: 0.8077, recall_macro: 0.8039, recall_weighted: 0.7972, f1_Bacterial_Blight: 0.7124, f1_Curl_Virus: 0.7205, f1_Healthy_Leaf: 0.8133, f1_Herbicide_Growth_Damage: 0.8939, f1_Leaf_Hopper_Jassids: 0.7534, f1_Leaf_Redding: 0.7657, f1_Leaf_Variegation: 0.9231
2025-05-29 21:36:28 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 21:36:28 - __main__ - INFO - [main_execution_logic:479] - E63: New best! Val f1_macro: 0.7975
2025-05-29 21:36:28 - __main__ - INFO - [main_execution_logic:496] - Epoch 63 completed in 554.63s.
2025-05-29 21:36:28 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E63 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 21:38:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E64 OptStep 50: Grad Norm: 6.6011
2025-05-29 21:41:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E64 OptStep 100: Grad Norm: 4.8705
2025-05-29 21:44:02 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E64 OptStep 150: Grad Norm: 3.9161
2025-05-29 21:44:37 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 64 training finished. Avg Loss: 0.9526, Final LR: 7.09e-05, Opt Steps: 161, NaN count: 0
2025-05-29 21:45:39 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8646, accuracy: 0.8023, f1_macro: 0.8025, f1_weighted: 0.8003, precision_macro: 0.8070, precision_weighted: 0.8087, recall_macro: 0.8077, recall_weighted: 0.8023, f1_Bacterial_Blight: 0.7078, f1_Curl_Virus: 0.7368, f1_Healthy_Leaf: 0.8172, f1_Herbicide_Growth_Damage: 0.8775, f1_Leaf_Hopper_Jassids: 0.7713, f1_Leaf_Redding: 0.7872, f1_Leaf_Variegation: 0.9194
2025-05-29 21:45:42 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 21:45:42 - __main__ - INFO - [main_execution_logic:479] - E64: New best! Val f1_macro: 0.8025
2025-05-29 21:45:42 - __main__ - INFO - [main_execution_logic:496] - Epoch 64 completed in 554.91s.
2025-05-29 21:45:42 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E64 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 21:48:14 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E65 OptStep 50: Grad Norm: 5.1000
2025-05-29 21:50:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E65 OptStep 100: Grad Norm: 6.5328
2025-05-29 21:53:16 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E65 OptStep 150: Grad Norm: 3.1476
2025-05-29 21:53:52 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 65 training finished. Avg Loss: 0.9611, Final LR: 6.98e-05, Opt Steps: 161, NaN count: 0
2025-05-29 21:54:53 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8642, accuracy: 0.8023, f1_macro: 0.8033, f1_weighted: 0.8007, precision_macro: 0.8101, precision_weighted: 0.8121, recall_macro: 0.8087, recall_weighted: 0.8023, f1_Bacterial_Blight: 0.7120, f1_Curl_Virus: 0.7430, f1_Healthy_Leaf: 0.8118, f1_Herbicide_Growth_Damage: 0.8894, f1_Leaf_Hopper_Jassids: 0.7629, f1_Leaf_Redding: 0.7786, f1_Leaf_Variegation: 0.9254
2025-05-29 21:54:57 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 21:54:57 - __main__ - INFO - [main_execution_logic:479] - E65: New best! Val f1_macro: 0.8033
2025-05-29 21:54:57 - __main__ - INFO - [main_execution_logic:496] - Epoch 65 completed in 554.55s.
2025-05-29 21:54:57 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E65 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 21:57:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E66 OptStep 50: Grad Norm: 3.8367
2025-05-29 21:59:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E66 OptStep 100: Grad Norm: 6.0306
2025-05-29 22:02:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E66 OptStep 150: Grad Norm: 3.9082
2025-05-29 22:03:05 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 66 training finished. Avg Loss: 0.9631, Final LR: 6.87e-05, Opt Steps: 161, NaN count: 0
2025-05-29 22:04:07 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8720, accuracy: 0.8009, f1_macro: 0.8006, f1_weighted: 0.7980, precision_macro: 0.8056, precision_weighted: 0.8075, recall_macro: 0.8075, recall_weighted: 0.8009, f1_Bacterial_Blight: 0.7192, f1_Curl_Virus: 0.7335, f1_Healthy_Leaf: 0.8090, f1_Herbicide_Growth_Damage: 0.8825, f1_Leaf_Hopper_Jassids: 0.7611, f1_Leaf_Redding: 0.7803, f1_Leaf_Variegation: 0.9186
2025-05-29 22:04:07 - __main__ - INFO - [main_execution_logic:482] - E66: Val f1_macro (0.8006) not better. Patience: 1/25
2025-05-29 22:04:07 - __main__ - INFO - [main_execution_logic:496] - Epoch 66 completed in 550.03s.
2025-05-29 22:04:07 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E66 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 22:06:38 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E67 OptStep 50: Grad Norm: 5.5820
2025-05-29 22:09:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E67 OptStep 100: Grad Norm: 5.0417
2025-05-29 22:11:41 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E67 OptStep 150: Grad Norm: 3.5784
2025-05-29 22:12:16 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 67 training finished. Avg Loss: 0.9446, Final LR: 6.76e-05, Opt Steps: 161, NaN count: 0
2025-05-29 22:13:18 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8661, accuracy: 0.8016, f1_macro: 0.8020, f1_weighted: 0.7993, precision_macro: 0.8109, precision_weighted: 0.8140, recall_macro: 0.8088, recall_weighted: 0.8016, f1_Bacterial_Blight: 0.7000, f1_Curl_Virus: 0.7324, f1_Healthy_Leaf: 0.8075, f1_Herbicide_Growth_Damage: 0.8922, f1_Leaf_Hopper_Jassids: 0.7802, f1_Leaf_Redding: 0.7780, f1_Leaf_Variegation: 0.9240
2025-05-29 22:13:18 - __main__ - INFO - [main_execution_logic:482] - E67: Val f1_macro (0.8020) not better. Patience: 2/25
2025-05-29 22:13:18 - __main__ - INFO - [main_execution_logic:496] - Epoch 67 completed in 550.93s.
2025-05-29 22:13:18 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E67 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 22:15:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E68 OptStep 50: Grad Norm: 3.5831
2025-05-29 22:18:20 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E68 OptStep 100: Grad Norm: 4.0724
2025-05-29 22:20:51 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E68 OptStep 150: Grad Norm: 3.9440
2025-05-29 22:21:27 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 68 training finished. Avg Loss: 0.9482, Final LR: 6.66e-05, Opt Steps: 161, NaN count: 0
2025-05-29 22:22:29 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8601, accuracy: 0.8016, f1_macro: 0.8022, f1_weighted: 0.7988, precision_macro: 0.8088, precision_weighted: 0.8095, recall_macro: 0.8085, recall_weighted: 0.8016, f1_Bacterial_Blight: 0.7139, f1_Curl_Virus: 0.6997, f1_Healthy_Leaf: 0.8293, f1_Herbicide_Growth_Damage: 0.8983, f1_Leaf_Hopper_Jassids: 0.7784, f1_Leaf_Redding: 0.7679, f1_Leaf_Variegation: 0.9277
2025-05-29 22:22:29 - __main__ - INFO - [main_execution_logic:482] - E68: Val f1_macro (0.8022) not better. Patience: 3/25
2025-05-29 22:22:29 - __main__ - INFO - [main_execution_logic:496] - Epoch 68 completed in 550.58s.
2025-05-29 22:22:29 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E68 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 22:25:00 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E69 OptStep 50: Grad Norm: 3.9294
2025-05-29 22:27:31 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E69 OptStep 100: Grad Norm: 2.6025
2025-05-29 22:30:02 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E69 OptStep 150: Grad Norm: 3.3382
2025-05-29 22:30:37 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 69 training finished. Avg Loss: 0.9534, Final LR: 6.55e-05, Opt Steps: 161, NaN count: 0
2025-05-29 22:31:39 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8577, accuracy: 0.8016, f1_macro: 0.8019, f1_weighted: 0.7991, precision_macro: 0.8094, precision_weighted: 0.8099, recall_macro: 0.8068, recall_weighted: 0.8016, f1_Bacterial_Blight: 0.7191, f1_Curl_Virus: 0.7216, f1_Healthy_Leaf: 0.7975, f1_Herbicide_Growth_Damage: 0.8933, f1_Leaf_Hopper_Jassids: 0.7660, f1_Leaf_Redding: 0.7882, f1_Leaf_Variegation: 0.9277
2025-05-29 22:31:39 - __main__ - INFO - [main_execution_logic:482] - E69: Val f1_macro (0.8019) not better. Patience: 4/25
2025-05-29 22:31:39 - __main__ - INFO - [main_execution_logic:496] - Epoch 69 completed in 550.23s.
2025-05-29 22:31:39 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E69 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 22:34:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E70 OptStep 50: Grad Norm: 3.3023
2025-05-29 22:36:41 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E70 OptStep 100: Grad Norm: 3.1041
2025-05-29 22:39:12 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E70 OptStep 150: Grad Norm: 3.1811
2025-05-29 22:39:47 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 70 training finished. Avg Loss: 0.9401, Final LR: 6.43e-05, Opt Steps: 161, NaN count: 0
2025-05-29 22:40:49 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8496, accuracy: 0.8067, f1_macro: 0.8060, f1_weighted: 0.8042, precision_macro: 0.8090, precision_weighted: 0.8103, recall_macro: 0.8111, recall_weighted: 0.8067, f1_Bacterial_Blight: 0.7139, f1_Curl_Virus: 0.7409, f1_Healthy_Leaf: 0.8264, f1_Herbicide_Growth_Damage: 0.8873, f1_Leaf_Hopper_Jassids: 0.7696, f1_Leaf_Redding: 0.7929, f1_Leaf_Variegation: 0.9107
2025-05-29 22:40:52 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 22:40:52 - __main__ - INFO - [main_execution_logic:479] - E70: New best! Val f1_macro: 0.8060
2025-05-29 22:40:54 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/checkpoint_epoch_70.pth
2025-05-29 22:40:54 - __main__ - INFO - [main_execution_logic:496] - Epoch 70 completed in 555.28s.
2025-05-29 22:40:54 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E70 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 22:43:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E71 OptStep 50: Grad Norm: 2.5035
2025-05-29 22:45:56 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E71 OptStep 100: Grad Norm: 4.4621
2025-05-29 22:48:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E71 OptStep 150: Grad Norm: 4.6240
2025-05-29 22:49:03 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 71 training finished. Avg Loss: 0.9534, Final LR: 6.32e-05, Opt Steps: 161, NaN count: 0
2025-05-29 22:50:04 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8594, accuracy: 0.8060, f1_macro: 0.8064, f1_weighted: 0.8033, precision_macro: 0.8151, precision_weighted: 0.8137, recall_macro: 0.8100, recall_weighted: 0.8060, f1_Bacterial_Blight: 0.7119, f1_Curl_Virus: 0.7262, f1_Healthy_Leaf: 0.8041, f1_Herbicide_Growth_Damage: 0.8985, f1_Leaf_Hopper_Jassids: 0.7769, f1_Leaf_Redding: 0.7870, f1_Leaf_Variegation: 0.9401
2025-05-29 22:50:08 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 22:50:08 - __main__ - INFO - [main_execution_logic:479] - E71: New best! Val f1_macro: 0.8064
2025-05-29 22:50:08 - __main__ - INFO - [main_execution_logic:496] - Epoch 71 completed in 554.07s.
2025-05-29 22:50:08 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E71 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 22:52:40 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E72 OptStep 50: Grad Norm: 4.1455
2025-05-29 22:55:11 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E72 OptStep 100: Grad Norm: 3.2536
2025-05-29 22:57:42 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E72 OptStep 150: Grad Norm: 4.2815
2025-05-29 22:58:18 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 72 training finished. Avg Loss: 0.9469, Final LR: 6.21e-05, Opt Steps: 161, NaN count: 0
2025-05-29 22:59:19 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8460, accuracy: 0.8125, f1_macro: 0.8132, f1_weighted: 0.8111, precision_macro: 0.8161, precision_weighted: 0.8180, recall_macro: 0.8179, recall_weighted: 0.8125, f1_Bacterial_Blight: 0.7111, f1_Curl_Virus: 0.7560, f1_Healthy_Leaf: 0.8225, f1_Herbicide_Growth_Damage: 0.9063, f1_Leaf_Hopper_Jassids: 0.7740, f1_Leaf_Redding: 0.7945, f1_Leaf_Variegation: 0.9281
2025-05-29 22:59:23 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-29 22:59:23 - __main__ - INFO - [main_execution_logic:479] - E72: New best! Val f1_macro: 0.8132
2025-05-29 22:59:23 - __main__ - INFO - [main_execution_logic:496] - Epoch 72 completed in 554.61s.
2025-05-29 22:59:23 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E72 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 23:01:54 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E73 OptStep 50: Grad Norm: 5.3734
2025-05-29 23:04:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E73 OptStep 100: Grad Norm: 3.8895
2025-05-29 23:06:56 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E73 OptStep 150: Grad Norm: 5.4136
2025-05-29 23:07:31 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 73 training finished. Avg Loss: 0.9289, Final LR: 6.10e-05, Opt Steps: 161, NaN count: 0
2025-05-29 23:08:33 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8472, accuracy: 0.8096, f1_macro: 0.8093, f1_weighted: 0.8067, precision_macro: 0.8147, precision_weighted: 0.8144, recall_macro: 0.8140, recall_weighted: 0.8096, f1_Bacterial_Blight: 0.7252, f1_Curl_Virus: 0.7335, f1_Healthy_Leaf: 0.8213, f1_Herbicide_Growth_Damage: 0.9141, f1_Leaf_Hopper_Jassids: 0.7594, f1_Leaf_Redding: 0.7852, f1_Leaf_Variegation: 0.9263
2025-05-29 23:08:33 - __main__ - INFO - [main_execution_logic:482] - E73: Val f1_macro (0.8093) not better. Patience: 1/25
2025-05-29 23:08:33 - __main__ - INFO - [main_execution_logic:496] - Epoch 73 completed in 550.47s.
2025-05-29 23:08:33 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E73 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 23:11:05 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E74 OptStep 50: Grad Norm: 4.6732
2025-05-29 23:13:36 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E74 OptStep 100: Grad Norm: 3.2525
2025-05-29 23:16:07 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E74 OptStep 150: Grad Norm: 3.9723
2025-05-29 23:16:42 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 74 training finished. Avg Loss: 0.9234, Final LR: 5.98e-05, Opt Steps: 161, NaN count: 0
2025-05-29 23:17:44 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8437, accuracy: 0.8031, f1_macro: 0.8034, f1_weighted: 0.8006, precision_macro: 0.8090, precision_weighted: 0.8101, recall_macro: 0.8093, recall_weighted: 0.8031, f1_Bacterial_Blight: 0.7068, f1_Curl_Virus: 0.7093, f1_Healthy_Leaf: 0.8293, f1_Herbicide_Growth_Damage: 0.9086, f1_Leaf_Hopper_Jassids: 0.7728, f1_Leaf_Redding: 0.7743, f1_Leaf_Variegation: 0.9226
2025-05-29 23:17:44 - __main__ - INFO - [main_execution_logic:482] - E74: Val f1_macro (0.8034) not better. Patience: 2/25
2025-05-29 23:17:44 - __main__ - INFO - [main_execution_logic:496] - Epoch 74 completed in 550.51s.
2025-05-29 23:17:44 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E74 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 23:20:15 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E75 OptStep 50: Grad Norm: 4.6903
2025-05-29 23:22:46 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E75 OptStep 100: Grad Norm: 3.7425
2025-05-29 23:25:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E75 OptStep 150: Grad Norm: 4.4394
2025-05-29 23:25:53 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 75 training finished. Avg Loss: 0.9440, Final LR: 5.87e-05, Opt Steps: 161, NaN count: 0
2025-05-29 23:26:55 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8388, accuracy: 0.8060, f1_macro: 0.8054, f1_weighted: 0.8028, precision_macro: 0.8120, precision_weighted: 0.8133, recall_macro: 0.8117, recall_weighted: 0.8060, f1_Bacterial_Blight: 0.7084, f1_Curl_Virus: 0.7176, f1_Healthy_Leaf: 0.8300, f1_Herbicide_Growth_Damage: 0.8966, f1_Leaf_Hopper_Jassids: 0.7763, f1_Leaf_Redding: 0.7832, f1_Leaf_Variegation: 0.9254
2025-05-29 23:26:55 - __main__ - INFO - [main_execution_logic:482] - E75: Val f1_macro (0.8054) not better. Patience: 3/25
2025-05-29 23:26:55 - __main__ - INFO - [main_execution_logic:496] - Epoch 75 completed in 551.15s.
2025-05-29 23:26:55 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E75 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 23:29:26 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E76 OptStep 50: Grad Norm: 6.8412
2025-05-29 23:31:57 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E76 OptStep 100: Grad Norm: 5.7253
2025-05-29 23:34:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E76 OptStep 150: Grad Norm: 4.9844
2025-05-29 23:35:04 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 76 training finished. Avg Loss: 0.9333, Final LR: 5.75e-05, Opt Steps: 161, NaN count: 0
2025-05-29 23:36:05 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8454, accuracy: 0.8089, f1_macro: 0.8076, f1_weighted: 0.8056, precision_macro: 0.8129, precision_weighted: 0.8145, recall_macro: 0.8142, recall_weighted: 0.8089, f1_Bacterial_Blight: 0.7179, f1_Curl_Virus: 0.7262, f1_Healthy_Leaf: 0.8184, f1_Herbicide_Growth_Damage: 0.8976, f1_Leaf_Hopper_Jassids: 0.7649, f1_Leaf_Redding: 0.8018, f1_Leaf_Variegation: 0.9267
2025-05-29 23:36:05 - __main__ - INFO - [main_execution_logic:482] - E76: Val f1_macro (0.8076) not better. Patience: 4/25
2025-05-29 23:36:05 - __main__ - INFO - [main_execution_logic:496] - Epoch 76 completed in 550.61s.
2025-05-29 23:36:05 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E76 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 23:38:37 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E77 OptStep 50: Grad Norm: 6.5052
2025-05-29 23:41:08 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E77 OptStep 100: Grad Norm: 3.1383
2025-05-29 23:43:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E77 OptStep 150: Grad Norm: 5.0837
2025-05-29 23:44:14 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 77 training finished. Avg Loss: 0.9377, Final LR: 5.64e-05, Opt Steps: 161, NaN count: 0
2025-05-29 23:45:16 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8525, accuracy: 0.8067, f1_macro: 0.8063, f1_weighted: 0.8038, precision_macro: 0.8152, precision_weighted: 0.8176, recall_macro: 0.8130, recall_weighted: 0.8067, f1_Bacterial_Blight: 0.7239, f1_Curl_Virus: 0.7289, f1_Healthy_Leaf: 0.8134, f1_Herbicide_Growth_Damage: 0.9005, f1_Leaf_Hopper_Jassids: 0.7721, f1_Leaf_Redding: 0.7880, f1_Leaf_Variegation: 0.9176
2025-05-29 23:45:16 - __main__ - INFO - [main_execution_logic:482] - E77: Val f1_macro (0.8063) not better. Patience: 5/25
2025-05-29 23:45:16 - __main__ - INFO - [main_execution_logic:496] - Epoch 77 completed in 550.27s.
2025-05-29 23:45:16 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E77 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 23:47:47 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E78 OptStep 50: Grad Norm: 7.9640
2025-05-29 23:50:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E78 OptStep 100: Grad Norm: 4.8932
2025-05-29 23:52:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E78 OptStep 150: Grad Norm: 6.0819
2025-05-29 23:53:24 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 78 training finished. Avg Loss: 0.9323, Final LR: 5.52e-05, Opt Steps: 161, NaN count: 0
2025-05-29 23:54:26 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8407, accuracy: 0.8118, f1_macro: 0.8116, f1_weighted: 0.8092, precision_macro: 0.8153, precision_weighted: 0.8156, recall_macro: 0.8165, recall_weighted: 0.8118, f1_Bacterial_Blight: 0.7232, f1_Curl_Virus: 0.7389, f1_Healthy_Leaf: 0.8190, f1_Herbicide_Growth_Damage: 0.8949, f1_Leaf_Hopper_Jassids: 0.7861, f1_Leaf_Redding: 0.7946, f1_Leaf_Variegation: 0.9249
2025-05-29 23:54:26 - __main__ - INFO - [main_execution_logic:482] - E78: Val f1_macro (0.8116) not better. Patience: 6/25
2025-05-29 23:54:26 - __main__ - INFO - [main_execution_logic:496] - Epoch 78 completed in 550.30s.
2025-05-29 23:54:26 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E78 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-29 23:56:57 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E79 OptStep 50: Grad Norm: 5.3400
2025-05-29 23:59:29 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E79 OptStep 100: Grad Norm: 4.9648
2025-05-30 00:02:00 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E79 OptStep 150: Grad Norm: 4.6609
2025-05-30 00:02:35 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 79 training finished. Avg Loss: 0.9356, Final LR: 5.41e-05, Opt Steps: 161, NaN count: 0
2025-05-30 00:03:37 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8471, accuracy: 0.8125, f1_macro: 0.8121, f1_weighted: 0.8101, precision_macro: 0.8181, precision_weighted: 0.8191, recall_macro: 0.8168, recall_weighted: 0.8125, f1_Bacterial_Blight: 0.7123, f1_Curl_Virus: 0.7616, f1_Healthy_Leaf: 0.8066, f1_Herbicide_Growth_Damage: 0.9055, f1_Leaf_Hopper_Jassids: 0.7819, f1_Leaf_Redding: 0.7982, f1_Leaf_Variegation: 0.9186
2025-05-30 00:03:37 - __main__ - INFO - [main_execution_logic:482] - E79: Val f1_macro (0.8121) not better. Patience: 7/25
2025-05-30 00:03:37 - __main__ - INFO - [main_execution_logic:496] - Epoch 79 completed in 550.74s.
2025-05-30 00:03:37 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E79 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 00:06:08 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E80 OptStep 50: Grad Norm: 4.2165
2025-05-30 00:08:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E80 OptStep 100: Grad Norm: 5.1847
2025-05-30 00:11:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E80 OptStep 150: Grad Norm: 4.6066
2025-05-30 00:11:46 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 80 training finished. Avg Loss: 0.9296, Final LR: 5.29e-05, Opt Steps: 161, NaN count: 0
2025-05-30 00:12:48 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8466, accuracy: 0.8074, f1_macro: 0.8074, f1_weighted: 0.8052, precision_macro: 0.8123, precision_weighted: 0.8118, recall_macro: 0.8110, recall_weighted: 0.8074, f1_Bacterial_Blight: 0.7107, f1_Curl_Virus: 0.7513, f1_Healthy_Leaf: 0.8077, f1_Herbicide_Growth_Damage: 0.8883, f1_Leaf_Hopper_Jassids: 0.7711, f1_Leaf_Redding: 0.7965, f1_Leaf_Variegation: 0.9258
2025-05-30 00:12:48 - __main__ - INFO - [main_execution_logic:482] - E80: Val f1_macro (0.8074) not better. Patience: 8/25
2025-05-30 00:12:49 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/checkpoint_epoch_80.pth
2025-05-30 00:12:49 - __main__ - INFO - [main_execution_logic:496] - Epoch 80 completed in 552.41s.
2025-05-30 00:12:49 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E80 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 00:15:21 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E81 OptStep 50: Grad Norm: 3.9523
2025-05-30 00:17:52 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E81 OptStep 100: Grad Norm: 4.4350
2025-05-30 00:20:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E81 OptStep 150: Grad Norm: 4.2652
2025-05-30 00:20:58 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 81 training finished. Avg Loss: 0.9267, Final LR: 5.17e-05, Opt Steps: 161, NaN count: 0
2025-05-30 00:21:59 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8449, accuracy: 0.8016, f1_macro: 0.8013, f1_weighted: 0.7983, precision_macro: 0.8128, precision_weighted: 0.8133, recall_macro: 0.8072, recall_weighted: 0.8016, f1_Bacterial_Blight: 0.7075, f1_Curl_Virus: 0.7024, f1_Healthy_Leaf: 0.7984, f1_Herbicide_Growth_Damage: 0.9114, f1_Leaf_Hopper_Jassids: 0.7728, f1_Leaf_Redding: 0.7856, f1_Leaf_Variegation: 0.9313
2025-05-30 00:21:59 - __main__ - INFO - [main_execution_logic:482] - E81: Val f1_macro (0.8013) not better. Patience: 9/25
2025-05-30 00:21:59 - __main__ - INFO - [main_execution_logic:496] - Epoch 81 completed in 550.11s.
2025-05-30 00:21:59 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E81 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 00:24:31 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E82 OptStep 50: Grad Norm: 5.2042
2025-05-30 00:27:02 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E82 OptStep 100: Grad Norm: 4.9853
2025-05-30 00:29:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E82 OptStep 150: Grad Norm: 3.3038
2025-05-30 00:30:08 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 82 training finished. Avg Loss: 0.9242, Final LR: 5.06e-05, Opt Steps: 161, NaN count: 0
2025-05-30 00:31:10 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8365, accuracy: 0.8104, f1_macro: 0.8102, f1_weighted: 0.8079, precision_macro: 0.8130, precision_weighted: 0.8136, recall_macro: 0.8151, recall_weighted: 0.8104, f1_Bacterial_Blight: 0.7075, f1_Curl_Virus: 0.7541, f1_Healthy_Leaf: 0.8190, f1_Herbicide_Growth_Damage: 0.9020, f1_Leaf_Hopper_Jassids: 0.7867, f1_Leaf_Redding: 0.7848, f1_Leaf_Variegation: 0.9172
2025-05-30 00:31:10 - __main__ - INFO - [main_execution_logic:482] - E82: Val f1_macro (0.8102) not better. Patience: 10/25
2025-05-30 00:31:10 - __main__ - INFO - [main_execution_logic:496] - Epoch 82 completed in 550.82s.
2025-05-30 00:31:10 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E82 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 00:33:42 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E83 OptStep 50: Grad Norm: 3.1827
2025-05-30 00:36:13 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E83 OptStep 100: Grad Norm: 4.6310
2025-05-30 00:38:44 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E83 OptStep 150: Grad Norm: 3.7392
2025-05-30 00:39:19 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 83 training finished. Avg Loss: 0.9262, Final LR: 4.94e-05, Opt Steps: 161, NaN count: 0
2025-05-30 00:40:21 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8316, accuracy: 0.8133, f1_macro: 0.8130, f1_weighted: 0.8104, precision_macro: 0.8173, precision_weighted: 0.8170, recall_macro: 0.8179, recall_weighted: 0.8133, f1_Bacterial_Blight: 0.7182, f1_Curl_Virus: 0.7335, f1_Healthy_Leaf: 0.8344, f1_Herbicide_Growth_Damage: 0.9037, f1_Leaf_Hopper_Jassids: 0.7947, f1_Leaf_Redding: 0.7845, f1_Leaf_Variegation: 0.9222
2025-05-30 00:40:21 - __main__ - INFO - [main_execution_logic:482] - E83: Val f1_macro (0.8130) not better. Patience: 11/25
2025-05-30 00:40:21 - __main__ - INFO - [main_execution_logic:496] - Epoch 83 completed in 550.96s.
2025-05-30 00:40:21 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E83 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 00:42:52 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E84 OptStep 50: Grad Norm: 4.7411
2025-05-30 00:45:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E84 OptStep 100: Grad Norm: 3.1381
2025-05-30 00:47:55 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E84 OptStep 150: Grad Norm: 4.2711
2025-05-30 00:48:30 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 84 training finished. Avg Loss: 0.9214, Final LR: 4.83e-05, Opt Steps: 161, NaN count: 0
2025-05-30 00:49:31 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8338, accuracy: 0.8082, f1_macro: 0.8078, f1_weighted: 0.8048, precision_macro: 0.8122, precision_weighted: 0.8123, recall_macro: 0.8137, recall_weighted: 0.8082, f1_Bacterial_Blight: 0.7143, f1_Curl_Virus: 0.7163, f1_Healthy_Leaf: 0.8294, f1_Herbicide_Growth_Damage: 0.9032, f1_Leaf_Hopper_Jassids: 0.7840, f1_Leaf_Redding: 0.7788, f1_Leaf_Variegation: 0.9286
2025-05-30 00:49:31 - __main__ - INFO - [main_execution_logic:482] - E84: Val f1_macro (0.8078) not better. Patience: 12/25
2025-05-30 00:49:31 - __main__ - INFO - [main_execution_logic:496] - Epoch 84 completed in 550.34s.
2025-05-30 00:49:31 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E84 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 00:52:03 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E85 OptStep 50: Grad Norm: 4.4354
2025-05-30 00:54:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E85 OptStep 100: Grad Norm: 5.4260
2025-05-30 00:57:05 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E85 OptStep 150: Grad Norm: 3.0573
2025-05-30 00:57:40 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 85 training finished. Avg Loss: 0.9161, Final LR: 4.71e-05, Opt Steps: 161, NaN count: 0
2025-05-30 00:58:42 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8424, accuracy: 0.8147, f1_macro: 0.8150, f1_weighted: 0.8127, precision_macro: 0.8196, precision_weighted: 0.8210, recall_macro: 0.8198, recall_weighted: 0.8147, f1_Bacterial_Blight: 0.7131, f1_Curl_Virus: 0.7588, f1_Healthy_Leaf: 0.8117, f1_Herbicide_Growth_Damage: 0.9082, f1_Leaf_Hopper_Jassids: 0.7867, f1_Leaf_Redding: 0.7972, f1_Leaf_Variegation: 0.9290
2025-05-30 00:58:46 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-30 00:58:46 - __main__ - INFO - [main_execution_logic:479] - E85: New best! Val f1_macro: 0.8150
2025-05-30 00:58:46 - __main__ - INFO - [main_execution_logic:496] - Epoch 85 completed in 554.17s.
2025-05-30 00:58:46 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E85 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 01:01:17 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E86 OptStep 50: Grad Norm: 4.7452
2025-05-30 01:03:48 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E86 OptStep 100: Grad Norm: 7.5164
2025-05-30 01:06:19 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E86 OptStep 150: Grad Norm: 25.1494
2025-05-30 01:06:54 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 86 training finished. Avg Loss: 0.9209, Final LR: 4.59e-05, Opt Steps: 161, NaN count: 0
2025-05-30 01:07:56 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8314, accuracy: 0.8184, f1_macro: 0.8183, f1_weighted: 0.8165, precision_macro: 0.8218, precision_weighted: 0.8239, recall_macro: 0.8236, recall_weighted: 0.8184, f1_Bacterial_Blight: 0.7335, f1_Curl_Virus: 0.7430, f1_Healthy_Leaf: 0.8421, f1_Herbicide_Growth_Damage: 0.9215, f1_Leaf_Hopper_Jassids: 0.7742, f1_Leaf_Redding: 0.8000, f1_Leaf_Variegation: 0.9139
2025-05-30 01:08:00 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-30 01:08:00 - __main__ - INFO - [main_execution_logic:479] - E86: New best! Val f1_macro: 0.8183
2025-05-30 01:08:00 - __main__ - INFO - [main_execution_logic:496] - Epoch 86 completed in 554.26s.
2025-05-30 01:08:00 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E86 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 01:10:31 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E87 OptStep 50: Grad Norm: 7.3939
2025-05-30 01:13:02 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E87 OptStep 100: Grad Norm: 3.5785
2025-05-30 01:15:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E87 OptStep 150: Grad Norm: 3.1384
2025-05-30 01:16:08 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 87 training finished. Avg Loss: 0.9225, Final LR: 4.48e-05, Opt Steps: 161, NaN count: 0
2025-05-30 01:17:10 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8287, accuracy: 0.8206, f1_macro: 0.8211, f1_weighted: 0.8192, precision_macro: 0.8242, precision_weighted: 0.8254, recall_macro: 0.8252, recall_weighted: 0.8206, f1_Bacterial_Blight: 0.7258, f1_Curl_Virus: 0.7556, f1_Healthy_Leaf: 0.8300, f1_Herbicide_Growth_Damage: 0.9242, f1_Leaf_Hopper_Jassids: 0.7819, f1_Leaf_Redding: 0.8053, f1_Leaf_Variegation: 0.9249
2025-05-30 01:17:14 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-30 01:17:14 - __main__ - INFO - [main_execution_logic:479] - E87: New best! Val f1_macro: 0.8211
2025-05-30 01:17:14 - __main__ - INFO - [main_execution_logic:496] - Epoch 87 completed in 553.73s.
2025-05-30 01:17:14 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E87 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 01:19:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E88 OptStep 50: Grad Norm: 4.7596
2025-05-30 01:22:16 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E88 OptStep 100: Grad Norm: 3.5051
2025-05-30 01:24:47 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E88 OptStep 150: Grad Norm: 3.4857
2025-05-30 01:25:22 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 88 training finished. Avg Loss: 0.9113, Final LR: 4.36e-05, Opt Steps: 161, NaN count: 0
2025-05-30 01:26:24 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8248, accuracy: 0.8169, f1_macro: 0.8177, f1_weighted: 0.8154, precision_macro: 0.8220, precision_weighted: 0.8236, recall_macro: 0.8224, recall_weighted: 0.8169, f1_Bacterial_Blight: 0.7135, f1_Curl_Virus: 0.7658, f1_Healthy_Leaf: 0.8283, f1_Herbicide_Growth_Damage: 0.9169, f1_Leaf_Hopper_Jassids: 0.7872, f1_Leaf_Redding: 0.7872, f1_Leaf_Variegation: 0.9249
2025-05-30 01:26:24 - __main__ - INFO - [main_execution_logic:482] - E88: Val f1_macro (0.8177) not better. Patience: 1/25
2025-05-30 01:26:24 - __main__ - INFO - [main_execution_logic:496] - Epoch 88 completed in 550.75s.
2025-05-30 01:26:24 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E88 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 01:28:56 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E89 OptStep 50: Grad Norm: 4.0245
2025-05-30 01:31:26 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E89 OptStep 100: Grad Norm: 6.0038
2025-05-30 01:33:58 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E89 OptStep 150: Grad Norm: 3.6758
2025-05-30 01:34:33 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 89 training finished. Avg Loss: 0.9060, Final LR: 4.25e-05, Opt Steps: 161, NaN count: 0
2025-05-30 01:35:35 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8264, accuracy: 0.8147, f1_macro: 0.8146, f1_weighted: 0.8127, precision_macro: 0.8185, precision_weighted: 0.8192, recall_macro: 0.8189, recall_weighted: 0.8147, f1_Bacterial_Blight: 0.7120, f1_Curl_Virus: 0.7521, f1_Healthy_Leaf: 0.8279, f1_Herbicide_Growth_Damage: 0.9020, f1_Leaf_Hopper_Jassids: 0.7845, f1_Leaf_Redding: 0.7991, f1_Leaf_Variegation: 0.9249
2025-05-30 01:35:35 - __main__ - INFO - [main_execution_logic:482] - E89: Val f1_macro (0.8146) not better. Patience: 2/25
2025-05-30 01:35:35 - __main__ - INFO - [main_execution_logic:496] - Epoch 89 completed in 550.30s.
2025-05-30 01:35:35 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E89 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 01:38:06 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E90 OptStep 50: Grad Norm: 3.8883
2025-05-30 01:40:37 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E90 OptStep 100: Grad Norm: 3.8298
2025-05-30 01:43:08 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E90 OptStep 150: Grad Norm: 5.7947
2025-05-30 01:43:43 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 90 training finished. Avg Loss: 0.9054, Final LR: 4.13e-05, Opt Steps: 161, NaN count: 0
2025-05-30 01:44:45 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8285, accuracy: 0.8147, f1_macro: 0.8149, f1_weighted: 0.8127, precision_macro: 0.8199, precision_weighted: 0.8198, recall_macro: 0.8185, recall_weighted: 0.8147, f1_Bacterial_Blight: 0.7127, f1_Curl_Virus: 0.7493, f1_Healthy_Leaf: 0.8188, f1_Herbicide_Growth_Damage: 0.9169, f1_Leaf_Hopper_Jassids: 0.7890, f1_Leaf_Redding: 0.7957, f1_Leaf_Variegation: 0.9222
2025-05-30 01:44:45 - __main__ - INFO - [main_execution_logic:482] - E90: Val f1_macro (0.8149) not better. Patience: 3/25
2025-05-30 01:44:47 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/checkpoint_epoch_90.pth
2025-05-30 01:44:47 - __main__ - INFO - [main_execution_logic:496] - Epoch 90 completed in 552.05s.
2025-05-30 01:44:47 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E90 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 01:47:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E91 OptStep 50: Grad Norm: 3.6080
2025-05-30 01:49:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E91 OptStep 100: Grad Norm: 5.3257
2025-05-30 01:52:20 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E91 OptStep 150: Grad Norm: 5.0011
2025-05-30 01:52:55 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 91 training finished. Avg Loss: 0.9085, Final LR: 4.02e-05, Opt Steps: 161, NaN count: 0
2025-05-30 01:53:56 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8286, accuracy: 0.8169, f1_macro: 0.8167, f1_weighted: 0.8147, precision_macro: 0.8176, precision_weighted: 0.8186, recall_macro: 0.8216, recall_weighted: 0.8169, f1_Bacterial_Blight: 0.7248, f1_Curl_Virus: 0.7466, f1_Healthy_Leaf: 0.8285, f1_Herbicide_Growth_Damage: 0.9127, f1_Leaf_Hopper_Jassids: 0.7756, f1_Leaf_Redding: 0.8044, f1_Leaf_Variegation: 0.9240
2025-05-30 01:53:56 - __main__ - INFO - [main_execution_logic:482] - E91: Val f1_macro (0.8167) not better. Patience: 4/25
2025-05-30 01:53:56 - __main__ - INFO - [main_execution_logic:496] - Epoch 91 completed in 549.73s.
2025-05-30 01:53:56 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E91 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 01:56:27 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E92 OptStep 50: Grad Norm: 4.8715
2025-05-30 01:58:58 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E92 OptStep 100: Grad Norm: 6.3768
2025-05-30 02:01:29 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E92 OptStep 150: Grad Norm: 4.5841
2025-05-30 02:02:04 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 92 training finished. Avg Loss: 0.9056, Final LR: 3.90e-05, Opt Steps: 161, NaN count: 0
2025-05-30 02:03:05 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8279, accuracy: 0.8228, f1_macro: 0.8235, f1_weighted: 0.8215, precision_macro: 0.8254, precision_weighted: 0.8263, recall_macro: 0.8271, recall_weighted: 0.8228, f1_Bacterial_Blight: 0.7242, f1_Curl_Virus: 0.7778, f1_Healthy_Leaf: 0.8192, f1_Herbicide_Growth_Damage: 0.9082, f1_Leaf_Hopper_Jassids: 0.7826, f1_Leaf_Redding: 0.8126, f1_Leaf_Variegation: 0.9398
2025-05-30 02:03:09 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-30 02:03:09 - __main__ - INFO - [main_execution_logic:479] - E92: New best! Val f1_macro: 0.8235
2025-05-30 02:03:09 - __main__ - INFO - [main_execution_logic:496] - Epoch 92 completed in 552.74s.
2025-05-30 02:03:09 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E92 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 02:05:40 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E93 OptStep 50: Grad Norm: 5.1777
2025-05-30 02:08:11 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E93 OptStep 100: Grad Norm: 4.2287
2025-05-30 02:10:42 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E93 OptStep 150: Grad Norm: 3.3309
2025-05-30 02:11:17 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 93 training finished. Avg Loss: 0.9095, Final LR: 3.79e-05, Opt Steps: 161, NaN count: 0
2025-05-30 02:12:19 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8304, accuracy: 0.8053, f1_macro: 0.8047, f1_weighted: 0.8022, precision_macro: 0.8111, precision_weighted: 0.8110, recall_macro: 0.8097, recall_weighted: 0.8053, f1_Bacterial_Blight: 0.7029, f1_Curl_Virus: 0.7246, f1_Healthy_Leaf: 0.8009, f1_Herbicide_Growth_Damage: 0.8949, f1_Leaf_Hopper_Jassids: 0.7833, f1_Leaf_Redding: 0.7957, f1_Leaf_Variegation: 0.9309
2025-05-30 02:12:19 - __main__ - INFO - [main_execution_logic:482] - E93: Val f1_macro (0.8047) not better. Patience: 1/25
2025-05-30 02:12:19 - __main__ - INFO - [main_execution_logic:496] - Epoch 93 completed in 549.98s.
2025-05-30 02:12:19 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E93 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 02:14:50 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E94 OptStep 50: Grad Norm: 3.7290
2025-05-30 02:17:21 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E94 OptStep 100: Grad Norm: 3.7421
2025-05-30 02:19:51 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E94 OptStep 150: Grad Norm: 5.6667
2025-05-30 02:20:26 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 94 training finished. Avg Loss: 0.9157, Final LR: 3.68e-05, Opt Steps: 161, NaN count: 0
2025-05-30 02:21:28 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8233, accuracy: 0.8184, f1_macro: 0.8186, f1_weighted: 0.8162, precision_macro: 0.8211, precision_weighted: 0.8217, recall_macro: 0.8235, recall_weighted: 0.8184, f1_Bacterial_Blight: 0.7326, f1_Curl_Virus: 0.7416, f1_Healthy_Leaf: 0.8288, f1_Herbicide_Growth_Damage: 0.9077, f1_Leaf_Hopper_Jassids: 0.7923, f1_Leaf_Redding: 0.8009, f1_Leaf_Variegation: 0.9263
2025-05-30 02:21:28 - __main__ - INFO - [main_execution_logic:482] - E94: Val f1_macro (0.8186) not better. Patience: 2/25
2025-05-30 02:21:28 - __main__ - INFO - [main_execution_logic:496] - Epoch 94 completed in 549.20s.
2025-05-30 02:21:28 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E94 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 02:24:00 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E95 OptStep 50: Grad Norm: 5.6120
2025-05-30 02:26:31 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E95 OptStep 100: Grad Norm: 3.4679
2025-05-30 02:29:01 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E95 OptStep 150: Grad Norm: 3.8306
2025-05-30 02:29:36 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 95 training finished. Avg Loss: 0.9071, Final LR: 3.57e-05, Opt Steps: 161, NaN count: 0
2025-05-30 02:30:38 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8273, accuracy: 0.8191, f1_macro: 0.8191, f1_weighted: 0.8170, precision_macro: 0.8222, precision_weighted: 0.8220, recall_macro: 0.8228, recall_weighted: 0.8191, f1_Bacterial_Blight: 0.7184, f1_Curl_Virus: 0.7547, f1_Healthy_Leaf: 0.8143, f1_Herbicide_Growth_Damage: 0.9141, f1_Leaf_Hopper_Jassids: 0.7922, f1_Leaf_Redding: 0.8079, f1_Leaf_Variegation: 0.9322
2025-05-30 02:30:38 - __main__ - INFO - [main_execution_logic:482] - E95: Val f1_macro (0.8191) not better. Patience: 3/25
2025-05-30 02:30:38 - __main__ - INFO - [main_execution_logic:496] - Epoch 95 completed in 549.70s.
2025-05-30 02:30:38 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E95 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 02:33:09 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E96 OptStep 50: Grad Norm: 10.2565
2025-05-30 02:35:40 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E96 OptStep 100: Grad Norm: 3.6224
2025-05-30 02:38:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E96 OptStep 150: Grad Norm: 4.5195
2025-05-30 02:38:45 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 96 training finished. Avg Loss: 0.9030, Final LR: 3.45e-05, Opt Steps: 161, NaN count: 0
2025-05-30 02:39:47 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8274, accuracy: 0.8140, f1_macro: 0.8142, f1_weighted: 0.8116, precision_macro: 0.8173, precision_weighted: 0.8170, recall_macro: 0.8184, recall_weighted: 0.8140, f1_Bacterial_Blight: 0.7135, f1_Curl_Virus: 0.7493, f1_Healthy_Leaf: 0.8086, f1_Herbicide_Growth_Damage: 0.9109, f1_Leaf_Hopper_Jassids: 0.7967, f1_Leaf_Redding: 0.7939, f1_Leaf_Variegation: 0.9263
2025-05-30 02:39:47 - __main__ - INFO - [main_execution_logic:482] - E96: Val f1_macro (0.8142) not better. Patience: 4/25
2025-05-30 02:39:47 - __main__ - INFO - [main_execution_logic:496] - Epoch 96 completed in 549.20s.
2025-05-30 02:39:47 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E96 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 02:42:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E97 OptStep 50: Grad Norm: 3.6608
2025-05-30 02:44:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E97 OptStep 100: Grad Norm: 3.7653
2025-05-30 02:47:19 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E97 OptStep 150: Grad Norm: 3.7185
2025-05-30 02:47:55 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 97 training finished. Avg Loss: 0.8976, Final LR: 3.34e-05, Opt Steps: 161, NaN count: 0
2025-05-30 02:48:57 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8287, accuracy: 0.8133, f1_macro: 0.8138, f1_weighted: 0.8113, precision_macro: 0.8172, precision_weighted: 0.8176, recall_macro: 0.8180, recall_weighted: 0.8133, f1_Bacterial_Blight: 0.7131, f1_Curl_Virus: 0.7554, f1_Healthy_Leaf: 0.8077, f1_Herbicide_Growth_Damage: 0.9015, f1_Leaf_Hopper_Jassids: 0.7901, f1_Leaf_Redding: 0.7973, f1_Leaf_Variegation: 0.9313
2025-05-30 02:48:57 - __main__ - INFO - [main_execution_logic:482] - E97: Val f1_macro (0.8138) not better. Patience: 5/25
2025-05-30 02:48:57 - __main__ - INFO - [main_execution_logic:496] - Epoch 97 completed in 549.48s.
2025-05-30 02:48:57 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E97 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 02:51:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E98 OptStep 50: Grad Norm: 6.4377
2025-05-30 02:53:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E98 OptStep 100: Grad Norm: 7.7601
2025-05-30 02:56:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E98 OptStep 150: Grad Norm: 4.9074
2025-05-30 02:57:05 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 98 training finished. Avg Loss: 0.8996, Final LR: 3.24e-05, Opt Steps: 161, NaN count: 0
2025-05-30 02:58:07 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8190, accuracy: 0.8162, f1_macro: 0.8159, f1_weighted: 0.8137, precision_macro: 0.8174, precision_weighted: 0.8180, recall_macro: 0.8210, recall_weighted: 0.8162, f1_Bacterial_Blight: 0.7131, f1_Curl_Virus: 0.7624, f1_Healthy_Leaf: 0.8360, f1_Herbicide_Growth_Damage: 0.9046, f1_Leaf_Hopper_Jassids: 0.7859, f1_Leaf_Redding: 0.7860, f1_Leaf_Variegation: 0.9235
2025-05-30 02:58:07 - __main__ - INFO - [main_execution_logic:482] - E98: Val f1_macro (0.8159) not better. Patience: 6/25
2025-05-30 02:58:07 - __main__ - INFO - [main_execution_logic:496] - Epoch 98 completed in 550.06s.
2025-05-30 02:58:07 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E98 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 03:00:38 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E99 OptStep 50: Grad Norm: 3.8716
2025-05-30 03:03:08 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E99 OptStep 100: Grad Norm: 3.8329
2025-05-30 03:05:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E99 OptStep 150: Grad Norm: 3.5963
2025-05-30 03:06:14 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 99 training finished. Avg Loss: 0.8947, Final LR: 3.13e-05, Opt Steps: 161, NaN count: 0
2025-05-30 03:07:16 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8304, accuracy: 0.8111, f1_macro: 0.8111, f1_weighted: 0.8084, precision_macro: 0.8192, precision_weighted: 0.8179, recall_macro: 0.8145, recall_weighted: 0.8111, f1_Bacterial_Blight: 0.7171, f1_Curl_Virus: 0.7320, f1_Healthy_Leaf: 0.8091, f1_Herbicide_Growth_Damage: 0.9118, f1_Leaf_Hopper_Jassids: 0.7855, f1_Leaf_Redding: 0.7940, f1_Leaf_Variegation: 0.9281
2025-05-30 03:07:16 - __main__ - INFO - [main_execution_logic:482] - E99: Val f1_macro (0.8111) not better. Patience: 7/25
2025-05-30 03:07:16 - __main__ - INFO - [main_execution_logic:496] - Epoch 99 completed in 549.71s.
2025-05-30 03:07:16 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E99 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 03:09:48 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E100 OptStep 50: Grad Norm: 6.7320
2025-05-30 03:12:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E100 OptStep 100: Grad Norm: 5.6138
2025-05-30 03:14:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E100 OptStep 150: Grad Norm: 2.7751
2025-05-30 03:15:24 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 100 training finished. Avg Loss: 0.8991, Final LR: 3.02e-05, Opt Steps: 161, NaN count: 0
2025-05-30 03:16:26 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8274, accuracy: 0.8118, f1_macro: 0.8117, f1_weighted: 0.8091, precision_macro: 0.8157, precision_weighted: 0.8159, recall_macro: 0.8167, recall_weighted: 0.8118, f1_Bacterial_Blight: 0.7222, f1_Curl_Virus: 0.7365, f1_Healthy_Leaf: 0.8210, f1_Herbicide_Growth_Damage: 0.9042, f1_Leaf_Hopper_Jassids: 0.7787, f1_Leaf_Redding: 0.7912, f1_Leaf_Variegation: 0.9281
2025-05-30 03:16:26 - __main__ - INFO - [main_execution_logic:482] - E100: Val f1_macro (0.8117) not better. Patience: 8/25
2025-05-30 03:16:28 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/checkpoint_epoch_100.pth
2025-05-30 03:16:28 - __main__ - INFO - [main_execution_logic:496] - Epoch 100 completed in 551.25s.
2025-05-30 03:16:28 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E100 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 03:18:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E101 OptStep 50: Grad Norm: 3.0666
2025-05-30 03:21:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E101 OptStep 100: Grad Norm: 5.2747
2025-05-30 03:24:01 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E101 OptStep 150: Grad Norm: 3.6714
2025-05-30 03:24:36 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 101 training finished. Avg Loss: 0.8999, Final LR: 2.91e-05, Opt Steps: 161, NaN count: 0
2025-05-30 03:25:38 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8258, accuracy: 0.8162, f1_macro: 0.8169, f1_weighted: 0.8144, precision_macro: 0.8213, precision_weighted: 0.8213, recall_macro: 0.8207, recall_weighted: 0.8162, f1_Bacterial_Blight: 0.7273, f1_Curl_Virus: 0.7588, f1_Healthy_Leaf: 0.8134, f1_Herbicide_Growth_Damage: 0.9118, f1_Leaf_Hopper_Jassids: 0.7875, f1_Leaf_Redding: 0.7937, f1_Leaf_Variegation: 0.9258
2025-05-30 03:25:38 - __main__ - INFO - [main_execution_logic:482] - E101: Val f1_macro (0.8169) not better. Patience: 9/25
2025-05-30 03:25:38 - __main__ - INFO - [main_execution_logic:496] - Epoch 101 completed in 550.03s.
2025-05-30 03:25:38 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E101 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 03:28:09 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E102 OptStep 50: Grad Norm: 6.0917
2025-05-30 03:30:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E102 OptStep 100: Grad Norm: 3.4735
2025-05-30 03:33:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E102 OptStep 150: Grad Norm: 2.5258
2025-05-30 03:33:45 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 102 training finished. Avg Loss: 0.9000, Final LR: 2.81e-05, Opt Steps: 161, NaN count: 0
2025-05-30 03:34:47 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8262, accuracy: 0.8155, f1_macro: 0.8162, f1_weighted: 0.8136, precision_macro: 0.8192, precision_weighted: 0.8198, recall_macro: 0.8209, recall_weighted: 0.8155, f1_Bacterial_Blight: 0.7317, f1_Curl_Virus: 0.7548, f1_Healthy_Leaf: 0.8140, f1_Herbicide_Growth_Damage: 0.9086, f1_Leaf_Hopper_Jassids: 0.7826, f1_Leaf_Redding: 0.7937, f1_Leaf_Variegation: 0.9281
2025-05-30 03:34:47 - __main__ - INFO - [main_execution_logic:482] - E102: Val f1_macro (0.8162) not better. Patience: 10/25
2025-05-30 03:34:47 - __main__ - INFO - [main_execution_logic:496] - Epoch 102 completed in 549.30s.
2025-05-30 03:34:47 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E102 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 03:37:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E103 OptStep 50: Grad Norm: 4.5098
2025-05-30 03:39:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E103 OptStep 100: Grad Norm: 3.0706
2025-05-30 03:42:20 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E103 OptStep 150: Grad Norm: 3.8830
2025-05-30 03:42:55 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 103 training finished. Avg Loss: 0.9165, Final LR: 2.70e-05, Opt Steps: 161, NaN count: 0
2025-05-30 03:43:57 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8226, accuracy: 0.8177, f1_macro: 0.8180, f1_weighted: 0.8160, precision_macro: 0.8203, precision_weighted: 0.8206, recall_macro: 0.8215, recall_weighted: 0.8177, f1_Bacterial_Blight: 0.7207, f1_Curl_Virus: 0.7614, f1_Healthy_Leaf: 0.8155, f1_Herbicide_Growth_Damage: 0.9196, f1_Leaf_Hopper_Jassids: 0.7790, f1_Leaf_Redding: 0.8044, f1_Leaf_Variegation: 0.9254
2025-05-30 03:43:57 - __main__ - INFO - [main_execution_logic:482] - E103: Val f1_macro (0.8180) not better. Patience: 11/25
2025-05-30 03:43:57 - __main__ - INFO - [main_execution_logic:496] - Epoch 103 completed in 550.06s.
2025-05-30 03:43:57 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E103 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 03:46:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E104 OptStep 50: Grad Norm: 3.5775
2025-05-30 03:48:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E104 OptStep 100: Grad Norm: 3.0353
2025-05-30 03:51:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E104 OptStep 150: Grad Norm: 5.6176
2025-05-30 03:52:05 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 104 training finished. Avg Loss: 0.8883, Final LR: 2.60e-05, Opt Steps: 161, NaN count: 0
2025-05-30 03:53:07 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8194, accuracy: 0.8177, f1_macro: 0.8182, f1_weighted: 0.8156, precision_macro: 0.8204, precision_weighted: 0.8202, recall_macro: 0.8223, recall_weighted: 0.8177, f1_Bacterial_Blight: 0.7163, f1_Curl_Virus: 0.7507, f1_Healthy_Leaf: 0.8279, f1_Herbicide_Growth_Damage: 0.9173, f1_Leaf_Hopper_Jassids: 0.7902, f1_Leaf_Redding: 0.7912, f1_Leaf_Variegation: 0.9341
2025-05-30 03:53:07 - __main__ - INFO - [main_execution_logic:482] - E104: Val f1_macro (0.8182) not better. Patience: 12/25
2025-05-30 03:53:07 - __main__ - INFO - [main_execution_logic:496] - Epoch 104 completed in 549.53s.
2025-05-30 03:53:07 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E104 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 03:55:38 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E105 OptStep 50: Grad Norm: 4.1883
2025-05-30 03:58:09 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E105 OptStep 100: Grad Norm: 4.9258
2025-05-30 04:00:40 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E105 OptStep 150: Grad Norm: 5.5131
2025-05-30 04:01:16 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 105 training finished. Avg Loss: 0.8926, Final LR: 2.50e-05, Opt Steps: 161, NaN count: 0
2025-05-30 04:02:18 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8150, accuracy: 0.8257, f1_macro: 0.8262, f1_weighted: 0.8237, precision_macro: 0.8288, precision_weighted: 0.8274, recall_macro: 0.8290, recall_weighted: 0.8257, f1_Bacterial_Blight: 0.7348, f1_Curl_Virus: 0.7569, f1_Healthy_Leaf: 0.8400, f1_Herbicide_Growth_Damage: 0.9200, f1_Leaf_Hopper_Jassids: 0.7978, f1_Leaf_Redding: 0.8000, f1_Leaf_Variegation: 0.9337
2025-05-30 04:02:21 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-30 04:02:21 - __main__ - INFO - [main_execution_logic:479] - E105: New best! Val f1_macro: 0.8262
2025-05-30 04:02:21 - __main__ - INFO - [main_execution_logic:496] - Epoch 105 completed in 554.47s.
2025-05-30 04:02:21 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E105 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 04:04:53 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E106 OptStep 50: Grad Norm: 3.2108
2025-05-30 04:07:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E106 OptStep 100: Grad Norm: 2.9986
2025-05-30 04:09:54 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E106 OptStep 150: Grad Norm: 4.5024
2025-05-30 04:10:30 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 106 training finished. Avg Loss: 0.9012, Final LR: 2.40e-05, Opt Steps: 161, NaN count: 0
2025-05-30 04:11:32 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8237, accuracy: 0.8177, f1_macro: 0.8175, f1_weighted: 0.8149, precision_macro: 0.8213, precision_weighted: 0.8207, recall_macro: 0.8218, recall_weighted: 0.8177, f1_Bacterial_Blight: 0.7147, f1_Curl_Virus: 0.7451, f1_Healthy_Leaf: 0.8294, f1_Herbicide_Growth_Damage: 0.9136, f1_Leaf_Hopper_Jassids: 0.7955, f1_Leaf_Redding: 0.7922, f1_Leaf_Variegation: 0.9318
2025-05-30 04:11:32 - __main__ - INFO - [main_execution_logic:482] - E106: Val f1_macro (0.8175) not better. Patience: 1/25
2025-05-30 04:11:32 - __main__ - INFO - [main_execution_logic:496] - Epoch 106 completed in 550.60s.
2025-05-30 04:11:32 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E106 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 04:14:03 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E107 OptStep 50: Grad Norm: 4.0011
2025-05-30 04:16:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E107 OptStep 100: Grad Norm: 6.2582
2025-05-30 04:19:05 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E107 OptStep 150: Grad Norm: 4.4828
2025-05-30 04:19:40 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 107 training finished. Avg Loss: 0.9100, Final LR: 2.30e-05, Opt Steps: 161, NaN count: 0
2025-05-30 04:20:42 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8187, accuracy: 0.8242, f1_macro: 0.8251, f1_weighted: 0.8227, precision_macro: 0.8277, precision_weighted: 0.8270, recall_macro: 0.8279, recall_weighted: 0.8242, f1_Bacterial_Blight: 0.7135, f1_Curl_Virus: 0.7725, f1_Healthy_Leaf: 0.8248, f1_Herbicide_Growth_Damage: 0.9173, f1_Leaf_Hopper_Jassids: 0.8056, f1_Leaf_Redding: 0.8027, f1_Leaf_Variegation: 0.9394
2025-05-30 04:20:42 - __main__ - INFO - [main_execution_logic:482] - E107: Val f1_macro (0.8251) not better. Patience: 2/25
2025-05-30 04:20:42 - __main__ - INFO - [main_execution_logic:496] - Epoch 107 completed in 550.20s.
2025-05-30 04:20:42 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E107 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 04:23:13 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E108 OptStep 50: Grad Norm: 5.3750
2025-05-30 04:25:44 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E108 OptStep 100: Grad Norm: 3.1255
2025-05-30 04:28:15 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E108 OptStep 150: Grad Norm: 5.0635
2025-05-30 04:28:50 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 108 training finished. Avg Loss: 0.8903, Final LR: 2.20e-05, Opt Steps: 161, NaN count: 0
2025-05-30 04:29:52 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8181, accuracy: 0.8235, f1_macro: 0.8243, f1_weighted: 0.8217, precision_macro: 0.8269, precision_weighted: 0.8271, recall_macro: 0.8284, recall_weighted: 0.8235, f1_Bacterial_Blight: 0.7213, f1_Curl_Virus: 0.7650, f1_Healthy_Leaf: 0.8279, f1_Herbicide_Growth_Damage: 0.9181, f1_Leaf_Hopper_Jassids: 0.8033, f1_Leaf_Redding: 0.7973, f1_Leaf_Variegation: 0.9369
2025-05-30 04:29:52 - __main__ - INFO - [main_execution_logic:482] - E108: Val f1_macro (0.8243) not better. Patience: 3/25
2025-05-30 04:29:52 - __main__ - INFO - [main_execution_logic:496] - Epoch 108 completed in 550.12s.
2025-05-30 04:29:52 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E108 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 04:32:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E109 OptStep 50: Grad Norm: 3.7760
2025-05-30 04:34:54 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E109 OptStep 100: Grad Norm: 3.3147
2025-05-30 04:37:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E109 OptStep 150: Grad Norm: 3.9556
2025-05-30 04:38:00 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 109 training finished. Avg Loss: 0.8911, Final LR: 2.11e-05, Opt Steps: 161, NaN count: 0
2025-05-30 04:39:02 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8284, accuracy: 0.8125, f1_macro: 0.8126, f1_weighted: 0.8099, precision_macro: 0.8146, precision_weighted: 0.8144, recall_macro: 0.8173, recall_weighted: 0.8125, f1_Bacterial_Blight: 0.6986, f1_Curl_Virus: 0.7520, f1_Healthy_Leaf: 0.8132, f1_Herbicide_Growth_Damage: 0.9012, f1_Leaf_Hopper_Jassids: 0.7922, f1_Leaf_Redding: 0.7903, f1_Leaf_Variegation: 0.9405
2025-05-30 04:39:02 - __main__ - INFO - [main_execution_logic:482] - E109: Val f1_macro (0.8126) not better. Patience: 4/25
2025-05-30 04:39:02 - __main__ - INFO - [main_execution_logic:496] - Epoch 109 completed in 550.16s.
2025-05-30 04:39:02 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E109 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 04:41:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E110 OptStep 50: Grad Norm: 3.5354
2025-05-30 04:44:04 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E110 OptStep 100: Grad Norm: 3.6320
2025-05-30 04:46:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E110 OptStep 150: Grad Norm: 4.1057
2025-05-30 04:47:09 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 110 training finished. Avg Loss: 0.8917, Final LR: 2.01e-05, Opt Steps: 161, NaN count: 0
2025-05-30 04:48:11 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8166, accuracy: 0.8169, f1_macro: 0.8172, f1_weighted: 0.8145, precision_macro: 0.8203, precision_weighted: 0.8198, recall_macro: 0.8215, recall_weighted: 0.8169, f1_Bacterial_Blight: 0.7115, f1_Curl_Virus: 0.7493, f1_Healthy_Leaf: 0.8240, f1_Herbicide_Growth_Damage: 0.9132, f1_Leaf_Hopper_Jassids: 0.7923, f1_Leaf_Redding: 0.7903, f1_Leaf_Variegation: 0.9401
2025-05-30 04:48:11 - __main__ - INFO - [main_execution_logic:482] - E110: Val f1_macro (0.8172) not better. Patience: 5/25
2025-05-30 04:48:13 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/checkpoint_epoch_110.pth
2025-05-30 04:48:13 - __main__ - INFO - [main_execution_logic:496] - Epoch 110 completed in 550.59s.
2025-05-30 04:48:13 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E110 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 04:50:44 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E111 OptStep 50: Grad Norm: 5.1586
2025-05-30 04:53:15 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E111 OptStep 100: Grad Norm: 6.0608
2025-05-30 04:55:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E111 OptStep 150: Grad Norm: 3.1525
2025-05-30 04:56:20 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 111 training finished. Avg Loss: 0.8936, Final LR: 1.92e-05, Opt Steps: 161, NaN count: 0
2025-05-30 04:57:22 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8197, accuracy: 0.8206, f1_macro: 0.8214, f1_weighted: 0.8191, precision_macro: 0.8246, precision_weighted: 0.8243, recall_macro: 0.8244, recall_weighted: 0.8206, f1_Bacterial_Blight: 0.7171, f1_Curl_Virus: 0.7745, f1_Healthy_Leaf: 0.8161, f1_Herbicide_Growth_Damage: 0.9219, f1_Leaf_Hopper_Jassids: 0.7843, f1_Leaf_Redding: 0.7991, f1_Leaf_Variegation: 0.9369
2025-05-30 04:57:22 - __main__ - INFO - [main_execution_logic:482] - E111: Val f1_macro (0.8214) not better. Patience: 6/25
2025-05-30 04:57:22 - __main__ - INFO - [main_execution_logic:496] - Epoch 111 completed in 549.53s.
2025-05-30 04:57:22 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E111 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 04:59:53 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E112 OptStep 50: Grad Norm: 3.7958
2025-05-30 05:02:24 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E112 OptStep 100: Grad Norm: 3.5530
2025-05-30 05:04:55 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E112 OptStep 150: Grad Norm: 3.7391
2025-05-30 05:05:30 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 112 training finished. Avg Loss: 0.8846, Final LR: 1.83e-05, Opt Steps: 161, NaN count: 0
2025-05-30 05:06:32 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8147, accuracy: 0.8162, f1_macro: 0.8159, f1_weighted: 0.8136, precision_macro: 0.8194, precision_weighted: 0.8184, recall_macro: 0.8196, recall_weighted: 0.8162, f1_Bacterial_Blight: 0.7163, f1_Curl_Virus: 0.7465, f1_Healthy_Leaf: 0.8190, f1_Herbicide_Growth_Damage: 0.9200, f1_Leaf_Hopper_Jassids: 0.7760, f1_Leaf_Redding: 0.7991, f1_Leaf_Variegation: 0.9345
2025-05-30 05:06:32 - __main__ - INFO - [main_execution_logic:482] - E112: Val f1_macro (0.8159) not better. Patience: 7/25
2025-05-30 05:06:32 - __main__ - INFO - [main_execution_logic:496] - Epoch 112 completed in 549.25s.
2025-05-30 05:06:32 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E112 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 05:09:03 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E113 OptStep 50: Grad Norm: 5.0739
2025-05-30 05:11:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E113 OptStep 100: Grad Norm: 3.4273
2025-05-30 05:14:04 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E113 OptStep 150: Grad Norm: 3.2877
2025-05-30 05:14:39 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 113 training finished. Avg Loss: 0.8905, Final LR: 1.74e-05, Opt Steps: 161, NaN count: 0
2025-05-30 05:15:41 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8133, accuracy: 0.8198, f1_macro: 0.8204, f1_weighted: 0.8184, precision_macro: 0.8232, precision_weighted: 0.8245, recall_macro: 0.8246, recall_weighted: 0.8198, f1_Bacterial_Blight: 0.7242, f1_Curl_Virus: 0.7663, f1_Healthy_Leaf: 0.8174, f1_Herbicide_Growth_Damage: 0.9223, f1_Leaf_Hopper_Jassids: 0.7704, f1_Leaf_Redding: 0.8081, f1_Leaf_Variegation: 0.9341
2025-05-30 05:15:41 - __main__ - INFO - [main_execution_logic:482] - E113: Val f1_macro (0.8204) not better. Patience: 8/25
2025-05-30 05:15:41 - __main__ - INFO - [main_execution_logic:496] - Epoch 113 completed in 549.32s.
2025-05-30 05:15:41 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E113 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 05:18:12 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E114 OptStep 50: Grad Norm: 2.8129
2025-05-30 05:20:42 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E114 OptStep 100: Grad Norm: 4.8214
2025-05-30 05:23:13 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E114 OptStep 150: Grad Norm: 2.9366
2025-05-30 05:23:48 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 114 training finished. Avg Loss: 0.8893, Final LR: 1.65e-05, Opt Steps: 161, NaN count: 0
2025-05-30 05:24:50 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8145, accuracy: 0.8228, f1_macro: 0.8238, f1_weighted: 0.8214, precision_macro: 0.8269, precision_weighted: 0.8278, recall_macro: 0.8277, recall_weighted: 0.8228, f1_Bacterial_Blight: 0.7258, f1_Curl_Virus: 0.7817, f1_Healthy_Leaf: 0.8180, f1_Herbicide_Growth_Damage: 0.9219, f1_Leaf_Hopper_Jassids: 0.7730, f1_Leaf_Redding: 0.8027, f1_Leaf_Variegation: 0.9433
2025-05-30 05:24:50 - __main__ - INFO - [main_execution_logic:482] - E114: Val f1_macro (0.8238) not better. Patience: 9/25
2025-05-30 05:24:50 - __main__ - INFO - [main_execution_logic:496] - Epoch 114 completed in 549.12s.
2025-05-30 05:24:50 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E114 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 05:27:21 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E115 OptStep 50: Grad Norm: 6.2726
2025-05-30 05:29:52 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E115 OptStep 100: Grad Norm: 4.1649
2025-05-30 05:32:22 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E115 OptStep 150: Grad Norm: 3.8247
2025-05-30 05:32:57 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:154] - Epoch 115 training finished. Avg Loss: 0.8825, Final LR: 1.57e-05, Opt Steps: 161, NaN count: 0
2025-05-30 05:33:59 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:222] - Validation finished. Avg Loss: 0.8122, accuracy: 0.8177, f1_macro: 0.8180, f1_weighted: 0.8156, precision_macro: 0.8223, precision_weighted: 0.8210, recall_macro: 0.8208, recall_weighted: 0.8177, f1_Bacterial_Blight: 0.7102, f1_Curl_Virus: 0.7556, f1_Healthy_Leaf: 0.8223, f1_Herbicide_Growth_Damage: 0.9200, f1_Leaf_Hopper_Jassids: 0.7859, f1_Leaf_Redding: 0.7957, f1_Leaf_Variegation: 0.9362
2025-05-30 05:33:59 - __main__ - INFO - [main_execution_logic:482] - E115: Val f1_macro (0.8180) not better. Patience: 10/25
2025-05-30 05:33:59 - __main__ - INFO - [main_execution_logic:496] - Epoch 115 completed in 549.26s.
2025-05-30 05:33:59 - __main__ - DEBUG - [main_execution_logic:497] - CUDA Mem E115 End: Alloc 4221.1MB, Reserved 6092.0MB
2025-05-30 05:36:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:128] - E116 OptStep 50: Grad Norm: 5.3482
2025-05-30 05:38:55 - __main__ - WARNING - [main_execution_logic:499] - Fine-tuning interrupted. Last completed epoch: 115.
2025-05-30 05:38:55 - __main__ - INFO - [main_execution_logic:502] - Fine-tuning ended. Last completed epoch: 115.
2025-05-30 05:38:57 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:229] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/final_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-30 05:38:57 - __main__ - INFO - [main_execution_logic:506] - Fine-tuning summary: Best validation 'f1_macro': 0.8262.
