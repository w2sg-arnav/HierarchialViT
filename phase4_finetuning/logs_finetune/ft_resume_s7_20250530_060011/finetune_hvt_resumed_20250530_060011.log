2025-05-30 06:00:11 - root - INFO - [setup_logging:75] - Logging configured. Log file: /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/ft_resume_s7_20250530_060011/finetune_hvt_resumed_20250530_060011.log. Logger 'root' Effective Level: DEBUG
2025-05-30 06:00:11 - __main__ - INFO - [main_execution_logic:138] - ======== Starting Phase 4 Fine-tuning (Run: ft_resume_s7_20250530_060011) ========
2025-05-30 06:00:11 - __main__ - INFO - [main_execution_logic:139] - Configuration: {'seed': 42, 'device': 'cuda', 'PROJECT_ROOT_PATH': '/teamspace/studios/this_studio/cvpr25', 'PACKAGE_ROOT_PATH': '/teamspace/studios/this_studio/cvpr25/phase4_finetuning', 'run_name_suffix': 'ft_resume_s7', 'log_dir': 'logs_finetune', 'log_file_base': 'finetune_hvt_resumed', 'checkpoint_save_dir_name': 'checkpoints', 'best_model_filename_base': 'best_finetuned_hvt_resumed', 'final_model_filename_base': 'final_finetuned_hvt_resumed', 'resume_finetune_checkpoint_path': '/teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth', 'load_optimizer_scheduler_on_resume': True, 'data_root': '/teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection', 'original_dataset_name': 'Original Dataset', 'augmented_dataset_name': None, 'img_size': (448, 448), 'num_classes': 7, 'train_split_ratio': 0.8, 'normalize_data': True, 'use_weighted_sampler': True, 'num_workers': 4, 'prefetch_factor': 2, 'model_architecture_name': 'DiseaseAwareHVT_ResumedFinetune', 'hvt_params_for_model_init': {'patch_size': 14, 'embed_dim_rgb': 192, 'embed_dim_spectral': 0, 'spectral_channels': 0, 'depths': [3, 6, 24, 3], 'num_heads': [6, 12, 24, 48], 'mlp_ratio': 4.0, 'qkv_bias': True, 'model_drop_rate': 0.1, 'attn_drop_rate': 0.0, 'drop_path_rate': 0.1, 'norm_layer_name': 'LayerNorm', 'use_dfca': False, 'use_gradient_checkpointing': True, 'ssl_enable_mae': False, 'ssl_enable_contrastive': False, 'enable_consistency_loss_heads': False}, 'epochs': 100, 'batch_size': 16, 'accumulation_steps': 2, 'amp_enabled': True, 'clip_grad_norm': 1.0, 'log_interval': 10, 'optimizer': 'AdamW', 'weight_decay': 0.05, 'optimizer_params': {'betas': (0.9, 0.999), 'eps': 1e-08}, 'freeze_backbone_epochs': 10, 'lr_head_frozen_phase': 5e-05, 'lr_backbone_unfrozen_phase': 5e-06, 'lr_head_unfrozen_phase': 1e-05, 'scheduler': 'WarmupCosine', 'warmup_epochs': 5, 'eta_min_lr': 1e-07, 'loss_label_smoothing': 0.1, 'augmentations_enabled': True, 'use_enhanced_augmentations': False, 'evaluate_every_n_epochs': 1, 'early_stopping_patience': 20, 'metric_to_monitor_early_stopping': 'f1_macro', 'enable_torch_compile': False, 'torch_compile_mode': 'reduce-overhead', 'matmul_precision': 'high', 'cudnn_benchmark': True}
2025-05-30 06:00:11 - __main__ - INFO - [set_global_seed:39] - Global random seed set to: 42
2025-05-30 06:00:11 - __main__ - INFO - [main_execution_logic:148] - Device: cuda. GPU: Tesla T4
2025-05-30 06:00:11 - __main__ - INFO - [main_execution_logic:153] - Enabled cudnn.benchmark.
2025-05-30 06:00:11 - __main__ - INFO - [main_execution_logic:156] - Set matmul_precision to high.
2025-05-30 06:00:11 - phase4_finetuning.dataset - INFO - [__init__:54] - [DATASET INIT - train] Root: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection, ImgSize: (448, 448), Normalize: True
2025-05-30 06:00:11 - phase4_finetuning.dataset - INFO - [__init__:74] - [DATASET INIT - train] Scanning: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection/Original Dataset
2025-05-30 06:00:11 - phase4_finetuning.dataset - DEBUG - [__init__:67] - [DATASET INIT - train] Dataset name 'None' is None/empty, skipping.
2025-05-30 06:00:11 - phase4_finetuning.dataset - INFO - [__init__:105] - [DATASET INIT - train] Total valid image paths collected: 2137 from ~2137 items considered.
2025-05-30 06:00:11 - phase4_finetuning.dataset - INFO - [__init__:117] - [DATASET INIT - train] Dataset split size: 1709 samples.
2025-05-30 06:00:11 - phase4_finetuning.dataset - INFO - [__init__:128] - [DATASET INIT - train] Base RGB Transforms: Compose(
      ToImage()
      ToDtype(scale=True)
      Resize(size=[448, 448], interpolation=InterpolationMode.BICUBIC, antialias=True)
      Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225], inplace=False)
)
2025-05-30 06:00:11 - phase4_finetuning.dataset - INFO - [__init__:54] - [DATASET INIT - val] Root: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection, ImgSize: (448, 448), Normalize: True
2025-05-30 06:00:11 - phase4_finetuning.dataset - INFO - [__init__:74] - [DATASET INIT - val] Scanning: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection/Original Dataset
2025-05-30 06:00:11 - phase4_finetuning.dataset - DEBUG - [__init__:67] - [DATASET INIT - val] Dataset name 'None' is None/empty, skipping.
2025-05-30 06:00:11 - phase4_finetuning.dataset - INFO - [__init__:105] - [DATASET INIT - val] Total valid image paths collected: 2137 from ~2137 items considered.
2025-05-30 06:00:11 - phase4_finetuning.dataset - INFO - [__init__:117] - [DATASET INIT - val] Dataset split size: 428 samples.
2025-05-30 06:00:11 - phase4_finetuning.dataset - INFO - [__init__:128] - [DATASET INIT - val] Base RGB Transforms: Compose(
      ToImage()
      ToDtype(scale=True)
      Resize(size=[448, 448], interpolation=InterpolationMode.BICUBIC, antialias=True)
      Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225], inplace=False)
)
2025-05-30 06:00:11 - phase4_finetuning.dataset - INFO - [get_class_weights:196] - Computed class weights (inv_freq for loss) for split 'train': [1.191 0.684 1.179 1.115 1.387 0.533 2.806]
2025-05-30 06:00:11 - __main__ - INFO - [main_execution_logic:180] - Using WeightedRandomSampler.
2025-05-30 06:00:11 - __main__ - INFO - [main_execution_logic:189] - Dataloaders: Train batches=106, Val batches=27
2025-05-30 06:00:11 - phase2_model.models.hvt - INFO - [create_disease_aware_hvt:602] - Factory: Creating DiseaseAwareHVT for img_size: (448, 448), num_classes: 7
2025-05-30 06:00:14 - phase2_model.models.hvt - INFO - [__init__:325] - HVT: Running RGB stream only. No fusion.
2025-05-30 06:00:16 - phase2_model.models.hvt - INFO - [__init__:359] - DiseaseAwareHVT initialized for image size (448, 448) and 7 classes.
2025-05-30 06:00:16 - __main__ - INFO - [main_execution_logic:198] - Initialized DiseaseAwareHVT model with 7 classes.
2025-05-30 06:00:16 - __main__ - INFO - [main_execution_logic:214] - Optimizer initialized: AdamW.
2025-05-30 06:00:16 - __main__ - INFO - [resume_from_checkpoint:62] - Resuming from checkpoint: /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-30 06:00:18 - __main__ - DEBUG - [resume_from_checkpoint:65] - Checkpoint keys: ['rgb_pos_embed', 'rgb_patch_embed.proj.weight', 'rgb_patch_embed.proj.bias', 'rgb_patch_embed.norm.weight', 'rgb_patch_embed.norm.bias', 'rgb_stages.0.blocks.0.norm1.weight', 'rgb_stages.0.blocks.0.norm1.bias', 'rgb_stages.0.blocks.0.attn.qkv.weight', 'rgb_stages.0.blocks.0.attn.qkv.bias', 'rgb_stages.0.blocks.0.attn.proj.weight', 'rgb_stages.0.blocks.0.attn.proj.bias', 'rgb_stages.0.blocks.0.norm2.weight', 'rgb_stages.0.blocks.0.norm2.bias', 'rgb_stages.0.blocks.0.mlp.fc1.weight', 'rgb_stages.0.blocks.0.mlp.fc1.bias', 'rgb_stages.0.blocks.0.mlp.fc2.weight', 'rgb_stages.0.blocks.0.mlp.fc2.bias', 'rgb_stages.0.blocks.1.norm1.weight', 'rgb_stages.0.blocks.1.norm1.bias', 'rgb_stages.0.blocks.1.attn.qkv.weight', 'rgb_stages.0.blocks.1.attn.qkv.bias', 'rgb_stages.0.blocks.1.attn.proj.weight', 'rgb_stages.0.blocks.1.attn.proj.bias', 'rgb_stages.0.blocks.1.norm2.weight', 'rgb_stages.0.blocks.1.norm2.bias', 'rgb_stages.0.blocks.1.mlp.fc1.weight', 'rgb_stages.0.blocks.1.mlp.fc1.bias', 'rgb_stages.0.blocks.1.mlp.fc2.weight', 'rgb_stages.0.blocks.1.mlp.fc2.bias', 'rgb_stages.0.blocks.2.norm1.weight', 'rgb_stages.0.blocks.2.norm1.bias', 'rgb_stages.0.blocks.2.attn.qkv.weight', 'rgb_stages.0.blocks.2.attn.qkv.bias', 'rgb_stages.0.blocks.2.attn.proj.weight', 'rgb_stages.0.blocks.2.attn.proj.bias', 'rgb_stages.0.blocks.2.norm2.weight', 'rgb_stages.0.blocks.2.norm2.bias', 'rgb_stages.0.blocks.2.mlp.fc1.weight', 'rgb_stages.0.blocks.2.mlp.fc1.bias', 'rgb_stages.0.blocks.2.mlp.fc2.weight', 'rgb_stages.0.blocks.2.mlp.fc2.bias', 'rgb_stages.0.downsample_layer.reduction.weight', 'rgb_stages.0.downsample_layer.norm.weight', 'rgb_stages.0.downsample_layer.norm.bias', 'rgb_stages.1.blocks.0.norm1.weight', 'rgb_stages.1.blocks.0.norm1.bias', 'rgb_stages.1.blocks.0.attn.qkv.weight', 'rgb_stages.1.blocks.0.attn.qkv.bias', 'rgb_stages.1.blocks.0.attn.proj.weight', 'rgb_stages.1.blocks.0.attn.proj.bias', 'rgb_stages.1.blocks.0.norm2.weight', 'rgb_stages.1.blocks.0.norm2.bias', 'rgb_stages.1.blocks.0.mlp.fc1.weight', 'rgb_stages.1.blocks.0.mlp.fc1.bias', 'rgb_stages.1.blocks.0.mlp.fc2.weight', 'rgb_stages.1.blocks.0.mlp.fc2.bias', 'rgb_stages.1.blocks.1.norm1.weight', 'rgb_stages.1.blocks.1.norm1.bias', 'rgb_stages.1.blocks.1.attn.qkv.weight', 'rgb_stages.1.blocks.1.attn.qkv.bias', 'rgb_stages.1.blocks.1.attn.proj.weight', 'rgb_stages.1.blocks.1.attn.proj.bias', 'rgb_stages.1.blocks.1.norm2.weight', 'rgb_stages.1.blocks.1.norm2.bias', 'rgb_stages.1.blocks.1.mlp.fc1.weight', 'rgb_stages.1.blocks.1.mlp.fc1.bias', 'rgb_stages.1.blocks.1.mlp.fc2.weight', 'rgb_stages.1.blocks.1.mlp.fc2.bias', 'rgb_stages.1.blocks.2.norm1.weight', 'rgb_stages.1.blocks.2.norm1.bias', 'rgb_stages.1.blocks.2.attn.qkv.weight', 'rgb_stages.1.blocks.2.attn.qkv.bias', 'rgb_stages.1.blocks.2.attn.proj.weight', 'rgb_stages.1.blocks.2.attn.proj.bias', 'rgb_stages.1.blocks.2.norm2.weight', 'rgb_stages.1.blocks.2.norm2.bias', 'rgb_stages.1.blocks.2.mlp.fc1.weight', 'rgb_stages.1.blocks.2.mlp.fc1.bias', 'rgb_stages.1.blocks.2.mlp.fc2.weight', 'rgb_stages.1.blocks.2.mlp.fc2.bias', 'rgb_stages.1.blocks.3.norm1.weight', 'rgb_stages.1.blocks.3.norm1.bias', 'rgb_stages.1.blocks.3.attn.qkv.weight', 'rgb_stages.1.blocks.3.attn.qkv.bias', 'rgb_stages.1.blocks.3.attn.proj.weight', 'rgb_stages.1.blocks.3.attn.proj.bias', 'rgb_stages.1.blocks.3.norm2.weight', 'rgb_stages.1.blocks.3.norm2.bias', 'rgb_stages.1.blocks.3.mlp.fc1.weight', 'rgb_stages.1.blocks.3.mlp.fc1.bias', 'rgb_stages.1.blocks.3.mlp.fc2.weight', 'rgb_stages.1.blocks.3.mlp.fc2.bias', 'rgb_stages.1.blocks.4.norm1.weight', 'rgb_stages.1.blocks.4.norm1.bias', 'rgb_stages.1.blocks.4.attn.qkv.weight', 'rgb_stages.1.blocks.4.attn.qkv.bias', 'rgb_stages.1.blocks.4.attn.proj.weight', 'rgb_stages.1.blocks.4.attn.proj.bias', 'rgb_stages.1.blocks.4.norm2.weight', 'rgb_stages.1.blocks.4.norm2.bias', 'rgb_stages.1.blocks.4.mlp.fc1.weight', 'rgb_stages.1.blocks.4.mlp.fc1.bias', 'rgb_stages.1.blocks.4.mlp.fc2.weight', 'rgb_stages.1.blocks.4.mlp.fc2.bias', 'rgb_stages.1.blocks.5.norm1.weight', 'rgb_stages.1.blocks.5.norm1.bias', 'rgb_stages.1.blocks.5.attn.qkv.weight', 'rgb_stages.1.blocks.5.attn.qkv.bias', 'rgb_stages.1.blocks.5.attn.proj.weight', 'rgb_stages.1.blocks.5.attn.proj.bias', 'rgb_stages.1.blocks.5.norm2.weight', 'rgb_stages.1.blocks.5.norm2.bias', 'rgb_stages.1.blocks.5.mlp.fc1.weight', 'rgb_stages.1.blocks.5.mlp.fc1.bias', 'rgb_stages.1.blocks.5.mlp.fc2.weight', 'rgb_stages.1.blocks.5.mlp.fc2.bias', 'rgb_stages.1.downsample_layer.reduction.weight', 'rgb_stages.1.downsample_layer.norm.weight', 'rgb_stages.1.downsample_layer.norm.bias', 'rgb_stages.2.blocks.0.norm1.weight', 'rgb_stages.2.blocks.0.norm1.bias', 'rgb_stages.2.blocks.0.attn.qkv.weight', 'rgb_stages.2.blocks.0.attn.qkv.bias', 'rgb_stages.2.blocks.0.attn.proj.weight', 'rgb_stages.2.blocks.0.attn.proj.bias', 'rgb_stages.2.blocks.0.norm2.weight', 'rgb_stages.2.blocks.0.norm2.bias', 'rgb_stages.2.blocks.0.mlp.fc1.weight', 'rgb_stages.2.blocks.0.mlp.fc1.bias', 'rgb_stages.2.blocks.0.mlp.fc2.weight', 'rgb_stages.2.blocks.0.mlp.fc2.bias', 'rgb_stages.2.blocks.1.norm1.weight', 'rgb_stages.2.blocks.1.norm1.bias', 'rgb_stages.2.blocks.1.attn.qkv.weight', 'rgb_stages.2.blocks.1.attn.qkv.bias', 'rgb_stages.2.blocks.1.attn.proj.weight', 'rgb_stages.2.blocks.1.attn.proj.bias', 'rgb_stages.2.blocks.1.norm2.weight', 'rgb_stages.2.blocks.1.norm2.bias', 'rgb_stages.2.blocks.1.mlp.fc1.weight', 'rgb_stages.2.blocks.1.mlp.fc1.bias', 'rgb_stages.2.blocks.1.mlp.fc2.weight', 'rgb_stages.2.blocks.1.mlp.fc2.bias', 'rgb_stages.2.blocks.2.norm1.weight', 'rgb_stages.2.blocks.2.norm1.bias', 'rgb_stages.2.blocks.2.attn.qkv.weight', 'rgb_stages.2.blocks.2.attn.qkv.bias', 'rgb_stages.2.blocks.2.attn.proj.weight', 'rgb_stages.2.blocks.2.attn.proj.bias', 'rgb_stages.2.blocks.2.norm2.weight', 'rgb_stages.2.blocks.2.norm2.bias', 'rgb_stages.2.blocks.2.mlp.fc1.weight', 'rgb_stages.2.blocks.2.mlp.fc1.bias', 'rgb_stages.2.blocks.2.mlp.fc2.weight', 'rgb_stages.2.blocks.2.mlp.fc2.bias', 'rgb_stages.2.blocks.3.norm1.weight', 'rgb_stages.2.blocks.3.norm1.bias', 'rgb_stages.2.blocks.3.attn.qkv.weight', 'rgb_stages.2.blocks.3.attn.qkv.bias', 'rgb_stages.2.blocks.3.attn.proj.weight', 'rgb_stages.2.blocks.3.attn.proj.bias', 'rgb_stages.2.blocks.3.norm2.weight', 'rgb_stages.2.blocks.3.norm2.bias', 'rgb_stages.2.blocks.3.mlp.fc1.weight', 'rgb_stages.2.blocks.3.mlp.fc1.bias', 'rgb_stages.2.blocks.3.mlp.fc2.weight', 'rgb_stages.2.blocks.3.mlp.fc2.bias', 'rgb_stages.2.blocks.4.norm1.weight', 'rgb_stages.2.blocks.4.norm1.bias', 'rgb_stages.2.blocks.4.attn.qkv.weight', 'rgb_stages.2.blocks.4.attn.qkv.bias', 'rgb_stages.2.blocks.4.attn.proj.weight', 'rgb_stages.2.blocks.4.attn.proj.bias', 'rgb_stages.2.blocks.4.norm2.weight', 'rgb_stages.2.blocks.4.norm2.bias', 'rgb_stages.2.blocks.4.mlp.fc1.weight', 'rgb_stages.2.blocks.4.mlp.fc1.bias', 'rgb_stages.2.blocks.4.mlp.fc2.weight', 'rgb_stages.2.blocks.4.mlp.fc2.bias', 'rgb_stages.2.blocks.5.norm1.weight', 'rgb_stages.2.blocks.5.norm1.bias', 'rgb_stages.2.blocks.5.attn.qkv.weight', 'rgb_stages.2.blocks.5.attn.qkv.bias', 'rgb_stages.2.blocks.5.attn.proj.weight', 'rgb_stages.2.blocks.5.attn.proj.bias', 'rgb_stages.2.blocks.5.norm2.weight', 'rgb_stages.2.blocks.5.norm2.bias', 'rgb_stages.2.blocks.5.mlp.fc1.weight', 'rgb_stages.2.blocks.5.mlp.fc1.bias', 'rgb_stages.2.blocks.5.mlp.fc2.weight', 'rgb_stages.2.blocks.5.mlp.fc2.bias', 'rgb_stages.2.blocks.6.norm1.weight', 'rgb_stages.2.blocks.6.norm1.bias', 'rgb_stages.2.blocks.6.attn.qkv.weight', 'rgb_stages.2.blocks.6.attn.qkv.bias', 'rgb_stages.2.blocks.6.attn.proj.weight', 'rgb_stages.2.blocks.6.attn.proj.bias', 'rgb_stages.2.blocks.6.norm2.weight', 'rgb_stages.2.blocks.6.norm2.bias', 'rgb_stages.2.blocks.6.mlp.fc1.weight', 'rgb_stages.2.blocks.6.mlp.fc1.bias', 'rgb_stages.2.blocks.6.mlp.fc2.weight', 'rgb_stages.2.blocks.6.mlp.fc2.bias', 'rgb_stages.2.blocks.7.norm1.weight', 'rgb_stages.2.blocks.7.norm1.bias', 'rgb_stages.2.blocks.7.attn.qkv.weight', 'rgb_stages.2.blocks.7.attn.qkv.bias', 'rgb_stages.2.blocks.7.attn.proj.weight', 'rgb_stages.2.blocks.7.attn.proj.bias', 'rgb_stages.2.blocks.7.norm2.weight', 'rgb_stages.2.blocks.7.norm2.bias', 'rgb_stages.2.blocks.7.mlp.fc1.weight', 'rgb_stages.2.blocks.7.mlp.fc1.bias', 'rgb_stages.2.blocks.7.mlp.fc2.weight', 'rgb_stages.2.blocks.7.mlp.fc2.bias', 'rgb_stages.2.blocks.8.norm1.weight', 'rgb_stages.2.blocks.8.norm1.bias', 'rgb_stages.2.blocks.8.attn.qkv.weight', 'rgb_stages.2.blocks.8.attn.qkv.bias', 'rgb_stages.2.blocks.8.attn.proj.weight', 'rgb_stages.2.blocks.8.attn.proj.bias', 'rgb_stages.2.blocks.8.norm2.weight', 'rgb_stages.2.blocks.8.norm2.bias', 'rgb_stages.2.blocks.8.mlp.fc1.weight', 'rgb_stages.2.blocks.8.mlp.fc1.bias', 'rgb_stages.2.blocks.8.mlp.fc2.weight', 'rgb_stages.2.blocks.8.mlp.fc2.bias', 'rgb_stages.2.blocks.9.norm1.weight', 'rgb_stages.2.blocks.9.norm1.bias', 'rgb_stages.2.blocks.9.attn.qkv.weight', 'rgb_stages.2.blocks.9.attn.qkv.bias', 'rgb_stages.2.blocks.9.attn.proj.weight', 'rgb_stages.2.blocks.9.attn.proj.bias', 'rgb_stages.2.blocks.9.norm2.weight', 'rgb_stages.2.blocks.9.norm2.bias', 'rgb_stages.2.blocks.9.mlp.fc1.weight', 'rgb_stages.2.blocks.9.mlp.fc1.bias', 'rgb_stages.2.blocks.9.mlp.fc2.weight', 'rgb_stages.2.blocks.9.mlp.fc2.bias', 'rgb_stages.2.blocks.10.norm1.weight', 'rgb_stages.2.blocks.10.norm1.bias', 'rgb_stages.2.blocks.10.attn.qkv.weight', 'rgb_stages.2.blocks.10.attn.qkv.bias', 'rgb_stages.2.blocks.10.attn.proj.weight', 'rgb_stages.2.blocks.10.attn.proj.bias', 'rgb_stages.2.blocks.10.norm2.weight', 'rgb_stages.2.blocks.10.norm2.bias', 'rgb_stages.2.blocks.10.mlp.fc1.weight', 'rgb_stages.2.blocks.10.mlp.fc1.bias', 'rgb_stages.2.blocks.10.mlp.fc2.weight', 'rgb_stages.2.blocks.10.mlp.fc2.bias', 'rgb_stages.2.blocks.11.norm1.weight', 'rgb_stages.2.blocks.11.norm1.bias', 'rgb_stages.2.blocks.11.attn.qkv.weight', 'rgb_stages.2.blocks.11.attn.qkv.bias', 'rgb_stages.2.blocks.11.attn.proj.weight', 'rgb_stages.2.blocks.11.attn.proj.bias', 'rgb_stages.2.blocks.11.norm2.weight', 'rgb_stages.2.blocks.11.norm2.bias', 'rgb_stages.2.blocks.11.mlp.fc1.weight', 'rgb_stages.2.blocks.11.mlp.fc1.bias', 'rgb_stages.2.blocks.11.mlp.fc2.weight', 'rgb_stages.2.blocks.11.mlp.fc2.bias', 'rgb_stages.2.blocks.12.norm1.weight', 'rgb_stages.2.blocks.12.norm1.bias', 'rgb_stages.2.blocks.12.attn.qkv.weight', 'rgb_stages.2.blocks.12.attn.qkv.bias', 'rgb_stages.2.blocks.12.attn.proj.weight', 'rgb_stages.2.blocks.12.attn.proj.bias', 'rgb_stages.2.blocks.12.norm2.weight', 'rgb_stages.2.blocks.12.norm2.bias', 'rgb_stages.2.blocks.12.mlp.fc1.weight', 'rgb_stages.2.blocks.12.mlp.fc1.bias', 'rgb_stages.2.blocks.12.mlp.fc2.weight', 'rgb_stages.2.blocks.12.mlp.fc2.bias', 'rgb_stages.2.blocks.13.norm1.weight', 'rgb_stages.2.blocks.13.norm1.bias', 'rgb_stages.2.blocks.13.attn.qkv.weight', 'rgb_stages.2.blocks.13.attn.qkv.bias', 'rgb_stages.2.blocks.13.attn.proj.weight', 'rgb_stages.2.blocks.13.attn.proj.bias', 'rgb_stages.2.blocks.13.norm2.weight', 'rgb_stages.2.blocks.13.norm2.bias', 'rgb_stages.2.blocks.13.mlp.fc1.weight', 'rgb_stages.2.blocks.13.mlp.fc1.bias', 'rgb_stages.2.blocks.13.mlp.fc2.weight', 'rgb_stages.2.blocks.13.mlp.fc2.bias', 'rgb_stages.2.blocks.14.norm1.weight', 'rgb_stages.2.blocks.14.norm1.bias', 'rgb_stages.2.blocks.14.attn.qkv.weight', 'rgb_stages.2.blocks.14.attn.qkv.bias', 'rgb_stages.2.blocks.14.attn.proj.weight', 'rgb_stages.2.blocks.14.attn.proj.bias', 'rgb_stages.2.blocks.14.norm2.weight', 'rgb_stages.2.blocks.14.norm2.bias', 'rgb_stages.2.blocks.14.mlp.fc1.weight', 'rgb_stages.2.blocks.14.mlp.fc1.bias', 'rgb_stages.2.blocks.14.mlp.fc2.weight', 'rgb_stages.2.blocks.14.mlp.fc2.bias', 'rgb_stages.2.blocks.15.norm1.weight', 'rgb_stages.2.blocks.15.norm1.bias', 'rgb_stages.2.blocks.15.attn.qkv.weight', 'rgb_stages.2.blocks.15.attn.qkv.bias', 'rgb_stages.2.blocks.15.attn.proj.weight', 'rgb_stages.2.blocks.15.attn.proj.bias', 'rgb_stages.2.blocks.15.norm2.weight', 'rgb_stages.2.blocks.15.norm2.bias', 'rgb_stages.2.blocks.15.mlp.fc1.weight', 'rgb_stages.2.blocks.15.mlp.fc1.bias', 'rgb_stages.2.blocks.15.mlp.fc2.weight', 'rgb_stages.2.blocks.15.mlp.fc2.bias', 'rgb_stages.2.blocks.16.norm1.weight', 'rgb_stages.2.blocks.16.norm1.bias', 'rgb_stages.2.blocks.16.attn.qkv.weight', 'rgb_stages.2.blocks.16.attn.qkv.bias', 'rgb_stages.2.blocks.16.attn.proj.weight', 'rgb_stages.2.blocks.16.attn.proj.bias', 'rgb_stages.2.blocks.16.norm2.weight', 'rgb_stages.2.blocks.16.norm2.bias', 'rgb_stages.2.blocks.16.mlp.fc1.weight', 'rgb_stages.2.blocks.16.mlp.fc1.bias', 'rgb_stages.2.blocks.16.mlp.fc2.weight', 'rgb_stages.2.blocks.16.mlp.fc2.bias', 'rgb_stages.2.blocks.17.norm1.weight', 'rgb_stages.2.blocks.17.norm1.bias', 'rgb_stages.2.blocks.17.attn.qkv.weight', 'rgb_stages.2.blocks.17.attn.qkv.bias', 'rgb_stages.2.blocks.17.attn.proj.weight', 'rgb_stages.2.blocks.17.attn.proj.bias', 'rgb_stages.2.blocks.17.norm2.weight', 'rgb_stages.2.blocks.17.norm2.bias', 'rgb_stages.2.blocks.17.mlp.fc1.weight', 'rgb_stages.2.blocks.17.mlp.fc1.bias', 'rgb_stages.2.blocks.17.mlp.fc2.weight', 'rgb_stages.2.blocks.17.mlp.fc2.bias', 'rgb_stages.2.blocks.18.norm1.weight', 'rgb_stages.2.blocks.18.norm1.bias', 'rgb_stages.2.blocks.18.attn.qkv.weight', 'rgb_stages.2.blocks.18.attn.qkv.bias', 'rgb_stages.2.blocks.18.attn.proj.weight', 'rgb_stages.2.blocks.18.attn.proj.bias', 'rgb_stages.2.blocks.18.norm2.weight', 'rgb_stages.2.blocks.18.norm2.bias', 'rgb_stages.2.blocks.18.mlp.fc1.weight', 'rgb_stages.2.blocks.18.mlp.fc1.bias', 'rgb_stages.2.blocks.18.mlp.fc2.weight', 'rgb_stages.2.blocks.18.mlp.fc2.bias', 'rgb_stages.2.blocks.19.norm1.weight', 'rgb_stages.2.blocks.19.norm1.bias', 'rgb_stages.2.blocks.19.attn.qkv.weight', 'rgb_stages.2.blocks.19.attn.qkv.bias', 'rgb_stages.2.blocks.19.attn.proj.weight', 'rgb_stages.2.blocks.19.attn.proj.bias', 'rgb_stages.2.blocks.19.norm2.weight', 'rgb_stages.2.blocks.19.norm2.bias', 'rgb_stages.2.blocks.19.mlp.fc1.weight', 'rgb_stages.2.blocks.19.mlp.fc1.bias', 'rgb_stages.2.blocks.19.mlp.fc2.weight', 'rgb_stages.2.blocks.19.mlp.fc2.bias', 'rgb_stages.2.blocks.20.norm1.weight', 'rgb_stages.2.blocks.20.norm1.bias', 'rgb_stages.2.blocks.20.attn.qkv.weight', 'rgb_stages.2.blocks.20.attn.qkv.bias', 'rgb_stages.2.blocks.20.attn.proj.weight', 'rgb_stages.2.blocks.20.attn.proj.bias', 'rgb_stages.2.blocks.20.norm2.weight', 'rgb_stages.2.blocks.20.norm2.bias', 'rgb_stages.2.blocks.20.mlp.fc1.weight', 'rgb_stages.2.blocks.20.mlp.fc1.bias', 'rgb_stages.2.blocks.20.mlp.fc2.weight', 'rgb_stages.2.blocks.20.mlp.fc2.bias', 'rgb_stages.2.blocks.21.norm1.weight', 'rgb_stages.2.blocks.21.norm1.bias', 'rgb_stages.2.blocks.21.attn.qkv.weight', 'rgb_stages.2.blocks.21.attn.qkv.bias', 'rgb_stages.2.blocks.21.attn.proj.weight', 'rgb_stages.2.blocks.21.attn.proj.bias', 'rgb_stages.2.blocks.21.norm2.weight', 'rgb_stages.2.blocks.21.norm2.bias', 'rgb_stages.2.blocks.21.mlp.fc1.weight', 'rgb_stages.2.blocks.21.mlp.fc1.bias', 'rgb_stages.2.blocks.21.mlp.fc2.weight', 'rgb_stages.2.blocks.21.mlp.fc2.bias', 'rgb_stages.2.blocks.22.norm1.weight', 'rgb_stages.2.blocks.22.norm1.bias', 'rgb_stages.2.blocks.22.attn.qkv.weight', 'rgb_stages.2.blocks.22.attn.qkv.bias', 'rgb_stages.2.blocks.22.attn.proj.weight', 'rgb_stages.2.blocks.22.attn.proj.bias', 'rgb_stages.2.blocks.22.norm2.weight', 'rgb_stages.2.blocks.22.norm2.bias', 'rgb_stages.2.blocks.22.mlp.fc1.weight', 'rgb_stages.2.blocks.22.mlp.fc1.bias', 'rgb_stages.2.blocks.22.mlp.fc2.weight', 'rgb_stages.2.blocks.22.mlp.fc2.bias', 'rgb_stages.2.blocks.23.norm1.weight', 'rgb_stages.2.blocks.23.norm1.bias', 'rgb_stages.2.blocks.23.attn.qkv.weight', 'rgb_stages.2.blocks.23.attn.qkv.bias', 'rgb_stages.2.blocks.23.attn.proj.weight', 'rgb_stages.2.blocks.23.attn.proj.bias', 'rgb_stages.2.blocks.23.norm2.weight', 'rgb_stages.2.blocks.23.norm2.bias', 'rgb_stages.2.blocks.23.mlp.fc1.weight', 'rgb_stages.2.blocks.23.mlp.fc1.bias', 'rgb_stages.2.blocks.23.mlp.fc2.weight', 'rgb_stages.2.blocks.23.mlp.fc2.bias', 'rgb_stages.2.downsample_layer.reduction.weight', 'rgb_stages.2.downsample_layer.norm.weight', 'rgb_stages.2.downsample_layer.norm.bias', 'rgb_stages.3.blocks.0.norm1.weight', 'rgb_stages.3.blocks.0.norm1.bias', 'rgb_stages.3.blocks.0.attn.qkv.weight', 'rgb_stages.3.blocks.0.attn.qkv.bias', 'rgb_stages.3.blocks.0.attn.proj.weight', 'rgb_stages.3.blocks.0.attn.proj.bias', 'rgb_stages.3.blocks.0.norm2.weight', 'rgb_stages.3.blocks.0.norm2.bias', 'rgb_stages.3.blocks.0.mlp.fc1.weight', 'rgb_stages.3.blocks.0.mlp.fc1.bias', 'rgb_stages.3.blocks.0.mlp.fc2.weight', 'rgb_stages.3.blocks.0.mlp.fc2.bias', 'rgb_stages.3.blocks.1.norm1.weight', 'rgb_stages.3.blocks.1.norm1.bias', 'rgb_stages.3.blocks.1.attn.qkv.weight', 'rgb_stages.3.blocks.1.attn.qkv.bias', 'rgb_stages.3.blocks.1.attn.proj.weight', 'rgb_stages.3.blocks.1.attn.proj.bias', 'rgb_stages.3.blocks.1.norm2.weight', 'rgb_stages.3.blocks.1.norm2.bias', 'rgb_stages.3.blocks.1.mlp.fc1.weight', 'rgb_stages.3.blocks.1.mlp.fc1.bias', 'rgb_stages.3.blocks.1.mlp.fc2.weight', 'rgb_stages.3.blocks.1.mlp.fc2.bias', 'rgb_stages.3.blocks.2.norm1.weight', 'rgb_stages.3.blocks.2.norm1.bias', 'rgb_stages.3.blocks.2.attn.qkv.weight', 'rgb_stages.3.blocks.2.attn.qkv.bias', 'rgb_stages.3.blocks.2.attn.proj.weight', 'rgb_stages.3.blocks.2.attn.proj.bias', 'rgb_stages.3.blocks.2.norm2.weight', 'rgb_stages.3.blocks.2.norm2.bias', 'rgb_stages.3.blocks.2.mlp.fc1.weight', 'rgb_stages.3.blocks.2.mlp.fc1.bias', 'rgb_stages.3.blocks.2.mlp.fc2.weight', 'rgb_stages.3.blocks.2.mlp.fc2.bias', 'norm_rgb_final_encoder.weight', 'norm_rgb_final_encoder.bias', 'classifier_head_norm.weight', 'classifier_head_norm.bias', 'classifier_head.weight', 'classifier_head.bias']
2025-05-30 06:00:18 - __main__ - INFO - [resume_from_checkpoint:70] - Checkpoint appears to be a raw model state dictionary.
2025-05-30 06:00:18 - __main__ - INFO - [resume_from_checkpoint:82] - Loaded model state from checkpoint.
2025-05-30 06:00:18 - __main__ - WARNING - [resume_from_checkpoint:91] - Optimizer state not loaded.
2025-05-30 06:00:18 - __main__ - WARNING - [resume_from_checkpoint:97] - GradScaler state not loaded.
2025-05-30 06:00:18 - __main__ - INFO - [resume_from_checkpoint:112] - Resuming from epoch 1. Best metric: 0.0000. Last scheduler step: -1
2025-05-30 06:00:18 - __main__ - INFO - [main_execution_logic:222] - Model moved to device: cuda. Total params: 273,615,751
2025-05-30 06:00:18 - __main__ - INFO - [main_execution_logic:235] - Scheduler initialized: WarmupCosine. Warmup steps: 265, Total steps: 5300
2025-05-30 06:00:18 - phase4_finetuning.utils.augmentations - INFO - [__init__:39] - FinetuneAugmentation initialized with basic augmentation pipeline.
2025-05-30 06:00:18 - __main__ - INFO - [main_execution_logic:241] - Using augmentation: FinetuneAugmentation.
2025-05-30 06:00:18 - phase4_finetuning.finetune.trainer - INFO - [__init__:53] - Finetuner initialized: device=cuda, accum_steps=2, AMP=True
2025-05-30 06:00:18 - phase4_finetuning.finetune.trainer - INFO - [__init__:55] - Using training augmentations: FinetuneAugmentation
2025-05-30 06:00:18 - __main__ - INFO - [main_execution_logic:265] - Checkpoints will be saved in: /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/ft_resume_s7_20250530_060011/checkpoints
2025-05-30 06:00:18 - __main__ - INFO - [main_execution_logic:271] - Starting fine-tuning from epoch 1 for 100 total epochs.
2025-05-30 06:00:18 - __main__ - INFO - [main_execution_logic:284] - Epoch 1: head LR set to 5.00e-05
2025-05-30 06:00:18 - __main__ - INFO - [main_execution_logic:284] - Epoch 1: backbone LR set to 0.00e+00
2025-05-30 06:00:22 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B1: Scheduler step after optimizer step.
2025-05-30 06:00:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B3: Scheduler step after optimizer step.
2025-05-30 06:00:24 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B5: Scheduler step after optimizer step.
2025-05-30 06:00:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B7: Scheduler step after optimizer step.
2025-05-30 06:00:26 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B9: Scheduler step after optimizer step.
2025-05-30 06:00:27 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B11: Scheduler step after optimizer step.
2025-05-30 06:00:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B13: Scheduler step after optimizer step.
2025-05-30 06:00:29 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B15: Scheduler step after optimizer step.
2025-05-30 06:00:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B17: Scheduler step after optimizer step.
2025-05-30 06:00:31 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B19: Scheduler step after optimizer step.
2025-05-30 06:00:32 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B21: Scheduler step after optimizer step.
2025-05-30 06:00:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B23: Scheduler step after optimizer step.
2025-05-30 06:00:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B25: Scheduler step after optimizer step.
2025-05-30 06:00:35 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B27: Scheduler step after optimizer step.
2025-05-30 06:00:36 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B29: Scheduler step after optimizer step.
2025-05-30 06:00:37 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B31: Scheduler step after optimizer step.
2025-05-30 06:00:38 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B33: Scheduler step after optimizer step.
2025-05-30 06:00:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B35: Scheduler step after optimizer step.
2025-05-30 06:00:40 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B37: Scheduler step after optimizer step.
2025-05-30 06:00:41 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B39: Scheduler step after optimizer step.
2025-05-30 06:00:42 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B41: Scheduler step after optimizer step.
2025-05-30 06:00:43 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B43: Scheduler step after optimizer step.
2025-05-30 06:00:44 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B45: Scheduler step after optimizer step.
2025-05-30 06:00:44 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B47: Scheduler step after optimizer step.
2025-05-30 06:00:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B49: Scheduler step after optimizer step.
2025-05-30 06:00:46 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B51: Scheduler step after optimizer step.
2025-05-30 06:00:47 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B53: Scheduler step after optimizer step.
2025-05-30 06:00:48 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B55: Scheduler step after optimizer step.
2025-05-30 06:00:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B57: Scheduler step after optimizer step.
2025-05-30 06:00:50 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B59: Scheduler step after optimizer step.
2025-05-30 06:00:51 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B61: Scheduler step after optimizer step.
2025-05-30 06:00:52 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B63: Scheduler step after optimizer step.
2025-05-30 06:00:53 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B65: Scheduler step after optimizer step.
2025-05-30 06:00:54 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B67: Scheduler step after optimizer step.
2025-05-30 06:00:55 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B69: Scheduler step after optimizer step.
2025-05-30 06:00:56 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B71: Scheduler step after optimizer step.
2025-05-30 06:00:57 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B73: Scheduler step after optimizer step.
2025-05-30 06:00:58 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B75: Scheduler step after optimizer step.
2025-05-30 06:00:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B77: Scheduler step after optimizer step.
2025-05-30 06:01:00 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B79: Scheduler step after optimizer step.
2025-05-30 06:01:01 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B81: Scheduler step after optimizer step.
2025-05-30 06:01:02 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B83: Scheduler step after optimizer step.
2025-05-30 06:01:03 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B85: Scheduler step after optimizer step.
2025-05-30 06:01:04 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B87: Scheduler step after optimizer step.
2025-05-30 06:01:05 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B89: Scheduler step after optimizer step.
2025-05-30 06:01:06 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B91: Scheduler step after optimizer step.
2025-05-30 06:01:06 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B93: Scheduler step after optimizer step.
2025-05-30 06:01:07 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B95: Scheduler step after optimizer step.
2025-05-30 06:01:08 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B97: Scheduler step after optimizer step.
2025-05-30 06:01:09 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B99: Scheduler step after optimizer step.
2025-05-30 06:01:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B101: Scheduler step after optimizer step.
2025-05-30 06:01:11 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B103: Scheduler step after optimizer step.
2025-05-30 06:01:12 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E1 B105: Scheduler step after optimizer step.
2025-05-30 06:01:12 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:163] - Epoch 1 training finished. Avg Loss: 0.8214, Final LR: 1.00e-05, Opt Steps: 53, NaN count: 0
2025-05-30 06:01:18 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8619, accuracy: 0.8014, f1_macro: 0.8028, f1_weighted: 0.8044, precision_macro: 0.7944, precision_weighted: 0.8348, recall_macro: 0.8354, recall_weighted: 0.8014, f1_Bacterial_Blight: 0.6549, f1_Curl_Virus: 0.7786, f1_Healthy_Leaf: 0.8288, f1_Herbicide_Growth_Damage: 0.9048, f1_Leaf_Hopper_Jassids: 0.7619, f1_Leaf_Redding: 0.8155, f1_Leaf_Variegation: 0.8750
2025-05-30 06:01:23 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:252] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/ft_resume_s7_20250530_060011/checkpoints/best_finetuned_hvt_resumed.pth with metadata (epoch=1, best_metric=0.8027889552733801)
2025-05-30 06:01:23 - __main__ - INFO - [main_execution_logic:306] - Epoch 1: New best f1_macro: 0.8028
2025-05-30 06:01:23 - __main__ - INFO - [main_execution_logic:316] - Epoch 1 completed in 64.99 seconds.
2025-05-30 06:01:23 - __main__ - INFO - [main_execution_logic:284] - Epoch 2: head LR set to 5.00e-05
2025-05-30 06:01:23 - __main__ - INFO - [main_execution_logic:284] - Epoch 2: backbone LR set to 0.00e+00
2025-05-30 06:01:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B1: Scheduler step after optimizer step.
2025-05-30 06:01:26 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B3: Scheduler step after optimizer step.
2025-05-30 06:01:27 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B5: Scheduler step after optimizer step.
2025-05-30 06:01:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B7: Scheduler step after optimizer step.
2025-05-30 06:01:29 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B9: Scheduler step after optimizer step.
2025-05-30 06:01:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B11: Scheduler step after optimizer step.
2025-05-30 06:01:31 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B13: Scheduler step after optimizer step.
2025-05-30 06:01:32 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B15: Scheduler step after optimizer step.
2025-05-30 06:01:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B17: Scheduler step after optimizer step.
2025-05-30 06:01:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B19: Scheduler step after optimizer step.
2025-05-30 06:01:35 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B21: Scheduler step after optimizer step.
2025-05-30 06:01:36 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B23: Scheduler step after optimizer step.
2025-05-30 06:01:37 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B25: Scheduler step after optimizer step.
2025-05-30 06:01:38 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B27: Scheduler step after optimizer step.
2025-05-30 06:01:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B29: Scheduler step after optimizer step.
2025-05-30 06:01:40 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B31: Scheduler step after optimizer step.
2025-05-30 06:01:41 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B33: Scheduler step after optimizer step.
2025-05-30 06:01:42 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B35: Scheduler step after optimizer step.
2025-05-30 06:01:43 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B37: Scheduler step after optimizer step.
2025-05-30 06:01:44 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B39: Scheduler step after optimizer step.
2025-05-30 06:01:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B41: Scheduler step after optimizer step.
2025-05-30 06:01:46 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B43: Scheduler step after optimizer step.
2025-05-30 06:01:47 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B45: Scheduler step after optimizer step.
2025-05-30 06:01:48 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B47: Scheduler step after optimizer step.
2025-05-30 06:01:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B49: Scheduler step after optimizer step.
2025-05-30 06:01:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B51: Scheduler step after optimizer step.
2025-05-30 06:01:50 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B53: Scheduler step after optimizer step.
2025-05-30 06:01:51 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B55: Scheduler step after optimizer step.
2025-05-30 06:01:52 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B57: Scheduler step after optimizer step.
2025-05-30 06:01:53 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B59: Scheduler step after optimizer step.
2025-05-30 06:01:54 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B61: Scheduler step after optimizer step.
2025-05-30 06:01:55 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B63: Scheduler step after optimizer step.
2025-05-30 06:01:56 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B65: Scheduler step after optimizer step.
2025-05-30 06:01:57 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B67: Scheduler step after optimizer step.
2025-05-30 06:01:58 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B69: Scheduler step after optimizer step.
2025-05-30 06:01:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B71: Scheduler step after optimizer step.
2025-05-30 06:02:00 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B73: Scheduler step after optimizer step.
2025-05-30 06:02:01 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B75: Scheduler step after optimizer step.
2025-05-30 06:02:02 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B77: Scheduler step after optimizer step.
2025-05-30 06:02:03 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B79: Scheduler step after optimizer step.
2025-05-30 06:02:04 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B81: Scheduler step after optimizer step.
2025-05-30 06:02:05 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B83: Scheduler step after optimizer step.
2025-05-30 06:02:06 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B85: Scheduler step after optimizer step.
2025-05-30 06:02:07 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B87: Scheduler step after optimizer step.
2025-05-30 06:02:08 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B89: Scheduler step after optimizer step.
2025-05-30 06:02:09 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B91: Scheduler step after optimizer step.
2025-05-30 06:02:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B93: Scheduler step after optimizer step.
2025-05-30 06:02:11 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B95: Scheduler step after optimizer step.
2025-05-30 06:02:12 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B97: Scheduler step after optimizer step.
2025-05-30 06:02:12 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B99: Scheduler step after optimizer step.
2025-05-30 06:02:13 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B101: Scheduler step after optimizer step.
2025-05-30 06:02:14 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B103: Scheduler step after optimizer step.
2025-05-30 06:02:15 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E2 B105: Scheduler step after optimizer step.
2025-05-30 06:02:15 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:163] - Epoch 2 training finished. Avg Loss: 0.8225, Final LR: 2.00e-05, Opt Steps: 53, NaN count: 0
2025-05-30 06:02:20 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8901, accuracy: 0.7734, f1_macro: 0.7785, f1_weighted: 0.7735, precision_macro: 0.7714, precision_weighted: 0.8097, recall_macro: 0.8172, recall_weighted: 0.7734, f1_Bacterial_Blight: 0.6607, f1_Curl_Virus: 0.7143, f1_Healthy_Leaf: 0.7931, f1_Herbicide_Growth_Damage: 0.8889, f1_Leaf_Hopper_Jassids: 0.7455, f1_Leaf_Redding: 0.7723, f1_Leaf_Variegation: 0.8750
2025-05-30 06:02:20 - __main__ - INFO - [main_execution_logic:310] - Epoch 2: f1_macro (0.7785) not improved. Patience: 1/20
2025-05-30 06:02:20 - __main__ - INFO - [main_execution_logic:316] - Epoch 2 completed in 56.90 seconds.
2025-05-30 06:02:20 - __main__ - INFO - [main_execution_logic:284] - Epoch 3: head LR set to 5.00e-05
2025-05-30 06:02:20 - __main__ - INFO - [main_execution_logic:284] - Epoch 3: backbone LR set to 0.00e+00
2025-05-30 06:02:22 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B1: Scheduler step after optimizer step.
2025-05-30 06:02:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B3: Scheduler step after optimizer step.
2025-05-30 06:02:24 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B5: Scheduler step after optimizer step.
2025-05-30 06:02:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B7: Scheduler step after optimizer step.
2025-05-30 06:02:26 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B9: Scheduler step after optimizer step.
2025-05-30 06:02:27 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B11: Scheduler step after optimizer step.
2025-05-30 06:02:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B13: Scheduler step after optimizer step.
2025-05-30 06:02:29 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B15: Scheduler step after optimizer step.
2025-05-30 06:02:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B17: Scheduler step after optimizer step.
2025-05-30 06:02:31 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B19: Scheduler step after optimizer step.
2025-05-30 06:02:32 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B21: Scheduler step after optimizer step.
2025-05-30 06:02:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B23: Scheduler step after optimizer step.
2025-05-30 06:02:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B25: Scheduler step after optimizer step.
2025-05-30 06:02:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B27: Scheduler step after optimizer step.
2025-05-30 06:02:35 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B29: Scheduler step after optimizer step.
2025-05-30 06:02:36 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B31: Scheduler step after optimizer step.
2025-05-30 06:02:37 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B33: Scheduler step after optimizer step.
2025-05-30 06:02:38 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B35: Scheduler step after optimizer step.
2025-05-30 06:02:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B37: Scheduler step after optimizer step.
2025-05-30 06:02:40 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B39: Scheduler step after optimizer step.
2025-05-30 06:02:41 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B41: Scheduler step after optimizer step.
2025-05-30 06:02:42 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B43: Scheduler step after optimizer step.
2025-05-30 06:02:43 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B45: Scheduler step after optimizer step.
2025-05-30 06:02:44 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B47: Scheduler step after optimizer step.
2025-05-30 06:02:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B49: Scheduler step after optimizer step.
2025-05-30 06:02:46 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B51: Scheduler step after optimizer step.
2025-05-30 06:02:47 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B53: Scheduler step after optimizer step.
2025-05-30 06:02:48 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B55: Scheduler step after optimizer step.
2025-05-30 06:02:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B57: Scheduler step after optimizer step.
2025-05-30 06:02:50 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B59: Scheduler step after optimizer step.
2025-05-30 06:02:52 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B61: Scheduler step after optimizer step.
2025-05-30 06:02:53 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B63: Scheduler step after optimizer step.
2025-05-30 06:02:54 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B65: Scheduler step after optimizer step.
2025-05-30 06:02:55 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B67: Scheduler step after optimizer step.
2025-05-30 06:02:56 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B69: Scheduler step after optimizer step.
2025-05-30 06:02:57 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B71: Scheduler step after optimizer step.
2025-05-30 06:02:57 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B73: Scheduler step after optimizer step.
2025-05-30 06:02:58 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B75: Scheduler step after optimizer step.
2025-05-30 06:02:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B77: Scheduler step after optimizer step.
2025-05-30 06:03:00 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B79: Scheduler step after optimizer step.
2025-05-30 06:03:01 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B81: Scheduler step after optimizer step.
2025-05-30 06:03:02 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B83: Scheduler step after optimizer step.
2025-05-30 06:03:03 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B85: Scheduler step after optimizer step.
2025-05-30 06:03:04 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B87: Scheduler step after optimizer step.
2025-05-30 06:03:05 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B89: Scheduler step after optimizer step.
2025-05-30 06:03:06 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B91: Scheduler step after optimizer step.
2025-05-30 06:03:07 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B93: Scheduler step after optimizer step.
2025-05-30 06:03:08 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B95: Scheduler step after optimizer step.
2025-05-30 06:03:09 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B97: Scheduler step after optimizer step.
2025-05-30 06:03:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B99: Scheduler step after optimizer step.
2025-05-30 06:03:11 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B101: Scheduler step after optimizer step.
2025-05-30 06:03:12 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B103: Scheduler step after optimizer step.
2025-05-30 06:03:13 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E3 B105: Scheduler step after optimizer step.
2025-05-30 06:03:13 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:163] - Epoch 3 training finished. Avg Loss: 0.8130, Final LR: 3.00e-05, Opt Steps: 53, NaN count: 0
2025-05-30 06:03:18 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8957, accuracy: 0.7664, f1_macro: 0.7770, f1_weighted: 0.7692, precision_macro: 0.7796, precision_weighted: 0.8145, recall_macro: 0.8119, recall_weighted: 0.7664, f1_Bacterial_Blight: 0.6129, f1_Curl_Virus: 0.6992, f1_Healthy_Leaf: 0.7759, f1_Herbicide_Growth_Damage: 0.9048, f1_Leaf_Hopper_Jassids: 0.7619, f1_Leaf_Redding: 0.7662, f1_Leaf_Variegation: 0.9180
2025-05-30 06:03:18 - __main__ - INFO - [main_execution_logic:310] - Epoch 3: f1_macro (0.7770) not improved. Patience: 2/20
2025-05-30 06:03:18 - __main__ - INFO - [main_execution_logic:316] - Epoch 3 completed in 57.38 seconds.
2025-05-30 06:03:18 - __main__ - INFO - [main_execution_logic:284] - Epoch 4: head LR set to 5.00e-05
2025-05-30 06:03:18 - __main__ - INFO - [main_execution_logic:284] - Epoch 4: backbone LR set to 0.00e+00
2025-05-30 06:03:19 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B1: Scheduler step after optimizer step.
2025-05-30 06:03:20 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B3: Scheduler step after optimizer step.
2025-05-30 06:03:21 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B5: Scheduler step after optimizer step.
2025-05-30 06:03:22 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B7: Scheduler step after optimizer step.
2025-05-30 06:03:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B9: Scheduler step after optimizer step.
2025-05-30 06:03:24 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B11: Scheduler step after optimizer step.
2025-05-30 06:03:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B13: Scheduler step after optimizer step.
2025-05-30 06:03:26 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B15: Scheduler step after optimizer step.
2025-05-30 06:03:27 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B17: Scheduler step after optimizer step.
2025-05-30 06:03:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B19: Scheduler step after optimizer step.
2025-05-30 06:03:29 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B21: Scheduler step after optimizer step.
2025-05-30 06:03:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B23: Scheduler step after optimizer step.
2025-05-30 06:03:31 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B25: Scheduler step after optimizer step.
2025-05-30 06:03:32 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B27: Scheduler step after optimizer step.
2025-05-30 06:03:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B29: Scheduler step after optimizer step.
2025-05-30 06:03:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B31: Scheduler step after optimizer step.
2025-05-30 06:03:35 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B33: Scheduler step after optimizer step.
2025-05-30 06:03:36 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B35: Scheduler step after optimizer step.
2025-05-30 06:03:37 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B37: Scheduler step after optimizer step.
2025-05-30 06:03:38 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B39: Scheduler step after optimizer step.
2025-05-30 06:03:38 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B41: Scheduler step after optimizer step.
2025-05-30 06:03:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B43: Scheduler step after optimizer step.
2025-05-30 06:03:40 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B45: Scheduler step after optimizer step.
2025-05-30 06:03:41 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B47: Scheduler step after optimizer step.
2025-05-30 06:03:42 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B49: Scheduler step after optimizer step.
2025-05-30 06:03:43 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B51: Scheduler step after optimizer step.
2025-05-30 06:03:44 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B53: Scheduler step after optimizer step.
2025-05-30 06:03:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B55: Scheduler step after optimizer step.
2025-05-30 06:03:46 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B57: Scheduler step after optimizer step.
2025-05-30 06:03:47 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B59: Scheduler step after optimizer step.
2025-05-30 06:03:48 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B61: Scheduler step after optimizer step.
2025-05-30 06:03:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B63: Scheduler step after optimizer step.
2025-05-30 06:03:50 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B65: Scheduler step after optimizer step.
2025-05-30 06:03:51 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B67: Scheduler step after optimizer step.
2025-05-30 06:03:52 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B69: Scheduler step after optimizer step.
2025-05-30 06:03:53 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B71: Scheduler step after optimizer step.
2025-05-30 06:03:54 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B73: Scheduler step after optimizer step.
2025-05-30 06:03:55 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B75: Scheduler step after optimizer step.
2025-05-30 06:03:56 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B77: Scheduler step after optimizer step.
2025-05-30 06:03:57 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B79: Scheduler step after optimizer step.
2025-05-30 06:03:58 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B81: Scheduler step after optimizer step.
2025-05-30 06:03:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B83: Scheduler step after optimizer step.
2025-05-30 06:04:00 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B85: Scheduler step after optimizer step.
2025-05-30 06:04:01 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B87: Scheduler step after optimizer step.
2025-05-30 06:04:02 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B89: Scheduler step after optimizer step.
2025-05-30 06:04:03 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B91: Scheduler step after optimizer step.
2025-05-30 06:04:04 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B93: Scheduler step after optimizer step.
2025-05-30 06:04:05 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B95: Scheduler step after optimizer step.
2025-05-30 06:04:06 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B97: Scheduler step after optimizer step.
2025-05-30 06:04:07 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B99: Scheduler step after optimizer step.
2025-05-30 06:04:07 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B101: Scheduler step after optimizer step.
2025-05-30 06:04:08 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B103: Scheduler step after optimizer step.
2025-05-30 06:04:09 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E4 B105: Scheduler step after optimizer step.
2025-05-30 06:04:09 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:163] - Epoch 4 training finished. Avg Loss: 0.8226, Final LR: 4.00e-05, Opt Steps: 53, NaN count: 0
2025-05-30 06:04:15 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.9341, accuracy: 0.7360, f1_macro: 0.7376, f1_weighted: 0.7321, precision_macro: 0.7342, precision_weighted: 0.7796, recall_macro: 0.7858, recall_weighted: 0.7360, f1_Bacterial_Blight: 0.6154, f1_Curl_Virus: 0.6333, f1_Healthy_Leaf: 0.8000, f1_Herbicide_Growth_Damage: 0.8551, f1_Leaf_Hopper_Jassids: 0.7129, f1_Leaf_Redding: 0.7347, f1_Leaf_Variegation: 0.8116
2025-05-30 06:04:15 - __main__ - INFO - [main_execution_logic:310] - Epoch 4: f1_macro (0.7376) not improved. Patience: 3/20
2025-05-30 06:04:15 - __main__ - INFO - [main_execution_logic:316] - Epoch 4 completed in 57.01 seconds.
2025-05-30 06:04:15 - __main__ - INFO - [main_execution_logic:284] - Epoch 5: head LR set to 5.00e-05
2025-05-30 06:04:15 - __main__ - INFO - [main_execution_logic:284] - Epoch 5: backbone LR set to 0.00e+00
2025-05-30 06:04:16 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B1: Scheduler step after optimizer step.
2025-05-30 06:04:17 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B3: Scheduler step after optimizer step.
2025-05-30 06:04:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B5: Scheduler step after optimizer step.
2025-05-30 06:04:19 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B7: Scheduler step after optimizer step.
2025-05-30 06:04:20 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B9: Scheduler step after optimizer step.
2025-05-30 06:04:21 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B11: Scheduler step after optimizer step.
2025-05-30 06:04:22 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B13: Scheduler step after optimizer step.
2025-05-30 06:04:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B15: Scheduler step after optimizer step.
2025-05-30 06:04:24 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B17: Scheduler step after optimizer step.
2025-05-30 06:04:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B19: Scheduler step after optimizer step.
2025-05-30 06:04:26 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B21: Scheduler step after optimizer step.
2025-05-30 06:04:27 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B23: Scheduler step after optimizer step.
2025-05-30 06:04:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B25: Scheduler step after optimizer step.
2025-05-30 06:04:29 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B27: Scheduler step after optimizer step.
2025-05-30 06:04:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B29: Scheduler step after optimizer step.
2025-05-30 06:04:31 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B31: Scheduler step after optimizer step.
2025-05-30 06:04:32 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B33: Scheduler step after optimizer step.
2025-05-30 06:04:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B35: Scheduler step after optimizer step.
2025-05-30 06:04:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B37: Scheduler step after optimizer step.
2025-05-30 06:04:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B39: Scheduler step after optimizer step.
2025-05-30 06:04:35 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B41: Scheduler step after optimizer step.
2025-05-30 06:04:36 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B43: Scheduler step after optimizer step.
2025-05-30 06:04:37 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B45: Scheduler step after optimizer step.
2025-05-30 06:04:38 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B47: Scheduler step after optimizer step.
2025-05-30 06:04:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B49: Scheduler step after optimizer step.
2025-05-30 06:04:40 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B51: Scheduler step after optimizer step.
2025-05-30 06:04:41 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B53: Scheduler step after optimizer step.
2025-05-30 06:04:42 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B55: Scheduler step after optimizer step.
2025-05-30 06:04:43 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B57: Scheduler step after optimizer step.
2025-05-30 06:04:44 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B59: Scheduler step after optimizer step.
2025-05-30 06:04:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B61: Scheduler step after optimizer step.
2025-05-30 06:04:46 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B63: Scheduler step after optimizer step.
2025-05-30 06:04:47 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B65: Scheduler step after optimizer step.
2025-05-30 06:04:48 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B67: Scheduler step after optimizer step.
2025-05-30 06:04:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B69: Scheduler step after optimizer step.
2025-05-30 06:04:50 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B71: Scheduler step after optimizer step.
2025-05-30 06:04:51 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B73: Scheduler step after optimizer step.
2025-05-30 06:04:52 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B75: Scheduler step after optimizer step.
2025-05-30 06:04:53 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B77: Scheduler step after optimizer step.
2025-05-30 06:04:54 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B79: Scheduler step after optimizer step.
2025-05-30 06:04:55 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B81: Scheduler step after optimizer step.
2025-05-30 06:04:56 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B83: Scheduler step after optimizer step.
2025-05-30 06:04:57 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B85: Scheduler step after optimizer step.
2025-05-30 06:04:58 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B87: Scheduler step after optimizer step.
2025-05-30 06:04:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B89: Scheduler step after optimizer step.
2025-05-30 06:05:00 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B91: Scheduler step after optimizer step.
2025-05-30 06:05:01 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B93: Scheduler step after optimizer step.
2025-05-30 06:05:02 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B95: Scheduler step after optimizer step.
2025-05-30 06:05:02 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B97: Scheduler step after optimizer step.
2025-05-30 06:05:03 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B99: Scheduler step after optimizer step.
2025-05-30 06:05:04 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B101: Scheduler step after optimizer step.
2025-05-30 06:05:05 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B103: Scheduler step after optimizer step.
2025-05-30 06:05:06 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E5 B105: Scheduler step after optimizer step.
2025-05-30 06:05:06 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:163] - Epoch 5 training finished. Avg Loss: 0.8499, Final LR: 5.00e-05, Opt Steps: 53, NaN count: 0
2025-05-30 06:05:11 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.9258, accuracy: 0.7453, f1_macro: 0.7511, f1_weighted: 0.7435, precision_macro: 0.7489, precision_weighted: 0.7933, recall_macro: 0.7982, recall_weighted: 0.7453, f1_Bacterial_Blight: 0.6852, f1_Curl_Virus: 0.6116, f1_Healthy_Leaf: 0.8000, f1_Herbicide_Growth_Damage: 0.8852, f1_Leaf_Hopper_Jassids: 0.6719, f1_Leaf_Redding: 0.7551, f1_Leaf_Variegation: 0.8485
2025-05-30 06:05:11 - __main__ - INFO - [main_execution_logic:310] - Epoch 5: f1_macro (0.7511) not improved. Patience: 4/20
2025-05-30 06:05:11 - __main__ - INFO - [main_execution_logic:316] - Epoch 5 completed in 56.40 seconds.
2025-05-30 06:05:11 - __main__ - INFO - [main_execution_logic:284] - Epoch 6: head LR set to 5.00e-05
2025-05-30 06:05:11 - __main__ - INFO - [main_execution_logic:284] - Epoch 6: backbone LR set to 0.00e+00
2025-05-30 06:05:13 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B1: Scheduler step after optimizer step.
2025-05-30 06:05:14 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B3: Scheduler step after optimizer step.
2025-05-30 06:05:15 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B5: Scheduler step after optimizer step.
2025-05-30 06:05:16 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B7: Scheduler step after optimizer step.
2025-05-30 06:05:17 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B9: Scheduler step after optimizer step.
2025-05-30 06:05:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B11: Scheduler step after optimizer step.
2025-05-30 06:05:19 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B13: Scheduler step after optimizer step.
2025-05-30 06:05:20 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B15: Scheduler step after optimizer step.
2025-05-30 06:05:21 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B17: Scheduler step after optimizer step.
2025-05-30 06:05:22 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B19: Scheduler step after optimizer step.
2025-05-30 06:05:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B21: Scheduler step after optimizer step.
2025-05-30 06:05:24 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B23: Scheduler step after optimizer step.
2025-05-30 06:05:24 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B25: Scheduler step after optimizer step.
2025-05-30 06:05:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B27: Scheduler step after optimizer step.
2025-05-30 06:05:26 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B29: Scheduler step after optimizer step.
2025-05-30 06:05:27 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B31: Scheduler step after optimizer step.
2025-05-30 06:05:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B33: Scheduler step after optimizer step.
2025-05-30 06:05:29 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B35: Scheduler step after optimizer step.
2025-05-30 06:05:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B37: Scheduler step after optimizer step.
2025-05-30 06:05:31 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B39: Scheduler step after optimizer step.
2025-05-30 06:05:32 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B41: Scheduler step after optimizer step.
2025-05-30 06:05:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B43: Scheduler step after optimizer step.
2025-05-30 06:05:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B45: Scheduler step after optimizer step.
2025-05-30 06:05:35 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B47: Scheduler step after optimizer step.
2025-05-30 06:05:36 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B49: Scheduler step after optimizer step.
2025-05-30 06:05:37 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B51: Scheduler step after optimizer step.
2025-05-30 06:05:38 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B53: Scheduler step after optimizer step.
2025-05-30 06:05:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B55: Scheduler step after optimizer step.
2025-05-30 06:05:40 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B57: Scheduler step after optimizer step.
2025-05-30 06:05:41 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B59: Scheduler step after optimizer step.
2025-05-30 06:05:42 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B61: Scheduler step after optimizer step.
2025-05-30 06:05:43 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B63: Scheduler step after optimizer step.
2025-05-30 06:05:44 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B65: Scheduler step after optimizer step.
2025-05-30 06:05:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B67: Scheduler step after optimizer step.
2025-05-30 06:05:46 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B69: Scheduler step after optimizer step.
2025-05-30 06:05:47 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B71: Scheduler step after optimizer step.
2025-05-30 06:05:48 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B73: Scheduler step after optimizer step.
2025-05-30 06:05:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B75: Scheduler step after optimizer step.
2025-05-30 06:05:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B77: Scheduler step after optimizer step.
2025-05-30 06:05:50 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B79: Scheduler step after optimizer step.
2025-05-30 06:05:51 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B81: Scheduler step after optimizer step.
2025-05-30 06:05:52 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B83: Scheduler step after optimizer step.
2025-05-30 06:05:53 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B85: Scheduler step after optimizer step.
2025-05-30 06:05:54 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B87: Scheduler step after optimizer step.
2025-05-30 06:05:55 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B89: Scheduler step after optimizer step.
2025-05-30 06:05:56 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B91: Scheduler step after optimizer step.
2025-05-30 06:05:57 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B93: Scheduler step after optimizer step.
2025-05-30 06:05:58 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B95: Scheduler step after optimizer step.
2025-05-30 06:05:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B97: Scheduler step after optimizer step.
2025-05-30 06:06:00 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B99: Scheduler step after optimizer step.
2025-05-30 06:06:01 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B101: Scheduler step after optimizer step.
2025-05-30 06:06:02 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B103: Scheduler step after optimizer step.
2025-05-30 06:06:03 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E6 B105: Scheduler step after optimizer step.
2025-05-30 06:06:03 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:163] - Epoch 6 training finished. Avg Loss: 0.8311, Final LR: 5.00e-05, Opt Steps: 53, NaN count: 0
2025-05-30 06:06:08 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.9089, accuracy: 0.7664, f1_macro: 0.7748, f1_weighted: 0.7618, precision_macro: 0.7799, precision_weighted: 0.7971, recall_macro: 0.8059, recall_weighted: 0.7664, f1_Bacterial_Blight: 0.6476, f1_Curl_Virus: 0.5965, f1_Healthy_Leaf: 0.7863, f1_Herbicide_Growth_Damage: 0.8702, f1_Leaf_Hopper_Jassids: 0.7458, f1_Leaf_Redding: 0.7944, f1_Leaf_Variegation: 0.9825
2025-05-30 06:06:08 - __main__ - INFO - [main_execution_logic:310] - Epoch 6: f1_macro (0.7748) not improved. Patience: 5/20
2025-05-30 06:06:08 - __main__ - INFO - [main_execution_logic:316] - Epoch 6 completed in 57.10 seconds.
2025-05-30 06:06:08 - __main__ - INFO - [main_execution_logic:284] - Epoch 7: head LR set to 5.00e-05
2025-05-30 06:06:08 - __main__ - INFO - [main_execution_logic:284] - Epoch 7: backbone LR set to 0.00e+00
2025-05-30 06:06:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B1: Scheduler step after optimizer step.
2025-05-30 06:06:11 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B3: Scheduler step after optimizer step.
2025-05-30 06:06:12 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B5: Scheduler step after optimizer step.
2025-05-30 06:06:13 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B7: Scheduler step after optimizer step.
2025-05-30 06:06:14 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B9: Scheduler step after optimizer step.
2025-05-30 06:06:15 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B11: Scheduler step after optimizer step.
2025-05-30 06:06:16 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B13: Scheduler step after optimizer step.
2025-05-30 06:06:17 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B15: Scheduler step after optimizer step.
2025-05-30 06:06:17 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B17: Scheduler step after optimizer step.
2025-05-30 06:06:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B19: Scheduler step after optimizer step.
2025-05-30 06:06:19 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B21: Scheduler step after optimizer step.
2025-05-30 06:06:20 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B23: Scheduler step after optimizer step.
2025-05-30 06:06:21 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B25: Scheduler step after optimizer step.
2025-05-30 06:06:22 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B27: Scheduler step after optimizer step.
2025-05-30 06:06:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B29: Scheduler step after optimizer step.
2025-05-30 06:06:24 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B31: Scheduler step after optimizer step.
2025-05-30 06:06:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B33: Scheduler step after optimizer step.
2025-05-30 06:06:26 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B35: Scheduler step after optimizer step.
2025-05-30 06:06:27 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B37: Scheduler step after optimizer step.
2025-05-30 06:06:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B39: Scheduler step after optimizer step.
2025-05-30 06:06:29 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B41: Scheduler step after optimizer step.
2025-05-30 06:06:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B43: Scheduler step after optimizer step.
2025-05-30 06:06:31 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B45: Scheduler step after optimizer step.
2025-05-30 06:06:32 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B47: Scheduler step after optimizer step.
2025-05-30 06:06:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B49: Scheduler step after optimizer step.
2025-05-30 06:06:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B51: Scheduler step after optimizer step.
2025-05-30 06:06:35 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B53: Scheduler step after optimizer step.
2025-05-30 06:06:36 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B55: Scheduler step after optimizer step.
2025-05-30 06:06:37 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B57: Scheduler step after optimizer step.
2025-05-30 06:06:38 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B59: Scheduler step after optimizer step.
2025-05-30 06:06:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B61: Scheduler step after optimizer step.
2025-05-30 06:06:40 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B63: Scheduler step after optimizer step.
2025-05-30 06:06:41 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B65: Scheduler step after optimizer step.
2025-05-30 06:06:42 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B67: Scheduler step after optimizer step.
2025-05-30 06:06:43 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B69: Scheduler step after optimizer step.
2025-05-30 06:06:44 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B71: Scheduler step after optimizer step.
2025-05-30 06:06:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B73: Scheduler step after optimizer step.
2025-05-30 06:06:46 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B75: Scheduler step after optimizer step.
2025-05-30 06:06:47 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B77: Scheduler step after optimizer step.
2025-05-30 06:06:48 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B79: Scheduler step after optimizer step.
2025-05-30 06:06:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B81: Scheduler step after optimizer step.
2025-05-30 06:06:50 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B83: Scheduler step after optimizer step.
2025-05-30 06:06:51 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B85: Scheduler step after optimizer step.
2025-05-30 06:06:52 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B87: Scheduler step after optimizer step.
2025-05-30 06:06:53 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B89: Scheduler step after optimizer step.
2025-05-30 06:06:54 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B91: Scheduler step after optimizer step.
2025-05-30 06:06:55 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B93: Scheduler step after optimizer step.
2025-05-30 06:06:56 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B95: Scheduler step after optimizer step.
2025-05-30 06:06:57 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B97: Scheduler step after optimizer step.
2025-05-30 06:06:58 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B99: Scheduler step after optimizer step.
2025-05-30 06:06:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B101: Scheduler step after optimizer step.
2025-05-30 06:07:00 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B103: Scheduler step after optimizer step.
2025-05-30 06:07:01 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E7 B105: Scheduler step after optimizer step.
2025-05-30 06:07:01 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:163] - Epoch 7 training finished. Avg Loss: 0.7924, Final LR: 4.99e-05, Opt Steps: 53, NaN count: 0
2025-05-30 06:07:06 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8983, accuracy: 0.7710, f1_macro: 0.7735, f1_weighted: 0.7690, precision_macro: 0.7629, precision_weighted: 0.7977, recall_macro: 0.8109, recall_weighted: 0.7710, f1_Bacterial_Blight: 0.6415, f1_Curl_Virus: 0.6880, f1_Healthy_Leaf: 0.8288, f1_Herbicide_Growth_Damage: 0.8722, f1_Leaf_Hopper_Jassids: 0.7455, f1_Leaf_Redding: 0.7767, f1_Leaf_Variegation: 0.8615
2025-05-30 06:07:06 - __main__ - INFO - [main_execution_logic:310] - Epoch 7: f1_macro (0.7735) not improved. Patience: 6/20
2025-05-30 06:07:06 - __main__ - INFO - [main_execution_logic:316] - Epoch 7 completed in 58.04 seconds.
2025-05-30 06:07:06 - __main__ - INFO - [main_execution_logic:284] - Epoch 8: head LR set to 5.00e-05
2025-05-30 06:07:06 - __main__ - INFO - [main_execution_logic:284] - Epoch 8: backbone LR set to 0.00e+00
2025-05-30 06:07:08 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B1: Scheduler step after optimizer step.
2025-05-30 06:07:09 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B3: Scheduler step after optimizer step.
2025-05-30 06:07:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B5: Scheduler step after optimizer step.
2025-05-30 06:07:11 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B7: Scheduler step after optimizer step.
2025-05-30 06:07:12 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B9: Scheduler step after optimizer step.
2025-05-30 06:07:13 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B11: Scheduler step after optimizer step.
2025-05-30 06:07:14 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B13: Scheduler step after optimizer step.
2025-05-30 06:07:15 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B15: Scheduler step after optimizer step.
2025-05-30 06:07:16 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B17: Scheduler step after optimizer step.
2025-05-30 06:07:17 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B19: Scheduler step after optimizer step.
2025-05-30 06:07:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B21: Scheduler step after optimizer step.
2025-05-30 06:07:19 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B23: Scheduler step after optimizer step.
2025-05-30 06:07:20 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B25: Scheduler step after optimizer step.
2025-05-30 06:07:21 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B27: Scheduler step after optimizer step.
2025-05-30 06:07:22 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B29: Scheduler step after optimizer step.
2025-05-30 06:07:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B31: Scheduler step after optimizer step.
2025-05-30 06:07:24 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B33: Scheduler step after optimizer step.
2025-05-30 06:07:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B35: Scheduler step after optimizer step.
2025-05-30 06:07:26 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B37: Scheduler step after optimizer step.
2025-05-30 06:07:27 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B39: Scheduler step after optimizer step.
2025-05-30 06:07:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B41: Scheduler step after optimizer step.
2025-05-30 06:07:29 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B43: Scheduler step after optimizer step.
2025-05-30 06:07:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B45: Scheduler step after optimizer step.
2025-05-30 06:07:31 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B47: Scheduler step after optimizer step.
2025-05-30 06:07:32 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B49: Scheduler step after optimizer step.
2025-05-30 06:07:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B51: Scheduler step after optimizer step.
2025-05-30 06:07:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B53: Scheduler step after optimizer step.
2025-05-30 06:07:35 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B55: Scheduler step after optimizer step.
2025-05-30 06:07:36 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B57: Scheduler step after optimizer step.
2025-05-30 06:07:37 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B59: Scheduler step after optimizer step.
2025-05-30 06:07:38 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B61: Scheduler step after optimizer step.
2025-05-30 06:07:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B63: Scheduler step after optimizer step.
2025-05-30 06:07:40 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B65: Scheduler step after optimizer step.
2025-05-30 06:07:40 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B67: Scheduler step after optimizer step.
2025-05-30 06:07:42 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B69: Scheduler step after optimizer step.
2025-05-30 06:07:42 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B71: Scheduler step after optimizer step.
2025-05-30 06:07:44 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B73: Scheduler step after optimizer step.
2025-05-30 06:07:44 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B75: Scheduler step after optimizer step.
2025-05-30 06:07:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B77: Scheduler step after optimizer step.
2025-05-30 06:07:46 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B79: Scheduler step after optimizer step.
2025-05-30 06:07:47 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B81: Scheduler step after optimizer step.
2025-05-30 06:07:48 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B83: Scheduler step after optimizer step.
2025-05-30 06:07:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B85: Scheduler step after optimizer step.
2025-05-30 06:07:50 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B87: Scheduler step after optimizer step.
2025-05-30 06:07:51 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B89: Scheduler step after optimizer step.
2025-05-30 06:07:52 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B91: Scheduler step after optimizer step.
2025-05-30 06:07:53 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B93: Scheduler step after optimizer step.
2025-05-30 06:07:54 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B95: Scheduler step after optimizer step.
2025-05-30 06:07:55 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B97: Scheduler step after optimizer step.
2025-05-30 06:07:56 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B99: Scheduler step after optimizer step.
2025-05-30 06:07:57 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B101: Scheduler step after optimizer step.
2025-05-30 06:07:58 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B103: Scheduler step after optimizer step.
2025-05-30 06:07:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E8 B105: Scheduler step after optimizer step.
2025-05-30 06:07:59 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:163] - Epoch 8 training finished. Avg Loss: 0.8401, Final LR: 4.99e-05, Opt Steps: 53, NaN count: 0
2025-05-30 06:08:04 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8975, accuracy: 0.7593, f1_macro: 0.7643, f1_weighted: 0.7586, precision_macro: 0.7568, precision_weighted: 0.7913, recall_macro: 0.7997, recall_weighted: 0.7593, f1_Bacterial_Blight: 0.6476, f1_Curl_Virus: 0.6667, f1_Healthy_Leaf: 0.7627, f1_Herbicide_Growth_Damage: 0.8769, f1_Leaf_Hopper_Jassids: 0.7143, f1_Leaf_Redding: 0.7783, f1_Leaf_Variegation: 0.9032
2025-05-30 06:08:04 - __main__ - INFO - [main_execution_logic:310] - Epoch 8: f1_macro (0.7643) not improved. Patience: 7/20
2025-05-30 06:08:04 - __main__ - INFO - [main_execution_logic:316] - Epoch 8 completed in 57.48 seconds.
2025-05-30 06:08:04 - __main__ - INFO - [main_execution_logic:284] - Epoch 9: head LR set to 5.00e-05
2025-05-30 06:08:04 - __main__ - INFO - [main_execution_logic:284] - Epoch 9: backbone LR set to 0.00e+00
2025-05-30 06:08:05 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B1: Scheduler step after optimizer step.
2025-05-30 06:08:06 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B3: Scheduler step after optimizer step.
2025-05-30 06:08:07 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B5: Scheduler step after optimizer step.
2025-05-30 06:08:08 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B7: Scheduler step after optimizer step.
2025-05-30 06:08:09 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B9: Scheduler step after optimizer step.
2025-05-30 06:08:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B11: Scheduler step after optimizer step.
2025-05-30 06:08:11 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B13: Scheduler step after optimizer step.
2025-05-30 06:08:12 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B15: Scheduler step after optimizer step.
2025-05-30 06:08:13 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B17: Scheduler step after optimizer step.
2025-05-30 06:08:14 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B19: Scheduler step after optimizer step.
2025-05-30 06:08:15 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B21: Scheduler step after optimizer step.
2025-05-30 06:08:16 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B23: Scheduler step after optimizer step.
2025-05-30 06:08:17 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B25: Scheduler step after optimizer step.
2025-05-30 06:08:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B27: Scheduler step after optimizer step.
2025-05-30 06:08:19 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B29: Scheduler step after optimizer step.
2025-05-30 06:08:20 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B31: Scheduler step after optimizer step.
2025-05-30 06:08:21 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B33: Scheduler step after optimizer step.
2025-05-30 06:08:22 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B35: Scheduler step after optimizer step.
2025-05-30 06:08:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B37: Scheduler step after optimizer step.
2025-05-30 06:08:24 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B39: Scheduler step after optimizer step.
2025-05-30 06:08:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B41: Scheduler step after optimizer step.
2025-05-30 06:08:26 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B43: Scheduler step after optimizer step.
2025-05-30 06:08:27 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B45: Scheduler step after optimizer step.
2025-05-30 06:08:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B47: Scheduler step after optimizer step.
2025-05-30 06:08:29 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B49: Scheduler step after optimizer step.
2025-05-30 06:08:29 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B51: Scheduler step after optimizer step.
2025-05-30 06:08:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B53: Scheduler step after optimizer step.
2025-05-30 06:08:31 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B55: Scheduler step after optimizer step.
2025-05-30 06:08:32 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B57: Scheduler step after optimizer step.
2025-05-30 06:08:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B59: Scheduler step after optimizer step.
2025-05-30 06:08:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B61: Scheduler step after optimizer step.
2025-05-30 06:08:35 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B63: Scheduler step after optimizer step.
2025-05-30 06:08:36 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B65: Scheduler step after optimizer step.
2025-05-30 06:08:37 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B67: Scheduler step after optimizer step.
2025-05-30 06:08:38 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B69: Scheduler step after optimizer step.
2025-05-30 06:08:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B71: Scheduler step after optimizer step.
2025-05-30 06:08:40 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B73: Scheduler step after optimizer step.
2025-05-30 06:08:41 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B75: Scheduler step after optimizer step.
2025-05-30 06:08:42 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B77: Scheduler step after optimizer step.
2025-05-30 06:08:43 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B79: Scheduler step after optimizer step.
2025-05-30 06:08:44 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B81: Scheduler step after optimizer step.
2025-05-30 06:08:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B83: Scheduler step after optimizer step.
2025-05-30 06:08:46 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B85: Scheduler step after optimizer step.
2025-05-30 06:08:47 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B87: Scheduler step after optimizer step.
2025-05-30 06:08:48 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B89: Scheduler step after optimizer step.
2025-05-30 06:08:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B91: Scheduler step after optimizer step.
2025-05-30 06:08:50 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B93: Scheduler step after optimizer step.
2025-05-30 06:08:51 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B95: Scheduler step after optimizer step.
2025-05-30 06:08:52 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B97: Scheduler step after optimizer step.
2025-05-30 06:08:53 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B99: Scheduler step after optimizer step.
2025-05-30 06:08:54 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B101: Scheduler step after optimizer step.
2025-05-30 06:08:55 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B103: Scheduler step after optimizer step.
2025-05-30 06:08:56 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E9 B105: Scheduler step after optimizer step.
2025-05-30 06:08:56 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:163] - Epoch 9 training finished. Avg Loss: 0.8219, Final LR: 4.98e-05, Opt Steps: 53, NaN count: 0
2025-05-30 06:09:00 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.9817, accuracy: 0.7453, f1_macro: 0.7534, f1_weighted: 0.7478, precision_macro: 0.7613, precision_weighted: 0.8131, recall_macro: 0.8004, recall_weighted: 0.7453, f1_Bacterial_Blight: 0.6341, f1_Curl_Virus: 0.6777, f1_Healthy_Leaf: 0.7581, f1_Herbicide_Growth_Damage: 0.9138, f1_Leaf_Hopper_Jassids: 0.7018, f1_Leaf_Redding: 0.7396, f1_Leaf_Variegation: 0.8485
2025-05-30 06:09:00 - __main__ - INFO - [main_execution_logic:310] - Epoch 9: f1_macro (0.7534) not improved. Patience: 8/20
2025-05-30 06:09:00 - __main__ - INFO - [main_execution_logic:316] - Epoch 9 completed in 56.78 seconds.
2025-05-30 06:09:00 - __main__ - INFO - [main_execution_logic:284] - Epoch 10: head LR set to 5.00e-05
2025-05-30 06:09:00 - __main__ - INFO - [main_execution_logic:284] - Epoch 10: backbone LR set to 0.00e+00
2025-05-30 06:09:02 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B1: Scheduler step after optimizer step.
2025-05-30 06:09:03 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B3: Scheduler step after optimizer step.
2025-05-30 06:09:04 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B5: Scheduler step after optimizer step.
2025-05-30 06:09:05 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B7: Scheduler step after optimizer step.
2025-05-30 06:09:06 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B9: Scheduler step after optimizer step.
2025-05-30 06:09:07 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B11: Scheduler step after optimizer step.
2025-05-30 06:09:08 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B13: Scheduler step after optimizer step.
2025-05-30 06:09:09 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B15: Scheduler step after optimizer step.
2025-05-30 06:09:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B17: Scheduler step after optimizer step.
2025-05-30 06:09:11 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B19: Scheduler step after optimizer step.
2025-05-30 06:09:12 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B21: Scheduler step after optimizer step.
2025-05-30 06:09:13 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B23: Scheduler step after optimizer step.
2025-05-30 06:09:14 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B25: Scheduler step after optimizer step.
2025-05-30 06:09:14 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B27: Scheduler step after optimizer step.
2025-05-30 06:09:15 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B29: Scheduler step after optimizer step.
2025-05-30 06:09:16 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B31: Scheduler step after optimizer step.
2025-05-30 06:09:17 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B33: Scheduler step after optimizer step.
2025-05-30 06:09:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B35: Scheduler step after optimizer step.
2025-05-30 06:09:19 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B37: Scheduler step after optimizer step.
2025-05-30 06:09:20 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B39: Scheduler step after optimizer step.
2025-05-30 06:09:21 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B41: Scheduler step after optimizer step.
2025-05-30 06:09:22 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B43: Scheduler step after optimizer step.
2025-05-30 06:09:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B45: Scheduler step after optimizer step.
2025-05-30 06:09:24 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B47: Scheduler step after optimizer step.
2025-05-30 06:09:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B49: Scheduler step after optimizer step.
2025-05-30 06:09:26 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B51: Scheduler step after optimizer step.
2025-05-30 06:09:27 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B53: Scheduler step after optimizer step.
2025-05-30 06:09:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B55: Scheduler step after optimizer step.
2025-05-30 06:09:29 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B57: Scheduler step after optimizer step.
2025-05-30 06:09:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B59: Scheduler step after optimizer step.
2025-05-30 06:09:31 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B61: Scheduler step after optimizer step.
2025-05-30 06:09:32 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B63: Scheduler step after optimizer step.
2025-05-30 06:09:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B65: Scheduler step after optimizer step.
2025-05-30 06:09:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B67: Scheduler step after optimizer step.
2025-05-30 06:09:35 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B69: Scheduler step after optimizer step.
2025-05-30 06:09:36 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B71: Scheduler step after optimizer step.
2025-05-30 06:09:37 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B73: Scheduler step after optimizer step.
2025-05-30 06:09:38 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B75: Scheduler step after optimizer step.
2025-05-30 06:09:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B77: Scheduler step after optimizer step.
2025-05-30 06:09:40 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B79: Scheduler step after optimizer step.
2025-05-30 06:09:41 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B81: Scheduler step after optimizer step.
2025-05-30 06:09:42 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B83: Scheduler step after optimizer step.
2025-05-30 06:09:43 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B85: Scheduler step after optimizer step.
2025-05-30 06:09:43 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B87: Scheduler step after optimizer step.
2025-05-30 06:09:44 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B89: Scheduler step after optimizer step.
2025-05-30 06:09:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B91: Scheduler step after optimizer step.
2025-05-30 06:09:46 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B93: Scheduler step after optimizer step.
2025-05-30 06:09:47 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B95: Scheduler step after optimizer step.
2025-05-30 06:09:48 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B97: Scheduler step after optimizer step.
2025-05-30 06:09:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B99: Scheduler step after optimizer step.
2025-05-30 06:09:50 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B101: Scheduler step after optimizer step.
2025-05-30 06:09:51 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B103: Scheduler step after optimizer step.
2025-05-30 06:09:52 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E10 B105: Scheduler step after optimizer step.
2025-05-30 06:09:52 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:163] - Epoch 10 training finished. Avg Loss: 0.8351, Final LR: 4.97e-05, Opt Steps: 53, NaN count: 0
2025-05-30 06:09:57 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.9962, accuracy: 0.7430, f1_macro: 0.7508, f1_weighted: 0.7470, precision_macro: 0.7572, precision_weighted: 0.7966, recall_macro: 0.7856, recall_weighted: 0.7430, f1_Bacterial_Blight: 0.6346, f1_Curl_Virus: 0.6721, f1_Healthy_Leaf: 0.6763, f1_Herbicide_Growth_Damage: 0.9060, f1_Leaf_Hopper_Jassids: 0.7156, f1_Leaf_Redding: 0.7624, f1_Leaf_Variegation: 0.8889
2025-05-30 06:09:57 - __main__ - INFO - [main_execution_logic:310] - Epoch 10: f1_macro (0.7508) not improved. Patience: 9/20
2025-05-30 06:09:57 - __main__ - INFO - [main_execution_logic:316] - Epoch 10 completed in 56.24 seconds.
2025-05-30 06:09:57 - __main__ - INFO - [main_execution_logic:284] - Epoch 11: head LR set to 1.00e-05
2025-05-30 06:09:57 - __main__ - INFO - [main_execution_logic:284] - Epoch 11: backbone LR set to 5.00e-06
2025-05-30 06:09:57 - __main__ - INFO - [main_execution_logic:291] - Backbone unfrozen.
2025-05-30 06:09:58 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B1: Scheduler step after optimizer step.
2025-05-30 06:09:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B3: Scheduler step after optimizer step.
2025-05-30 06:10:00 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B5: Scheduler step after optimizer step.
2025-05-30 06:10:01 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B7: Scheduler step after optimizer step.
2025-05-30 06:10:02 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B9: Scheduler step after optimizer step.
2025-05-30 06:10:03 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B11: Scheduler step after optimizer step.
2025-05-30 06:10:04 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B13: Scheduler step after optimizer step.
2025-05-30 06:10:05 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B15: Scheduler step after optimizer step.
2025-05-30 06:10:06 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B17: Scheduler step after optimizer step.
2025-05-30 06:10:07 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B19: Scheduler step after optimizer step.
2025-05-30 06:10:08 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B21: Scheduler step after optimizer step.
2025-05-30 06:10:09 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B23: Scheduler step after optimizer step.
2025-05-30 06:10:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B25: Scheduler step after optimizer step.
2025-05-30 06:10:11 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B27: Scheduler step after optimizer step.
2025-05-30 06:10:12 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B29: Scheduler step after optimizer step.
2025-05-30 06:10:13 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B31: Scheduler step after optimizer step.
2025-05-30 06:10:14 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B33: Scheduler step after optimizer step.
2025-05-30 06:10:15 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B35: Scheduler step after optimizer step.
2025-05-30 06:10:16 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B37: Scheduler step after optimizer step.
2025-05-30 06:10:17 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B39: Scheduler step after optimizer step.
2025-05-30 06:10:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B41: Scheduler step after optimizer step.
2025-05-30 06:10:19 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B43: Scheduler step after optimizer step.
2025-05-30 06:10:20 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B45: Scheduler step after optimizer step.
2025-05-30 06:10:21 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B47: Scheduler step after optimizer step.
2025-05-30 06:10:21 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B49: Scheduler step after optimizer step.
2025-05-30 06:10:22 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B51: Scheduler step after optimizer step.
2025-05-30 06:10:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B53: Scheduler step after optimizer step.
2025-05-30 06:10:24 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B55: Scheduler step after optimizer step.
2025-05-30 06:10:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B57: Scheduler step after optimizer step.
2025-05-30 06:10:26 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B59: Scheduler step after optimizer step.
2025-05-30 06:10:27 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B61: Scheduler step after optimizer step.
2025-05-30 06:10:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B63: Scheduler step after optimizer step.
2025-05-30 06:10:29 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B65: Scheduler step after optimizer step.
2025-05-30 06:10:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B67: Scheduler step after optimizer step.
2025-05-30 06:10:31 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B69: Scheduler step after optimizer step.
2025-05-30 06:10:32 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B71: Scheduler step after optimizer step.
2025-05-30 06:10:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B73: Scheduler step after optimizer step.
2025-05-30 06:10:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B75: Scheduler step after optimizer step.
2025-05-30 06:10:35 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B77: Scheduler step after optimizer step.
2025-05-30 06:10:36 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B79: Scheduler step after optimizer step.
2025-05-30 06:10:37 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B81: Scheduler step after optimizer step.
2025-05-30 06:10:38 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B83: Scheduler step after optimizer step.
2025-05-30 06:10:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B85: Scheduler step after optimizer step.
2025-05-30 06:10:40 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B87: Scheduler step after optimizer step.
2025-05-30 06:10:41 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B89: Scheduler step after optimizer step.
2025-05-30 06:10:42 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B91: Scheduler step after optimizer step.
2025-05-30 06:10:43 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B93: Scheduler step after optimizer step.
2025-05-30 06:10:44 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B95: Scheduler step after optimizer step.
2025-05-30 06:10:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B97: Scheduler step after optimizer step.
2025-05-30 06:10:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B99: Scheduler step after optimizer step.
2025-05-30 06:10:46 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B101: Scheduler step after optimizer step.
2025-05-30 06:10:47 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B103: Scheduler step after optimizer step.
2025-05-30 06:10:48 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E11 B105: Scheduler step after optimizer step.
2025-05-30 06:10:48 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:163] - Epoch 11 training finished. Avg Loss: 0.7999, Final LR: 4.95e-05, Opt Steps: 53, NaN count: 0
2025-05-30 06:10:53 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.9737, accuracy: 0.7196, f1_macro: 0.7308, f1_weighted: 0.7132, precision_macro: 0.7290, precision_weighted: 0.7686, recall_macro: 0.7810, recall_weighted: 0.7196, f1_Bacterial_Blight: 0.6281, f1_Curl_Virus: 0.5760, f1_Healthy_Leaf: 0.8000, f1_Herbicide_Growth_Damage: 0.8382, f1_Leaf_Hopper_Jassids: 0.6857, f1_Leaf_Redding: 0.6989, f1_Leaf_Variegation: 0.8889
2025-05-30 06:10:53 - __main__ - INFO - [main_execution_logic:310] - Epoch 11: f1_macro (0.7308) not improved. Patience: 10/20
2025-05-30 06:10:53 - __main__ - INFO - [main_execution_logic:316] - Epoch 11 completed in 56.71 seconds.
2025-05-30 06:10:53 - __main__ - INFO - [main_execution_logic:284] - Epoch 12: head LR set to 1.00e-05
2025-05-30 06:10:53 - __main__ - INFO - [main_execution_logic:284] - Epoch 12: backbone LR set to 5.00e-06
2025-05-30 06:10:55 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B1: Scheduler step after optimizer step.
2025-05-30 06:10:56 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B3: Scheduler step after optimizer step.
2025-05-30 06:10:57 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B5: Scheduler step after optimizer step.
2025-05-30 06:10:58 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B7: Scheduler step after optimizer step.
2025-05-30 06:10:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B9: Scheduler step after optimizer step.
2025-05-30 06:11:00 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B11: Scheduler step after optimizer step.
2025-05-30 06:11:01 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B13: Scheduler step after optimizer step.
2025-05-30 06:11:02 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B15: Scheduler step after optimizer step.
2025-05-30 06:11:03 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B17: Scheduler step after optimizer step.
2025-05-30 06:11:04 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B19: Scheduler step after optimizer step.
2025-05-30 06:11:05 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B21: Scheduler step after optimizer step.
2025-05-30 06:11:06 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B23: Scheduler step after optimizer step.
2025-05-30 06:11:06 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B25: Scheduler step after optimizer step.
2025-05-30 06:11:07 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B27: Scheduler step after optimizer step.
2025-05-30 06:11:09 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B29: Scheduler step after optimizer step.
2025-05-30 06:11:09 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B31: Scheduler step after optimizer step.
2025-05-30 06:11:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B33: Scheduler step after optimizer step.
2025-05-30 06:11:11 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B35: Scheduler step after optimizer step.
2025-05-30 06:11:12 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B37: Scheduler step after optimizer step.
2025-05-30 06:11:13 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B39: Scheduler step after optimizer step.
2025-05-30 06:11:14 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B41: Scheduler step after optimizer step.
2025-05-30 06:11:15 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B43: Scheduler step after optimizer step.
2025-05-30 06:11:16 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B45: Scheduler step after optimizer step.
2025-05-30 06:11:17 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B47: Scheduler step after optimizer step.
2025-05-30 06:11:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B49: Scheduler step after optimizer step.
2025-05-30 06:11:19 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B51: Scheduler step after optimizer step.
2025-05-30 06:11:20 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B53: Scheduler step after optimizer step.
2025-05-30 06:11:21 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B55: Scheduler step after optimizer step.
2025-05-30 06:11:22 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B57: Scheduler step after optimizer step.
2025-05-30 06:11:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B59: Scheduler step after optimizer step.
2025-05-30 06:11:24 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B61: Scheduler step after optimizer step.
2025-05-30 06:11:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B63: Scheduler step after optimizer step.
2025-05-30 06:11:26 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B65: Scheduler step after optimizer step.
2025-05-30 06:11:27 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B67: Scheduler step after optimizer step.
2025-05-30 06:11:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B69: Scheduler step after optimizer step.
2025-05-30 06:11:29 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B71: Scheduler step after optimizer step.
2025-05-30 06:11:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B73: Scheduler step after optimizer step.
2025-05-30 06:11:31 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B75: Scheduler step after optimizer step.
2025-05-30 06:11:32 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B77: Scheduler step after optimizer step.
2025-05-30 06:11:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B79: Scheduler step after optimizer step.
2025-05-30 06:11:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B81: Scheduler step after optimizer step.
2025-05-30 06:11:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B83: Scheduler step after optimizer step.
2025-05-30 06:11:35 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B85: Scheduler step after optimizer step.
2025-05-30 06:11:36 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B87: Scheduler step after optimizer step.
2025-05-30 06:11:37 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B89: Scheduler step after optimizer step.
2025-05-30 06:11:38 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B91: Scheduler step after optimizer step.
2025-05-30 06:11:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B93: Scheduler step after optimizer step.
2025-05-30 06:11:40 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B95: Scheduler step after optimizer step.
2025-05-30 06:11:41 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B97: Scheduler step after optimizer step.
2025-05-30 06:11:42 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B99: Scheduler step after optimizer step.
2025-05-30 06:11:43 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B101: Scheduler step after optimizer step.
2025-05-30 06:11:44 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B103: Scheduler step after optimizer step.
2025-05-30 06:11:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E12 B105: Scheduler step after optimizer step.
2025-05-30 06:11:45 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:163] - Epoch 12 training finished. Avg Loss: 0.7940, Final LR: 4.93e-05, Opt Steps: 53, NaN count: 0
2025-05-30 06:11:50 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 1.0007, accuracy: 0.7360, f1_macro: 0.7462, f1_weighted: 0.7372, precision_macro: 0.7529, precision_weighted: 0.7870, recall_macro: 0.7823, recall_weighted: 0.7360, f1_Bacterial_Blight: 0.6214, f1_Curl_Virus: 0.6281, f1_Healthy_Leaf: 0.6901, f1_Herbicide_Growth_Damage: 0.9000, f1_Leaf_Hopper_Jassids: 0.7156, f1_Leaf_Redding: 0.7500, f1_Leaf_Variegation: 0.9180
2025-05-30 06:11:50 - __main__ - INFO - [main_execution_logic:310] - Epoch 12: f1_macro (0.7462) not improved. Patience: 11/20
2025-05-30 06:11:50 - __main__ - INFO - [main_execution_logic:316] - Epoch 12 completed in 56.45 seconds.
2025-05-30 06:11:50 - __main__ - INFO - [main_execution_logic:284] - Epoch 13: head LR set to 1.00e-05
2025-05-30 06:11:50 - __main__ - INFO - [main_execution_logic:284] - Epoch 13: backbone LR set to 5.00e-06
2025-05-30 06:11:51 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B1: Scheduler step after optimizer step.
2025-05-30 06:11:52 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B3: Scheduler step after optimizer step.
2025-05-30 06:11:53 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B5: Scheduler step after optimizer step.
2025-05-30 06:11:54 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B7: Scheduler step after optimizer step.
2025-05-30 06:11:55 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B9: Scheduler step after optimizer step.
2025-05-30 06:11:56 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B11: Scheduler step after optimizer step.
2025-05-30 06:11:57 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B13: Scheduler step after optimizer step.
2025-05-30 06:11:58 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B15: Scheduler step after optimizer step.
2025-05-30 06:11:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B17: Scheduler step after optimizer step.
2025-05-30 06:12:00 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B19: Scheduler step after optimizer step.
2025-05-30 06:12:01 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B21: Scheduler step after optimizer step.
2025-05-30 06:12:02 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B23: Scheduler step after optimizer step.
2025-05-30 06:12:03 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B25: Scheduler step after optimizer step.
2025-05-30 06:12:04 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B27: Scheduler step after optimizer step.
2025-05-30 06:12:05 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B29: Scheduler step after optimizer step.
2025-05-30 06:12:06 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B31: Scheduler step after optimizer step.
2025-05-30 06:12:07 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B33: Scheduler step after optimizer step.
2025-05-30 06:12:08 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B35: Scheduler step after optimizer step.
2025-05-30 06:12:09 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B37: Scheduler step after optimizer step.
2025-05-30 06:12:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B39: Scheduler step after optimizer step.
2025-05-30 06:12:11 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B41: Scheduler step after optimizer step.
2025-05-30 06:12:12 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B43: Scheduler step after optimizer step.
2025-05-30 06:12:13 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B45: Scheduler step after optimizer step.
2025-05-30 06:12:14 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B47: Scheduler step after optimizer step.
2025-05-30 06:12:14 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B49: Scheduler step after optimizer step.
2025-05-30 06:12:15 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B51: Scheduler step after optimizer step.
2025-05-30 06:12:16 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B53: Scheduler step after optimizer step.
2025-05-30 06:12:17 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B55: Scheduler step after optimizer step.
2025-05-30 06:12:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B57: Scheduler step after optimizer step.
2025-05-30 06:12:19 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B59: Scheduler step after optimizer step.
2025-05-30 06:12:20 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B61: Scheduler step after optimizer step.
2025-05-30 06:12:21 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B63: Scheduler step after optimizer step.
2025-05-30 06:12:22 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B65: Scheduler step after optimizer step.
2025-05-30 06:12:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B67: Scheduler step after optimizer step.
2025-05-30 06:12:24 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B69: Scheduler step after optimizer step.
2025-05-30 06:12:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B71: Scheduler step after optimizer step.
2025-05-30 06:12:26 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B73: Scheduler step after optimizer step.
2025-05-30 06:12:27 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B75: Scheduler step after optimizer step.
2025-05-30 06:12:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B77: Scheduler step after optimizer step.
2025-05-30 06:12:29 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B79: Scheduler step after optimizer step.
2025-05-30 06:12:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B81: Scheduler step after optimizer step.
2025-05-30 06:12:31 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B83: Scheduler step after optimizer step.
2025-05-30 06:12:32 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B85: Scheduler step after optimizer step.
2025-05-30 06:12:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B87: Scheduler step after optimizer step.
2025-05-30 06:12:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B89: Scheduler step after optimizer step.
2025-05-30 06:12:35 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B91: Scheduler step after optimizer step.
2025-05-30 06:12:36 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B93: Scheduler step after optimizer step.
2025-05-30 06:12:37 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B95: Scheduler step after optimizer step.
2025-05-30 06:12:38 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B97: Scheduler step after optimizer step.
2025-05-30 06:12:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B99: Scheduler step after optimizer step.
2025-05-30 06:12:40 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B101: Scheduler step after optimizer step.
2025-05-30 06:12:41 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B103: Scheduler step after optimizer step.
2025-05-30 06:12:41 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E13 B105: Scheduler step after optimizer step.
2025-05-30 06:12:41 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:163] - Epoch 13 training finished. Avg Loss: 0.7973, Final LR: 4.91e-05, Opt Steps: 53, NaN count: 0
2025-05-30 06:12:46 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 1.0182, accuracy: 0.7079, f1_macro: 0.7136, f1_weighted: 0.7028, precision_macro: 0.7130, precision_weighted: 0.7623, recall_macro: 0.7677, recall_weighted: 0.7079, f1_Bacterial_Blight: 0.6226, f1_Curl_Virus: 0.5620, f1_Healthy_Leaf: 0.7385, f1_Herbicide_Growth_Damage: 0.9032, f1_Leaf_Hopper_Jassids: 0.6500, f1_Leaf_Redding: 0.6952, f1_Leaf_Variegation: 0.8235
2025-05-30 06:12:46 - __main__ - INFO - [main_execution_logic:310] - Epoch 13: f1_macro (0.7136) not improved. Patience: 12/20
2025-05-30 06:12:46 - __main__ - INFO - [main_execution_logic:316] - Epoch 13 completed in 56.53 seconds.
2025-05-30 06:12:46 - __main__ - INFO - [main_execution_logic:284] - Epoch 14: head LR set to 1.00e-05
2025-05-30 06:12:46 - __main__ - INFO - [main_execution_logic:284] - Epoch 14: backbone LR set to 5.00e-06
2025-05-30 06:12:48 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B1: Scheduler step after optimizer step.
2025-05-30 06:12:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B3: Scheduler step after optimizer step.
2025-05-30 06:12:50 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B5: Scheduler step after optimizer step.
2025-05-30 06:12:51 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B7: Scheduler step after optimizer step.
2025-05-30 06:12:52 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B9: Scheduler step after optimizer step.
2025-05-30 06:12:53 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B11: Scheduler step after optimizer step.
2025-05-30 06:12:54 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B13: Scheduler step after optimizer step.
2025-05-30 06:12:55 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B15: Scheduler step after optimizer step.
2025-05-30 06:12:56 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B17: Scheduler step after optimizer step.
2025-05-30 06:12:57 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B19: Scheduler step after optimizer step.
2025-05-30 06:12:58 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B21: Scheduler step after optimizer step.
2025-05-30 06:12:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B23: Scheduler step after optimizer step.
2025-05-30 06:12:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B25: Scheduler step after optimizer step.
2025-05-30 06:13:00 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B27: Scheduler step after optimizer step.
2025-05-30 06:13:01 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B29: Scheduler step after optimizer step.
2025-05-30 06:13:02 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B31: Scheduler step after optimizer step.
2025-05-30 06:13:03 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B33: Scheduler step after optimizer step.
2025-05-30 06:13:04 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B35: Scheduler step after optimizer step.
2025-05-30 06:13:05 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B37: Scheduler step after optimizer step.
2025-05-30 06:13:06 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B39: Scheduler step after optimizer step.
2025-05-30 06:13:07 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B41: Scheduler step after optimizer step.
2025-05-30 06:13:08 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B43: Scheduler step after optimizer step.
2025-05-30 06:13:09 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B45: Scheduler step after optimizer step.
2025-05-30 06:13:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B47: Scheduler step after optimizer step.
2025-05-30 06:13:11 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B49: Scheduler step after optimizer step.
2025-05-30 06:13:12 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B51: Scheduler step after optimizer step.
2025-05-30 06:13:13 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B53: Scheduler step after optimizer step.
2025-05-30 06:13:14 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B55: Scheduler step after optimizer step.
2025-05-30 06:13:15 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B57: Scheduler step after optimizer step.
2025-05-30 06:13:16 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B59: Scheduler step after optimizer step.
2025-05-30 06:13:17 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B61: Scheduler step after optimizer step.
2025-05-30 06:13:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B63: Scheduler step after optimizer step.
2025-05-30 06:13:19 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B65: Scheduler step after optimizer step.
2025-05-30 06:13:20 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B67: Scheduler step after optimizer step.
2025-05-30 06:13:21 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B69: Scheduler step after optimizer step.
2025-05-30 06:13:22 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B71: Scheduler step after optimizer step.
2025-05-30 06:13:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B73: Scheduler step after optimizer step.
2025-05-30 06:13:24 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B75: Scheduler step after optimizer step.
2025-05-30 06:13:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B77: Scheduler step after optimizer step.
2025-05-30 06:13:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B79: Scheduler step after optimizer step.
2025-05-30 06:13:26 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B81: Scheduler step after optimizer step.
2025-05-30 06:13:27 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B83: Scheduler step after optimizer step.
2025-05-30 06:13:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B85: Scheduler step after optimizer step.
2025-05-30 06:13:29 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B87: Scheduler step after optimizer step.
2025-05-30 06:13:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B89: Scheduler step after optimizer step.
2025-05-30 06:13:31 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B91: Scheduler step after optimizer step.
2025-05-30 06:13:32 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B93: Scheduler step after optimizer step.
2025-05-30 06:13:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B95: Scheduler step after optimizer step.
2025-05-30 06:13:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B97: Scheduler step after optimizer step.
2025-05-30 06:13:35 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B99: Scheduler step after optimizer step.
2025-05-30 06:13:36 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B101: Scheduler step after optimizer step.
2025-05-30 06:13:37 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B103: Scheduler step after optimizer step.
2025-05-30 06:13:38 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E14 B105: Scheduler step after optimizer step.
2025-05-30 06:13:38 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:163] - Epoch 14 training finished. Avg Loss: 0.8281, Final LR: 4.89e-05, Opt Steps: 53, NaN count: 0
2025-05-30 06:13:43 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.9342, accuracy: 0.7617, f1_macro: 0.7715, f1_weighted: 0.7627, precision_macro: 0.7715, precision_weighted: 0.7909, recall_macro: 0.7964, recall_weighted: 0.7617, f1_Bacterial_Blight: 0.6226, f1_Curl_Virus: 0.6613, f1_Healthy_Leaf: 0.7419, f1_Herbicide_Growth_Damage: 0.9194, f1_Leaf_Hopper_Jassids: 0.7103, f1_Leaf_Redding: 0.7793, f1_Leaf_Variegation: 0.9655
2025-05-30 06:13:43 - __main__ - INFO - [main_execution_logic:310] - Epoch 14: f1_macro (0.7715) not improved. Patience: 13/20
2025-05-30 06:13:43 - __main__ - INFO - [main_execution_logic:316] - Epoch 14 completed in 56.34 seconds.
2025-05-30 06:13:43 - __main__ - INFO - [main_execution_logic:284] - Epoch 15: head LR set to 1.00e-05
2025-05-30 06:13:43 - __main__ - INFO - [main_execution_logic:284] - Epoch 15: backbone LR set to 5.00e-06
2025-05-30 06:13:44 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B1: Scheduler step after optimizer step.
2025-05-30 06:13:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B3: Scheduler step after optimizer step.
2025-05-30 06:13:46 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B5: Scheduler step after optimizer step.
2025-05-30 06:13:47 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B7: Scheduler step after optimizer step.
2025-05-30 06:13:48 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B9: Scheduler step after optimizer step.
2025-05-30 06:13:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B11: Scheduler step after optimizer step.
2025-05-30 06:13:50 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B13: Scheduler step after optimizer step.
2025-05-30 06:13:51 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B15: Scheduler step after optimizer step.
2025-05-30 06:13:52 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B17: Scheduler step after optimizer step.
2025-05-30 06:13:53 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B19: Scheduler step after optimizer step.
2025-05-30 06:13:54 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B21: Scheduler step after optimizer step.
2025-05-30 06:13:55 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B23: Scheduler step after optimizer step.
2025-05-30 06:13:56 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B25: Scheduler step after optimizer step.
2025-05-30 06:13:57 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B27: Scheduler step after optimizer step.
2025-05-30 06:13:58 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B29: Scheduler step after optimizer step.
2025-05-30 06:13:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B31: Scheduler step after optimizer step.
2025-05-30 06:14:00 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B33: Scheduler step after optimizer step.
2025-05-30 06:14:00 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B35: Scheduler step after optimizer step.
2025-05-30 06:14:01 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B37: Scheduler step after optimizer step.
2025-05-30 06:14:02 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B39: Scheduler step after optimizer step.
2025-05-30 06:14:03 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B41: Scheduler step after optimizer step.
2025-05-30 06:14:04 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B43: Scheduler step after optimizer step.
2025-05-30 06:14:05 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B45: Scheduler step after optimizer step.
2025-05-30 06:14:06 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B47: Scheduler step after optimizer step.
2025-05-30 06:14:07 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B49: Scheduler step after optimizer step.
2025-05-30 06:14:08 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B51: Scheduler step after optimizer step.
2025-05-30 06:14:09 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B53: Scheduler step after optimizer step.
2025-05-30 06:14:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B55: Scheduler step after optimizer step.
2025-05-30 06:14:11 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B57: Scheduler step after optimizer step.
2025-05-30 06:14:12 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B59: Scheduler step after optimizer step.
2025-05-30 06:14:13 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B61: Scheduler step after optimizer step.
2025-05-30 06:14:14 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B63: Scheduler step after optimizer step.
2025-05-30 06:14:15 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B65: Scheduler step after optimizer step.
2025-05-30 06:14:16 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B67: Scheduler step after optimizer step.
2025-05-30 06:14:17 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B69: Scheduler step after optimizer step.
2025-05-30 06:14:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B71: Scheduler step after optimizer step.
2025-05-30 06:14:19 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B73: Scheduler step after optimizer step.
2025-05-30 06:14:20 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B75: Scheduler step after optimizer step.
2025-05-30 06:14:21 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B77: Scheduler step after optimizer step.
2025-05-30 06:14:22 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B79: Scheduler step after optimizer step.
2025-05-30 06:14:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B81: Scheduler step after optimizer step.
2025-05-30 06:14:24 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B83: Scheduler step after optimizer step.
2025-05-30 06:14:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B85: Scheduler step after optimizer step.
2025-05-30 06:14:26 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B87: Scheduler step after optimizer step.
2025-05-30 06:14:27 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B89: Scheduler step after optimizer step.
2025-05-30 06:14:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B91: Scheduler step after optimizer step.
2025-05-30 06:14:29 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B93: Scheduler step after optimizer step.
2025-05-30 06:14:29 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B95: Scheduler step after optimizer step.
2025-05-30 06:14:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B97: Scheduler step after optimizer step.
2025-05-30 06:14:31 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B99: Scheduler step after optimizer step.
2025-05-30 06:14:32 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B101: Scheduler step after optimizer step.
2025-05-30 06:14:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B103: Scheduler step after optimizer step.
2025-05-30 06:14:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E15 B105: Scheduler step after optimizer step.
2025-05-30 06:14:34 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:163] - Epoch 15 training finished. Avg Loss: 0.8089, Final LR: 4.86e-05, Opt Steps: 53, NaN count: 0
2025-05-30 06:14:39 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.9872, accuracy: 0.7360, f1_macro: 0.7483, f1_weighted: 0.7408, precision_macro: 0.7690, precision_weighted: 0.8072, recall_macro: 0.7831, recall_weighted: 0.7360, f1_Bacterial_Blight: 0.5760, f1_Curl_Virus: 0.6316, f1_Healthy_Leaf: 0.7273, f1_Herbicide_Growth_Damage: 0.8739, f1_Leaf_Hopper_Jassids: 0.7103, f1_Leaf_Redding: 0.7700, f1_Leaf_Variegation: 0.9492
2025-05-30 06:14:39 - __main__ - INFO - [main_execution_logic:310] - Epoch 15: f1_macro (0.7483) not improved. Patience: 14/20
2025-05-30 06:14:39 - __main__ - INFO - [main_execution_logic:316] - Epoch 15 completed in 56.26 seconds.
2025-05-30 06:14:39 - __main__ - INFO - [main_execution_logic:284] - Epoch 16: head LR set to 1.00e-05
2025-05-30 06:14:39 - __main__ - INFO - [main_execution_logic:284] - Epoch 16: backbone LR set to 5.00e-06
2025-05-30 06:14:40 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B1: Scheduler step after optimizer step.
2025-05-30 06:14:41 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B3: Scheduler step after optimizer step.
2025-05-30 06:14:42 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B5: Scheduler step after optimizer step.
2025-05-30 06:14:43 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B7: Scheduler step after optimizer step.
2025-05-30 06:14:44 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B9: Scheduler step after optimizer step.
2025-05-30 06:14:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B11: Scheduler step after optimizer step.
2025-05-30 06:14:46 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B13: Scheduler step after optimizer step.
2025-05-30 06:14:47 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B15: Scheduler step after optimizer step.
2025-05-30 06:14:48 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B17: Scheduler step after optimizer step.
2025-05-30 06:14:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B19: Scheduler step after optimizer step.
2025-05-30 06:14:50 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B21: Scheduler step after optimizer step.
2025-05-30 06:14:51 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B23: Scheduler step after optimizer step.
2025-05-30 06:14:52 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B25: Scheduler step after optimizer step.
2025-05-30 06:14:53 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B27: Scheduler step after optimizer step.
2025-05-30 06:14:54 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B29: Scheduler step after optimizer step.
2025-05-30 06:14:55 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B31: Scheduler step after optimizer step.
2025-05-30 06:14:56 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B33: Scheduler step after optimizer step.
2025-05-30 06:14:57 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B35: Scheduler step after optimizer step.
2025-05-30 06:14:58 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B37: Scheduler step after optimizer step.
2025-05-30 06:14:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B39: Scheduler step after optimizer step.
2025-05-30 06:15:00 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B41: Scheduler step after optimizer step.
2025-05-30 06:15:01 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B43: Scheduler step after optimizer step.
2025-05-30 06:15:02 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B45: Scheduler step after optimizer step.
2025-05-30 06:15:03 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B47: Scheduler step after optimizer step.
2025-05-30 06:15:04 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B49: Scheduler step after optimizer step.
2025-05-30 06:15:05 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B51: Scheduler step after optimizer step.
2025-05-30 06:15:06 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B53: Scheduler step after optimizer step.
2025-05-30 06:15:07 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B55: Scheduler step after optimizer step.
2025-05-30 06:15:08 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B57: Scheduler step after optimizer step.
2025-05-30 06:15:09 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B59: Scheduler step after optimizer step.
2025-05-30 06:15:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B61: Scheduler step after optimizer step.
2025-05-30 06:15:11 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B63: Scheduler step after optimizer step.
2025-05-30 06:15:11 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B65: Scheduler step after optimizer step.
2025-05-30 06:15:12 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B67: Scheduler step after optimizer step.
2025-05-30 06:15:13 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B69: Scheduler step after optimizer step.
2025-05-30 06:15:14 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B71: Scheduler step after optimizer step.
2025-05-30 06:15:15 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B73: Scheduler step after optimizer step.
2025-05-30 06:15:16 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B75: Scheduler step after optimizer step.
2025-05-30 06:15:17 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B77: Scheduler step after optimizer step.
2025-05-30 06:15:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B79: Scheduler step after optimizer step.
2025-05-30 06:15:19 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B81: Scheduler step after optimizer step.
2025-05-30 06:15:20 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B83: Scheduler step after optimizer step.
2025-05-30 06:15:21 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B85: Scheduler step after optimizer step.
2025-05-30 06:15:22 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B87: Scheduler step after optimizer step.
2025-05-30 06:15:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B89: Scheduler step after optimizer step.
2025-05-30 06:15:24 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B91: Scheduler step after optimizer step.
2025-05-30 06:15:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B93: Scheduler step after optimizer step.
2025-05-30 06:15:26 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B95: Scheduler step after optimizer step.
2025-05-30 06:15:27 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B97: Scheduler step after optimizer step.
2025-05-30 06:15:28 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B99: Scheduler step after optimizer step.
2025-05-30 06:15:29 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B101: Scheduler step after optimizer step.
2025-05-30 06:15:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B103: Scheduler step after optimizer step.
2025-05-30 06:15:31 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E16 B105: Scheduler step after optimizer step.
2025-05-30 06:15:31 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:163] - Epoch 16 training finished. Avg Loss: 0.7649, Final LR: 4.84e-05, Opt Steps: 53, NaN count: 0
2025-05-30 06:15:35 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.9927, accuracy: 0.7220, f1_macro: 0.7424, f1_weighted: 0.7227, precision_macro: 0.7504, precision_weighted: 0.7858, recall_macro: 0.7843, recall_weighted: 0.7220, f1_Bacterial_Blight: 0.5968, f1_Curl_Virus: 0.6515, f1_Healthy_Leaf: 0.7402, f1_Herbicide_Growth_Damage: 0.8621, f1_Leaf_Hopper_Jassids: 0.7321, f1_Leaf_Redding: 0.6811, f1_Leaf_Variegation: 0.9333
2025-05-30 06:15:35 - __main__ - INFO - [main_execution_logic:310] - Epoch 16: f1_macro (0.7424) not improved. Patience: 15/20
2025-05-30 06:15:35 - __main__ - INFO - [main_execution_logic:316] - Epoch 16 completed in 56.36 seconds.
2025-05-30 06:15:35 - __main__ - INFO - [main_execution_logic:284] - Epoch 17: head LR set to 1.00e-05
2025-05-30 06:15:35 - __main__ - INFO - [main_execution_logic:284] - Epoch 17: backbone LR set to 5.00e-06
2025-05-30 06:15:37 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B1: Scheduler step after optimizer step.
2025-05-30 06:15:38 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B3: Scheduler step after optimizer step.
2025-05-30 06:15:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B5: Scheduler step after optimizer step.
2025-05-30 06:15:40 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B7: Scheduler step after optimizer step.
2025-05-30 06:15:41 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B9: Scheduler step after optimizer step.
2025-05-30 06:15:42 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B11: Scheduler step after optimizer step.
2025-05-30 06:15:43 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B13: Scheduler step after optimizer step.
2025-05-30 06:15:44 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B15: Scheduler step after optimizer step.
2025-05-30 06:15:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B17: Scheduler step after optimizer step.
2025-05-30 06:15:46 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B19: Scheduler step after optimizer step.
2025-05-30 06:15:47 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B21: Scheduler step after optimizer step.
2025-05-30 06:15:48 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B23: Scheduler step after optimizer step.
2025-05-30 06:15:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B25: Scheduler step after optimizer step.
2025-05-30 06:15:50 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B27: Scheduler step after optimizer step.
2025-05-30 06:15:51 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B29: Scheduler step after optimizer step.
2025-05-30 06:15:51 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B31: Scheduler step after optimizer step.
2025-05-30 06:15:52 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B33: Scheduler step after optimizer step.
2025-05-30 06:15:53 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B35: Scheduler step after optimizer step.
2025-05-30 06:15:54 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B37: Scheduler step after optimizer step.
2025-05-30 06:15:55 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B39: Scheduler step after optimizer step.
2025-05-30 06:15:56 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B41: Scheduler step after optimizer step.
2025-05-30 06:15:57 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B43: Scheduler step after optimizer step.
2025-05-30 06:15:58 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B45: Scheduler step after optimizer step.
2025-05-30 06:15:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B47: Scheduler step after optimizer step.
2025-05-30 06:16:00 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B49: Scheduler step after optimizer step.
2025-05-30 06:16:01 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B51: Scheduler step after optimizer step.
2025-05-30 06:16:02 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B53: Scheduler step after optimizer step.
2025-05-30 06:16:03 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B55: Scheduler step after optimizer step.
2025-05-30 06:16:04 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B57: Scheduler step after optimizer step.
2025-05-30 06:16:05 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B59: Scheduler step after optimizer step.
2025-05-30 06:16:06 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B61: Scheduler step after optimizer step.
2025-05-30 06:16:07 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B63: Scheduler step after optimizer step.
2025-05-30 06:16:08 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B65: Scheduler step after optimizer step.
2025-05-30 06:16:09 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B67: Scheduler step after optimizer step.
2025-05-30 06:16:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B69: Scheduler step after optimizer step.
2025-05-30 06:16:11 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B71: Scheduler step after optimizer step.
2025-05-30 06:16:12 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B73: Scheduler step after optimizer step.
2025-05-30 06:16:13 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B75: Scheduler step after optimizer step.
2025-05-30 06:16:14 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B77: Scheduler step after optimizer step.
2025-05-30 06:16:14 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B79: Scheduler step after optimizer step.
2025-05-30 06:16:15 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B81: Scheduler step after optimizer step.
2025-05-30 06:16:16 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B83: Scheduler step after optimizer step.
2025-05-30 06:16:17 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B85: Scheduler step after optimizer step.
2025-05-30 06:16:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B87: Scheduler step after optimizer step.
2025-05-30 06:16:19 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B89: Scheduler step after optimizer step.
2025-05-30 06:16:20 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B91: Scheduler step after optimizer step.
2025-05-30 06:16:21 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B93: Scheduler step after optimizer step.
2025-05-30 06:16:22 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B95: Scheduler step after optimizer step.
2025-05-30 06:16:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B97: Scheduler step after optimizer step.
2025-05-30 06:16:24 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B99: Scheduler step after optimizer step.
2025-05-30 06:16:25 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B101: Scheduler step after optimizer step.
2025-05-30 06:16:26 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B103: Scheduler step after optimizer step.
2025-05-30 06:16:27 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E17 B105: Scheduler step after optimizer step.
2025-05-30 06:16:27 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:163] - Epoch 17 training finished. Avg Loss: 0.8142, Final LR: 4.81e-05, Opt Steps: 53, NaN count: 0
2025-05-30 06:16:32 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 1.0325, accuracy: 0.7243, f1_macro: 0.7400, f1_weighted: 0.7251, precision_macro: 0.7468, precision_weighted: 0.7848, recall_macro: 0.7789, recall_weighted: 0.7243, f1_Bacterial_Blight: 0.5946, f1_Curl_Virus: 0.6818, f1_Healthy_Leaf: 0.7050, f1_Herbicide_Growth_Damage: 0.8480, f1_Leaf_Hopper_Jassids: 0.7184, f1_Leaf_Redding: 0.6989, f1_Leaf_Variegation: 0.9333
2025-05-30 06:16:32 - __main__ - INFO - [main_execution_logic:310] - Epoch 17: f1_macro (0.7400) not improved. Patience: 16/20
2025-05-30 06:16:32 - __main__ - INFO - [main_execution_logic:316] - Epoch 17 completed in 56.45 seconds.
2025-05-30 06:16:32 - __main__ - INFO - [main_execution_logic:284] - Epoch 18: head LR set to 1.00e-05
2025-05-30 06:16:32 - __main__ - INFO - [main_execution_logic:284] - Epoch 18: backbone LR set to 5.00e-06
2025-05-30 06:16:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B1: Scheduler step after optimizer step.
2025-05-30 06:16:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B3: Scheduler step after optimizer step.
2025-05-30 06:16:35 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B5: Scheduler step after optimizer step.
2025-05-30 06:16:36 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B7: Scheduler step after optimizer step.
2025-05-30 06:16:37 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B9: Scheduler step after optimizer step.
2025-05-30 06:16:38 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B11: Scheduler step after optimizer step.
2025-05-30 06:16:39 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B13: Scheduler step after optimizer step.
2025-05-30 06:16:40 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B15: Scheduler step after optimizer step.
2025-05-30 06:16:41 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B17: Scheduler step after optimizer step.
2025-05-30 06:16:42 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B19: Scheduler step after optimizer step.
2025-05-30 06:16:43 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B21: Scheduler step after optimizer step.
2025-05-30 06:16:44 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B23: Scheduler step after optimizer step.
2025-05-30 06:16:45 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B25: Scheduler step after optimizer step.
2025-05-30 06:16:46 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B27: Scheduler step after optimizer step.
2025-05-30 06:16:47 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B29: Scheduler step after optimizer step.
2025-05-30 06:16:48 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B31: Scheduler step after optimizer step.
2025-05-30 06:16:49 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B33: Scheduler step after optimizer step.
2025-05-30 06:16:50 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B35: Scheduler step after optimizer step.
2025-05-30 06:16:51 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B37: Scheduler step after optimizer step.
2025-05-30 06:16:52 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B39: Scheduler step after optimizer step.
2025-05-30 06:16:53 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B41: Scheduler step after optimizer step.
2025-05-30 06:16:53 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B43: Scheduler step after optimizer step.
2025-05-30 06:16:54 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B45: Scheduler step after optimizer step.
2025-05-30 06:16:55 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B47: Scheduler step after optimizer step.
2025-05-30 06:16:56 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B49: Scheduler step after optimizer step.
2025-05-30 06:16:57 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B51: Scheduler step after optimizer step.
2025-05-30 06:16:58 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B53: Scheduler step after optimizer step.
2025-05-30 06:16:59 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B55: Scheduler step after optimizer step.
2025-05-30 06:17:00 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B57: Scheduler step after optimizer step.
2025-05-30 06:17:01 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B59: Scheduler step after optimizer step.
2025-05-30 06:17:02 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B61: Scheduler step after optimizer step.
2025-05-30 06:17:03 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B63: Scheduler step after optimizer step.
2025-05-30 06:17:04 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B65: Scheduler step after optimizer step.
2025-05-30 06:17:05 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B67: Scheduler step after optimizer step.
2025-05-30 06:17:06 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B69: Scheduler step after optimizer step.
2025-05-30 06:17:07 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B71: Scheduler step after optimizer step.
2025-05-30 06:17:08 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B73: Scheduler step after optimizer step.
2025-05-30 06:17:09 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B75: Scheduler step after optimizer step.
2025-05-30 06:17:10 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B77: Scheduler step after optimizer step.
2025-05-30 06:17:11 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B79: Scheduler step after optimizer step.
2025-05-30 06:17:12 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B81: Scheduler step after optimizer step.
2025-05-30 06:17:13 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B83: Scheduler step after optimizer step.
2025-05-30 06:17:14 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B85: Scheduler step after optimizer step.
2025-05-30 06:17:15 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B87: Scheduler step after optimizer step.
2025-05-30 06:17:16 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B89: Scheduler step after optimizer step.
2025-05-30 06:17:17 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B91: Scheduler step after optimizer step.
2025-05-30 06:17:18 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B93: Scheduler step after optimizer step.
2025-05-30 06:17:19 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B95: Scheduler step after optimizer step.
2025-05-30 06:17:20 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B97: Scheduler step after optimizer step.
2025-05-30 06:17:21 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B99: Scheduler step after optimizer step.
2025-05-30 06:17:22 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B101: Scheduler step after optimizer step.
2025-05-30 06:17:22 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B103: Scheduler step after optimizer step.
2025-05-30 06:17:23 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E18 B105: Scheduler step after optimizer step.
2025-05-30 06:17:23 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:163] - Epoch 18 training finished. Avg Loss: 0.7974, Final LR: 4.77e-05, Opt Steps: 53, NaN count: 0
2025-05-30 06:17:28 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.9942, accuracy: 0.7336, f1_macro: 0.7476, f1_weighted: 0.7305, precision_macro: 0.7443, precision_weighted: 0.7821, recall_macro: 0.7921, recall_weighted: 0.7336, f1_Bacterial_Blight: 0.6422, f1_Curl_Virus: 0.6418, f1_Healthy_Leaf: 0.7287, f1_Herbicide_Growth_Damage: 0.8730, f1_Leaf_Hopper_Jassids: 0.7455, f1_Leaf_Redding: 0.6989, f1_Leaf_Variegation: 0.9032
2025-05-30 06:17:28 - __main__ - INFO - [main_execution_logic:310] - Epoch 18: f1_macro (0.7476) not improved. Patience: 17/20
2025-05-30 06:17:28 - __main__ - INFO - [main_execution_logic:316] - Epoch 18 completed in 56.42 seconds.
2025-05-30 06:17:28 - __main__ - INFO - [main_execution_logic:284] - Epoch 19: head LR set to 1.00e-05
2025-05-30 06:17:28 - __main__ - INFO - [main_execution_logic:284] - Epoch 19: backbone LR set to 5.00e-06
2025-05-30 06:17:30 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E19 B1: Scheduler step after optimizer step.
2025-05-30 06:17:31 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E19 B3: Scheduler step after optimizer step.
2025-05-30 06:17:32 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E19 B5: Scheduler step after optimizer step.
2025-05-30 06:17:33 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E19 B7: Scheduler step after optimizer step.
2025-05-30 06:17:34 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E19 B9: Scheduler step after optimizer step.
2025-05-30 06:17:35 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E19 B11: Scheduler step after optimizer step.
2025-05-30 06:17:36 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E19 B13: Scheduler step after optimizer step.
2025-05-30 06:17:37 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E19 B15: Scheduler step after optimizer step.
2025-05-30 06:17:38 - phase4_finetuning.finetune.trainer - DEBUG - [train_one_epoch:143] - E19 B17: Scheduler step after optimizer step.
2025-05-30 06:17:44 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:252] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/ft_resume_s7_20250530_060011/checkpoints/final_finetuned_hvt_resumed.pth with metadata (epoch=19, best_metric=0.8027889552733801)
2025-05-30 06:17:44 - __main__ - INFO - [main_execution_logic:325] - Training completed. Final checkpoint saved: /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune/ft_resume_s7_20250530_060011/checkpoints/final_finetuned_hvt_resumed.pth
2025-05-30 06:17:44 - __main__ - INFO - [main_execution_logic:326] - Best f1_macro: 0.8028
