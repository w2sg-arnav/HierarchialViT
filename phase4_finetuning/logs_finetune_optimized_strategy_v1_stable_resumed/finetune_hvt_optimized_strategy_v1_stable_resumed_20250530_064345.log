2025-05-30 06:43:45 - root - INFO - [setup_logging:75] - Logging configured. Log file: /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable_resumed/finetune_hvt_optimized_strategy_v1_stable_resumed_20250530_064345.log. Logger 'root' Effective Level: INFO
2025-05-30 06:43:45 - __main__ - INFO - [main_execution_logic:301] - ======== Starting Phase 4: HVT Fine-tuning (Run ID: 20250530_064345) ========
2025-05-30 06:43:45 - __main__ - INFO - [main_execution_logic:302] - Full run configuration loaded. Log dir: /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable_resumed
2025-05-30 06:43:45 - __main__ - WARNING - [main_execution_logic:304] - Detailed debugging (NaNs, Gradients) is ON. Log level might be verbose.
2025-05-30 06:43:45 - __main__ - INFO - [set_global_seed:68] - Global random seed set to: 42
2025-05-30 06:43:45 - __main__ - INFO - [main_execution_logic:311] - Using device: cuda. GPU: Tesla T4
2025-05-30 06:43:45 - __main__ - INFO - [main_execution_logic:314] - Set matmul_precision to high
2025-05-30 06:43:45 - phase4_finetuning.dataset - INFO - [__init__:54] - [DATASET INIT - train] Root: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection, ImgSize: (448, 448), Normalize: True
2025-05-30 06:43:45 - phase4_finetuning.dataset - INFO - [__init__:74] - [DATASET INIT - train] Scanning: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection/Original Dataset
2025-05-30 06:43:45 - phase4_finetuning.dataset - INFO - [__init__:74] - [DATASET INIT - train] Scanning: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection/Augmented Dataset
2025-05-30 06:43:45 - phase4_finetuning.dataset - INFO - [__init__:105] - [DATASET INIT - train] Total valid image paths collected: 9137 from ~9137 items considered.
2025-05-30 06:43:45 - phase4_finetuning.dataset - INFO - [__init__:117] - [DATASET INIT - train] Dataset split size: 7766 samples.
2025-05-30 06:43:45 - phase4_finetuning.dataset - INFO - [__init__:128] - [DATASET INIT - train] Base RGB Transforms: Compose(
      ToImage()
      ToDtype(scale=True)
      Resize(size=[448, 448], interpolation=InterpolationMode.BICUBIC, antialias=True)
      Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225], inplace=False)
)
2025-05-30 06:43:45 - phase4_finetuning.dataset - INFO - [__init__:54] - [DATASET INIT - val] Root: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection, ImgSize: (448, 448), Normalize: True
2025-05-30 06:43:45 - phase4_finetuning.dataset - INFO - [__init__:74] - [DATASET INIT - val] Scanning: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection/Original Dataset
2025-05-30 06:43:45 - phase4_finetuning.dataset - INFO - [__init__:74] - [DATASET INIT - val] Scanning: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection/Augmented Dataset
2025-05-30 06:43:46 - phase4_finetuning.dataset - INFO - [__init__:105] - [DATASET INIT - val] Total valid image paths collected: 9137 from ~9137 items considered.
2025-05-30 06:43:46 - phase4_finetuning.dataset - INFO - [__init__:117] - [DATASET INIT - val] Dataset split size: 1371 samples.
2025-05-30 06:43:46 - phase4_finetuning.dataset - INFO - [__init__:128] - [DATASET INIT - val] Base RGB Transforms: Compose(
      ToImage()
      ToDtype(scale=True)
      Resize(size=[448, 448], interpolation=InterpolationMode.BICUBIC, antialias=True)
      Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225], inplace=False)
)
2025-05-30 06:43:46 - __main__ - INFO - [main_execution_logic:325] - Datasets loaded. Train samples: 7766, Val samples: 1371. Classes: ['Bacterial Blight', 'Curl Virus', 'Healthy Leaf', 'Herbicide Growth Damage', 'Leaf Hopper Jassids', 'Leaf Redding', 'Leaf Variegation']
2025-05-30 06:43:46 - __main__ - INFO - [main_execution_logic:340] - Using WeightedRandomSampler with 'sqrt_inv_count' mode. Per-class weights: [0.031 0.029 0.031 0.03  0.031 0.027 0.032]
2025-05-30 06:43:46 - __main__ - INFO - [main_execution_logic:351] - WeightedRandomSampler enabled (mode: sqrt_inv_count).
2025-05-30 06:43:46 - __main__ - INFO - [main_execution_logic:358] - Dataloaders created. Train batches: 970, Val batches: 172
2025-05-30 06:43:46 - phase2_model.models.hvt - INFO - [create_disease_aware_hvt:602] - Factory: Creating DiseaseAwareHVT for img_size: (448, 448), num_classes: 7
2025-05-30 06:43:49 - phase2_model.models.hvt - INFO - [__init__:325] - HVT: Running RGB stream only. No fusion.
2025-05-30 06:43:51 - phase2_model.models.hvt - INFO - [__init__:359] - DiseaseAwareHVT initialized for image size (448, 448) and 7 classes.
2025-05-30 06:43:51 - __main__ - INFO - [main_execution_logic:366] - Attempting to load finetuning checkpoint from: /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth
2025-05-30 06:43:52 - __main__ - INFO - [main_execution_logic:379] - Checkpoint appears to be a model state_dict (old format). Loading model weights.
2025-05-30 06:43:52 - __main__ - INFO - [main_execution_logic:385] - Model state loaded from old format finetuning checkpoint. SSL backbone loading will be skipped.
2025-05-30 06:43:53 - __main__ - INFO - [main_execution_logic:401] - Model ready. Total params: 273,615,751, Trainable params: 273,615,751
2025-05-30 06:43:53 - phase4_finetuning.utils.augmentations - INFO - [create_augmentation:268] - Creating augmentation strategy: 'stable_enhanced' with img_size: (448, 448), kwargs: {'severity': 'moderate'}
2025-05-30 06:43:53 - phase4_finetuning.utils.augmentations - INFO - [__init__:124] - StableEnhancedFinetuneAugmentation initialized with 'moderate' severity for stability.
2025-05-30 06:43:53 - phase4_finetuning.dataset - INFO - [get_class_weights:196] - Computed class weights (inv_freq for loss) for split 'train': [1.034 0.905 1.061 1.02  1.065 0.829 1.164]
2025-05-30 06:43:53 - __main__ - INFO - [main_execution_logic:421] - Using weighted CrossEntropyLoss. Weights: [1.034 0.905 1.061 1.02  1.065 0.829 1.164]
2025-05-30 06:43:53 - __main__ - INFO - [main_execution_logic:451] - Optimizer: AdamW created with overall defaults: {'lr': 0.0001, 'betas': (0.9, 0.999), 'eps': 1e-07, 'weight_decay': 0.05, 'amsgrad': False, 'foreach': None, 'maximize': False, 'capturable': False, 'differentiable': False, 'fused': None}
2025-05-30 06:43:53 - __main__ - INFO - [main_execution_logic:454] -   Group 'head': Initial LR 1.00e-04, WD 5.00e-02
2025-05-30 06:43:53 - __main__ - INFO - [main_execution_logic:454] -   Group 'backbone': Initial LR 1.00e-05, WD 5.00e-02
2025-05-30 06:43:53 - __main__ - INFO - [main_execution_logic:472] - Scheduler: WarmupCosine (per-step). WU Steps: 2415, Total Steps: 32200
2025-05-30 06:43:53 - phase4_finetuning.finetune.trainer - INFO - [__init__:59] - Finetuner initialized: device=cuda, accum_steps=6, AMP=False
2025-05-30 06:43:53 - phase4_finetuning.finetune.trainer - INFO - [__init__:60] - Using training augmentations: StableEnhancedFinetuneAugmentation
2025-05-30 06:43:53 - phase4_finetuning.finetune.trainer - INFO - [__init__:61] - Test-Time Augmentation (TTA) enabled for validation.
2025-05-30 06:43:53 - phase4_finetuning.finetune.trainer - INFO - [__init__:62] - NaN detection enabled. Stop threshold: 5 NaNs/epoch.
2025-05-30 06:43:53 - phase4_finetuning.finetune.trainer - INFO - [__init__:63] - Gradient monitoring enabled. Log interval: 50 optimizer steps.
2025-05-30 06:43:54 - __main__ - WARNING - [main_execution_logic:520] - Finetune checkpoint /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable/checkpoints_optimized_strategy_v1_stable/best_finetuned_hvt_optimized_strategy_v1_stable.pth was old format (model weights only). Optimizer, scheduler, and epoch not resumed. Starting fresh for these.
2025-05-30 06:43:54 - __main__ - INFO - [main_execution_logic:562] - Checkpoints will be saved in: /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable_resumed/checkpoints_optimized_strategy_v1_stable_resumed
2025-05-30 06:43:54 - __main__ - INFO - [main_execution_logic:564] - Starting fine-tuning from epoch 1 up to 200 epochs. Monitor: 'f1_macro'. Initial Best: 0.0000
2025-05-30 06:46:02 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:162] - Epoch 1 training finished. Avg Loss: 0.9845, Final LR: 6.67e-06, Opt Steps: 161, NaN count: 0
2025-05-30 06:47:03 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8169, accuracy: 0.8177, f1_macro: 0.8176, f1_weighted: 0.8153, precision_macro: 0.8194, precision_weighted: 0.8185, recall_macro: 0.8212, recall_weighted: 0.8177, f1_Bacterial_Blight: 0.7227, f1_Curl_Virus: 0.7432, f1_Healthy_Leaf: 0.8308, f1_Herbicide_Growth_Damage: 0.9132, f1_Leaf_Hopper_Jassids: 0.7889, f1_Leaf_Redding: 0.7966, f1_Leaf_Variegation: 0.9281
2025-05-30 06:47:05 - phase4_finetuning.finetune.trainer - INFO - [save_checkpoint:260] - Checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable_resumed/checkpoints_optimized_strategy_v1_stable_resumed/best_finetuned_hvt_optimized_strategy_v1_stable_resumed.pth (Epoch 1, Best f1_macro: 0.8176)
2025-05-30 06:47:05 - __main__ - INFO - [main_execution_logic:655] - E1: New best! Val f1_macro: 0.8176
2025-05-30 06:47:05 - __main__ - INFO - [main_execution_logic:679] - Epoch 1 completed in 191.47s.
2025-05-30 06:49:16 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:162] - Epoch 2 training finished. Avg Loss: 0.9764, Final LR: 1.33e-05, Opt Steps: 161, NaN count: 0
2025-05-30 06:50:18 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8233, accuracy: 0.8184, f1_macro: 0.8183, f1_weighted: 0.8162, precision_macro: 0.8207, precision_weighted: 0.8205, recall_macro: 0.8220, recall_weighted: 0.8184, f1_Bacterial_Blight: 0.7131, f1_Curl_Virus: 0.7547, f1_Healthy_Leaf: 0.8251, f1_Herbicide_Growth_Damage: 0.9132, f1_Leaf_Hopper_Jassids: 0.7955, f1_Leaf_Redding: 0.8009, f1_Leaf_Variegation: 0.9258
2025-05-30 06:50:22 - phase4_finetuning.finetune.trainer - INFO - [save_checkpoint:260] - Checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable_resumed/checkpoints_optimized_strategy_v1_stable_resumed/best_finetuned_hvt_optimized_strategy_v1_stable_resumed.pth (Epoch 2, Best f1_macro: 0.8183)
2025-05-30 06:50:22 - __main__ - INFO - [main_execution_logic:655] - E2: New best! Val f1_macro: 0.8183
2025-05-30 06:50:22 - __main__ - INFO - [main_execution_logic:679] - Epoch 2 completed in 196.56s.
2025-05-30 06:52:33 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:162] - Epoch 3 training finished. Avg Loss: 0.9785, Final LR: 2.00e-05, Opt Steps: 161, NaN count: 0
2025-05-30 06:53:35 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8246, accuracy: 0.8191, f1_macro: 0.8191, f1_weighted: 0.8171, precision_macro: 0.8205, precision_weighted: 0.8209, recall_macro: 0.8233, recall_weighted: 0.8191, f1_Bacterial_Blight: 0.7151, f1_Curl_Virus: 0.7660, f1_Healthy_Leaf: 0.8279, f1_Herbicide_Growth_Damage: 0.9109, f1_Leaf_Hopper_Jassids: 0.7911, f1_Leaf_Redding: 0.7973, f1_Leaf_Variegation: 0.9258
2025-05-30 06:53:39 - phase4_finetuning.finetune.trainer - INFO - [save_checkpoint:260] - Checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable_resumed/checkpoints_optimized_strategy_v1_stable_resumed/best_finetuned_hvt_optimized_strategy_v1_stable_resumed.pth (Epoch 3, Best f1_macro: 0.8191)
2025-05-30 06:53:39 - __main__ - INFO - [main_execution_logic:655] - E3: New best! Val f1_macro: 0.8191
2025-05-30 06:53:39 - __main__ - INFO - [main_execution_logic:679] - Epoch 3 completed in 197.17s.
2025-05-30 06:55:50 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:162] - Epoch 4 training finished. Avg Loss: 0.9709, Final LR: 2.67e-05, Opt Steps: 161, NaN count: 0
2025-05-30 06:56:52 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8237, accuracy: 0.8155, f1_macro: 0.8157, f1_weighted: 0.8135, precision_macro: 0.8165, precision_weighted: 0.8170, recall_macro: 0.8202, recall_weighted: 0.8155, f1_Bacterial_Blight: 0.7182, f1_Curl_Virus: 0.7553, f1_Healthy_Leaf: 0.8186, f1_Herbicide_Growth_Damage: 0.9064, f1_Leaf_Hopper_Jassids: 0.7911, f1_Leaf_Redding: 0.7973, f1_Leaf_Variegation: 0.9231
2025-05-30 06:56:52 - __main__ - INFO - [main_execution_logic:658] - E4: Val f1_macro (0.8157) not better. Patience: 1/30
2025-05-30 06:56:52 - __main__ - INFO - [main_execution_logic:679] - Epoch 4 completed in 193.44s.
2025-05-30 06:59:04 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:162] - Epoch 5 training finished. Avg Loss: 0.9845, Final LR: 3.33e-05, Opt Steps: 161, NaN count: 0
2025-05-30 07:00:05 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8246, accuracy: 0.8191, f1_macro: 0.8195, f1_weighted: 0.8172, precision_macro: 0.8204, precision_weighted: 0.8210, recall_macro: 0.8240, recall_weighted: 0.8191, f1_Bacterial_Blight: 0.7222, f1_Curl_Virus: 0.7634, f1_Healthy_Leaf: 0.8230, f1_Herbicide_Growth_Damage: 0.9109, f1_Leaf_Hopper_Jassids: 0.7935, f1_Leaf_Redding: 0.7973, f1_Leaf_Variegation: 0.9258
2025-05-30 07:00:09 - phase4_finetuning.finetune.trainer - INFO - [save_checkpoint:260] - Checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable_resumed/checkpoints_optimized_strategy_v1_stable_resumed/best_finetuned_hvt_optimized_strategy_v1_stable_resumed.pth (Epoch 5, Best f1_macro: 0.8195)
2025-05-30 07:00:09 - __main__ - INFO - [main_execution_logic:655] - E5: New best! Val f1_macro: 0.8195
2025-05-30 07:00:09 - __main__ - INFO - [main_execution_logic:679] - Epoch 5 completed in 196.69s.
2025-05-30 07:00:09 - __main__ - INFO - [main_execution_logic:600] - Epoch 6: Backbone UNPROZEN. Updating LRs for unfrozen phase.
2025-05-30 07:00:09 - __main__ - INFO - [main_execution_logic:612] -   Updating optimizer group 'head' LR to 1.00e-04
2025-05-30 07:00:09 - __main__ - INFO - [main_execution_logic:612] -   Updating optimizer group 'backbone' LR to 1.00e-05
2025-05-30 07:00:09 - __main__ - INFO - [main_execution_logic:623] -   Effective LRs after unfreezing update:
2025-05-30 07:00:09 - __main__ - INFO - [main_execution_logic:625] -     Opt Group 0 ('head'): LR 1.000e-04, Scheduler base 1.000e-04
2025-05-30 07:00:09 - __main__ - INFO - [main_execution_logic:625] -     Opt Group 1 ('backbone'): LR 1.000e-05, Scheduler base 1.000e-05
2025-05-30 07:08:17 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:162] - Epoch 6 training finished. Avg Loss: 0.9821, Final LR: 4.00e-05, Opt Steps: 161, NaN count: 0
2025-05-30 07:09:18 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8363, accuracy: 0.8118, f1_macro: 0.8111, f1_weighted: 0.8093, precision_macro: 0.8139, precision_weighted: 0.8136, recall_macro: 0.8148, recall_weighted: 0.8118, f1_Bacterial_Blight: 0.6954, f1_Curl_Virus: 0.7573, f1_Healthy_Leaf: 0.8129, f1_Herbicide_Growth_Damage: 0.8981, f1_Leaf_Hopper_Jassids: 0.7829, f1_Leaf_Redding: 0.8026, f1_Leaf_Variegation: 0.9286
2025-05-30 07:09:18 - __main__ - INFO - [main_execution_logic:658] - E6: Val f1_macro (0.8111) not better. Patience: 1/30
2025-05-30 07:09:18 - __main__ - INFO - [main_execution_logic:679] - Epoch 6 completed in 549.34s.
2025-05-30 07:17:25 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:162] - Epoch 7 training finished. Avg Loss: 0.9608, Final LR: 4.67e-05, Opt Steps: 161, NaN count: 0
2025-05-30 07:18:27 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8483, accuracy: 0.8082, f1_macro: 0.8072, f1_weighted: 0.8058, precision_macro: 0.8121, precision_weighted: 0.8131, recall_macro: 0.8115, recall_weighted: 0.8082, f1_Bacterial_Blight: 0.6897, f1_Curl_Virus: 0.7664, f1_Healthy_Leaf: 0.8025, f1_Herbicide_Growth_Damage: 0.8916, f1_Leaf_Hopper_Jassids: 0.7778, f1_Leaf_Redding: 0.8045, f1_Leaf_Variegation: 0.9176
2025-05-30 07:18:27 - __main__ - INFO - [main_execution_logic:658] - E7: Val f1_macro (0.8072) not better. Patience: 2/30
2025-05-30 07:18:27 - __main__ - INFO - [main_execution_logic:679] - Epoch 7 completed in 548.36s.
2025-05-30 07:26:34 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:162] - Epoch 8 training finished. Avg Loss: 0.9688, Final LR: 5.33e-05, Opt Steps: 161, NaN count: 0
2025-05-30 07:27:36 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8400, accuracy: 0.8147, f1_macro: 0.8137, f1_weighted: 0.8120, precision_macro: 0.8151, precision_weighted: 0.8151, recall_macro: 0.8180, recall_weighted: 0.8147, f1_Bacterial_Blight: 0.7106, f1_Curl_Virus: 0.7513, f1_Healthy_Leaf: 0.8296, f1_Herbicide_Growth_Damage: 0.8894, f1_Leaf_Hopper_Jassids: 0.7841, f1_Leaf_Redding: 0.8053, f1_Leaf_Variegation: 0.9254
2025-05-30 07:27:36 - __main__ - INFO - [main_execution_logic:658] - E8: Val f1_macro (0.8137) not better. Patience: 3/30
2025-05-30 07:27:36 - __main__ - INFO - [main_execution_logic:679] - Epoch 8 completed in 548.86s.
2025-05-30 07:35:43 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:162] - Epoch 9 training finished. Avg Loss: 0.9619, Final LR: 6.00e-05, Opt Steps: 161, NaN count: 0
2025-05-30 07:36:44 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8466, accuracy: 0.8140, f1_macro: 0.8143, f1_weighted: 0.8121, precision_macro: 0.8187, precision_weighted: 0.8195, recall_macro: 0.8183, recall_weighted: 0.8140, f1_Bacterial_Blight: 0.7147, f1_Curl_Virus: 0.7772, f1_Healthy_Leaf: 0.8008, f1_Herbicide_Growth_Damage: 0.9104, f1_Leaf_Hopper_Jassids: 0.7819, f1_Leaf_Redding: 0.7945, f1_Leaf_Variegation: 0.9204
2025-05-30 07:36:44 - __main__ - INFO - [main_execution_logic:658] - E9: Val f1_macro (0.8143) not better. Patience: 4/30
2025-05-30 07:36:44 - __main__ - INFO - [main_execution_logic:679] - Epoch 9 completed in 548.79s.
2025-05-30 07:44:52 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:162] - Epoch 10 training finished. Avg Loss: 0.9505, Final LR: 6.67e-05, Opt Steps: 161, NaN count: 0
2025-05-30 07:45:54 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8493, accuracy: 0.8082, f1_macro: 0.8083, f1_weighted: 0.8057, precision_macro: 0.8104, precision_weighted: 0.8110, recall_macro: 0.8134, recall_weighted: 0.8082, f1_Bacterial_Blight: 0.7147, f1_Curl_Virus: 0.7326, f1_Healthy_Leaf: 0.8060, f1_Herbicide_Growth_Damage: 0.9069, f1_Leaf_Hopper_Jassids: 0.7910, f1_Leaf_Redding: 0.7891, f1_Leaf_Variegation: 0.9176
2025-05-30 07:45:54 - __main__ - INFO - [main_execution_logic:658] - E10: Val f1_macro (0.8083) not better. Patience: 5/30
2025-05-30 07:45:59 - phase4_finetuning.finetune.trainer - INFO - [save_checkpoint:260] - Checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable_resumed/checkpoints_optimized_strategy_v1_stable_resumed/checkpoint_epoch_10.pth (Epoch 10, Best f1_macro: 0.8195)
2025-05-30 07:45:59 - __main__ - INFO - [main_execution_logic:679] - Epoch 10 completed in 554.54s.
2025-05-30 07:54:07 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:162] - Epoch 11 training finished. Avg Loss: 0.9677, Final LR: 7.33e-05, Opt Steps: 161, NaN count: 0
2025-05-30 07:55:09 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8506, accuracy: 0.8118, f1_macro: 0.8109, f1_weighted: 0.8090, precision_macro: 0.8167, precision_weighted: 0.8178, recall_macro: 0.8163, recall_weighted: 0.8118, f1_Bacterial_Blight: 0.7088, f1_Curl_Virus: 0.7486, f1_Healthy_Leaf: 0.8095, f1_Herbicide_Growth_Damage: 0.9034, f1_Leaf_Hopper_Jassids: 0.7775, f1_Leaf_Redding: 0.8044, f1_Leaf_Variegation: 0.9240
2025-05-30 07:55:09 - __main__ - INFO - [main_execution_logic:658] - E11: Val f1_macro (0.8109) not better. Patience: 6/30
2025-05-30 07:55:09 - __main__ - INFO - [main_execution_logic:679] - Epoch 11 completed in 549.97s.
2025-05-30 08:03:16 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:162] - Epoch 12 training finished. Avg Loss: 0.9561, Final LR: 8.00e-05, Opt Steps: 161, NaN count: 0
2025-05-30 08:04:18 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8503, accuracy: 0.8118, f1_macro: 0.8096, f1_weighted: 0.8079, precision_macro: 0.8169, precision_weighted: 0.8170, recall_macro: 0.8149, recall_weighted: 0.8118, f1_Bacterial_Blight: 0.7055, f1_Curl_Virus: 0.7374, f1_Healthy_Leaf: 0.8117, f1_Herbicide_Growth_Damage: 0.8952, f1_Leaf_Hopper_Jassids: 0.7893, f1_Leaf_Redding: 0.8089, f1_Leaf_Variegation: 0.9194
2025-05-30 08:04:18 - __main__ - INFO - [main_execution_logic:658] - E12: Val f1_macro (0.8096) not better. Patience: 7/30
2025-05-30 08:04:18 - __main__ - INFO - [main_execution_logic:679] - Epoch 12 completed in 549.39s.
2025-05-30 08:12:25 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:162] - Epoch 13 training finished. Avg Loss: 0.9765, Final LR: 8.67e-05, Opt Steps: 161, NaN count: 0
2025-05-30 08:13:27 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8475, accuracy: 0.8067, f1_macro: 0.8045, f1_weighted: 0.8027, precision_macro: 0.8125, precision_weighted: 0.8113, recall_macro: 0.8088, recall_weighted: 0.8067, f1_Bacterial_Blight: 0.7108, f1_Curl_Virus: 0.7403, f1_Healthy_Leaf: 0.8033, f1_Herbicide_Growth_Damage: 0.8931, f1_Leaf_Hopper_Jassids: 0.7625, f1_Leaf_Redding: 0.8035, f1_Leaf_Variegation: 0.9176
2025-05-30 08:13:27 - __main__ - INFO - [main_execution_logic:658] - E13: Val f1_macro (0.8045) not better. Patience: 8/30
2025-05-30 08:13:27 - __main__ - INFO - [main_execution_logic:679] - Epoch 13 completed in 548.72s.
2025-05-30 08:21:34 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:162] - Epoch 14 training finished. Avg Loss: 0.9652, Final LR: 9.33e-05, Opt Steps: 161, NaN count: 0
2025-05-30 08:22:35 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8335, accuracy: 0.8213, f1_macro: 0.8215, f1_weighted: 0.8195, precision_macro: 0.8229, precision_weighted: 0.8237, recall_macro: 0.8253, recall_weighted: 0.8213, f1_Bacterial_Blight: 0.7221, f1_Curl_Virus: 0.7740, f1_Healthy_Leaf: 0.8243, f1_Herbicide_Growth_Damage: 0.9158, f1_Leaf_Hopper_Jassids: 0.7817, f1_Leaf_Redding: 0.8045, f1_Leaf_Variegation: 0.9277
2025-05-30 08:22:46 - phase4_finetuning.finetune.trainer - INFO - [save_checkpoint:260] - Checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable_resumed/checkpoints_optimized_strategy_v1_stable_resumed/best_finetuned_hvt_optimized_strategy_v1_stable_resumed.pth (Epoch 14, Best f1_macro: 0.8215)
2025-05-30 08:22:46 - __main__ - INFO - [main_execution_logic:655] - E14: New best! Val f1_macro: 0.8215
2025-05-30 08:22:46 - __main__ - INFO - [main_execution_logic:679] - Epoch 14 completed in 559.50s.
2025-05-30 08:30:54 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:162] - Epoch 15 training finished. Avg Loss: 0.9546, Final LR: 1.00e-04, Opt Steps: 161, NaN count: 0
2025-05-30 08:31:56 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8389, accuracy: 0.8118, f1_macro: 0.8110, f1_weighted: 0.8090, precision_macro: 0.8132, precision_weighted: 0.8146, recall_macro: 0.8170, recall_weighted: 0.8118, f1_Bacterial_Blight: 0.7170, f1_Curl_Virus: 0.7479, f1_Healthy_Leaf: 0.8428, f1_Herbicide_Growth_Damage: 0.8952, f1_Leaf_Hopper_Jassids: 0.7775, f1_Leaf_Redding: 0.7841, f1_Leaf_Variegation: 0.9123
2025-05-30 08:31:56 - __main__ - INFO - [main_execution_logic:658] - E15: Val f1_macro (0.8110) not better. Patience: 1/30
2025-05-30 08:31:56 - __main__ - INFO - [main_execution_logic:679] - Epoch 15 completed in 549.29s.
2025-05-30 08:40:02 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:162] - Epoch 16 training finished. Avg Loss: 0.9541, Final LR: 1.00e-04, Opt Steps: 161, NaN count: 0
2025-05-30 08:41:04 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8471, accuracy: 0.8118, f1_macro: 0.8129, f1_weighted: 0.8100, precision_macro: 0.8217, precision_weighted: 0.8212, recall_macro: 0.8162, recall_weighted: 0.8118, f1_Bacterial_Blight: 0.7236, f1_Curl_Virus: 0.7422, f1_Healthy_Leaf: 0.7862, f1_Herbicide_Growth_Damage: 0.9055, f1_Leaf_Hopper_Jassids: 0.7935, f1_Leaf_Redding: 0.8027, f1_Leaf_Variegation: 0.9366
2025-05-30 08:41:04 - __main__ - INFO - [main_execution_logic:658] - E16: Val f1_macro (0.8129) not better. Patience: 2/30
2025-05-30 08:41:04 - __main__ - INFO - [main_execution_logic:679] - Epoch 16 completed in 548.41s.
2025-05-30 08:49:11 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:162] - Epoch 17 training finished. Avg Loss: 0.9522, Final LR: 1.00e-04, Opt Steps: 161, NaN count: 0
2025-05-30 08:50:13 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8549, accuracy: 0.7987, f1_macro: 0.7978, f1_weighted: 0.7956, precision_macro: 0.8120, precision_weighted: 0.8111, recall_macro: 0.8012, recall_weighted: 0.7987, f1_Bacterial_Blight: 0.6930, f1_Curl_Virus: 0.7293, f1_Healthy_Leaf: 0.7722, f1_Herbicide_Growth_Damage: 0.9037, f1_Leaf_Hopper_Jassids: 0.7736, f1_Leaf_Redding: 0.7982, f1_Leaf_Variegation: 0.9145
2025-05-30 08:50:13 - __main__ - INFO - [main_execution_logic:658] - E17: Val f1_macro (0.7978) not better. Patience: 3/30
2025-05-30 08:50:13 - __main__ - INFO - [main_execution_logic:679] - Epoch 17 completed in 549.08s.
2025-05-30 08:58:20 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:162] - Epoch 18 training finished. Avg Loss: 0.9639, Final LR: 9.99e-05, Opt Steps: 161, NaN count: 0
2025-05-30 08:59:22 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8447, accuracy: 0.8082, f1_macro: 0.8072, f1_weighted: 0.8054, precision_macro: 0.8110, precision_weighted: 0.8109, recall_macro: 0.8112, recall_weighted: 0.8082, f1_Bacterial_Blight: 0.7049, f1_Curl_Virus: 0.7453, f1_Healthy_Leaf: 0.8051, f1_Herbicide_Growth_Damage: 0.9082, f1_Leaf_Hopper_Jassids: 0.7622, f1_Leaf_Redding: 0.8027, f1_Leaf_Variegation: 0.9222
2025-05-30 08:59:22 - __main__ - INFO - [main_execution_logic:658] - E18: Val f1_macro (0.8072) not better. Patience: 4/30
2025-05-30 08:59:22 - __main__ - INFO - [main_execution_logic:679] - Epoch 18 completed in 548.54s.
2025-05-30 09:07:29 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:162] - Epoch 19 training finished. Avg Loss: 0.9324, Final LR: 9.99e-05, Opt Steps: 161, NaN count: 0
2025-05-30 09:08:30 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:237] - Validation finished. Avg Loss: 0.8425, accuracy: 0.8038, f1_macro: 0.8035, f1_weighted: 0.8014, precision_macro: 0.8100, precision_weighted: 0.8117, recall_macro: 0.8085, recall_weighted: 0.8038, f1_Bacterial_Blight: 0.6821, f1_Curl_Virus: 0.7676, f1_Healthy_Leaf: 0.7918, f1_Herbicide_Growth_Damage: 0.9056, f1_Leaf_Hopper_Jassids: 0.7650, f1_Leaf_Redding: 0.7869, f1_Leaf_Variegation: 0.9254
2025-05-30 09:08:30 - __main__ - INFO - [main_execution_logic:658] - E19: Val f1_macro (0.8035) not better. Patience: 5/30
2025-05-30 09:08:30 - __main__ - INFO - [main_execution_logic:679] - Epoch 19 completed in 548.68s.
2025-05-30 09:12:47 - __main__ - WARNING - [main_execution_logic:682] - Fine-tuning interrupted by user. Last completed epoch: 19.
2025-05-30 09:12:47 - __main__ - INFO - [main_execution_logic:685] - Fine-tuning ended. Last completed epoch: 19.
2025-05-30 09:12:53 - phase4_finetuning.finetune.trainer - INFO - [save_checkpoint:260] - Checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_optimized_strategy_v1_stable_resumed/checkpoints_optimized_strategy_v1_stable_resumed/final_finetuned_hvt_optimized_strategy_v1_stable_resumed.pth (Epoch 19, Best f1_macro: 0.8215)
2025-05-30 09:12:53 - __main__ - INFO - [main_execution_logic:692] - Fine-tuning summary: Best validation 'f1_macro': 0.8215 (achieved over 19 trained epochs in this run).
