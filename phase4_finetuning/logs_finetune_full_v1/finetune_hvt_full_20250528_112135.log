2025-05-28 11:21:35 - root - INFO - [setup_logging:75] - Logging configured. Log file: /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_full_v1/finetune_hvt_full_20250528_112135.log. Logger 'root' Effective Level: DEBUG
2025-05-28 11:21:35 - __main__ - INFO - [main_execution_logic:186] - ======== Starting Phase 4: HVT Fine-tuning (Run ID: 20250528_112135) ========
2025-05-28 11:21:35 - __main__ - INFO - [main_execution_logic:187] - Full run configuration: {'seed': 42, 'device': 'cuda', 'log_dir': 'logs_finetune_full_v1', 'log_file_finetune': 'finetune_hvt_full.log', 'best_model_filename': 'best_finetuned_hvt_full.pth', 'final_model_filename': 'final_finetuned_hvt_full.pth', 'checkpoint_save_dir_name': 'checkpoints_full_v1', 'data_root': '/teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection', 'original_dataset_name': 'Original Dataset', 'augmented_dataset_name': 'Augmented Dataset', 'img_size': (448, 448), 'num_classes': 7, 'train_split_ratio': 0.8, 'normalize_data': True, 'use_weighted_sampler': True, 'num_workers': 4, 'prefetch_factor': 2, 'model_architecture_name': 'DiseaseAwareHVT_FullFinetune', 'pretrained_checkpoint_path': '/teamspace/studios/this_studio/cvpr25/phase3_pretraining/pretrain_checkpoints_hvt_xl/hvt_xl_simclr_t4_resumed_best_probe.pth', 'load_pretrained_backbone': True, 'freeze_backbone_epochs': 0, 'unfreeze_backbone_lr_factor': 0.1, 'hvt_params_for_model_init': {'patch_size': 14, 'embed_dim_rgb': 192, 'embed_dim_spectral': 192, 'spectral_channels': 0, 'depths': [3, 6, 24, 3], 'num_heads': [6, 12, 24, 48], 'mlp_ratio': 4.0, 'qkv_bias': True, 'model_drop_rate': 0.1, 'attn_drop_rate': 0.0, 'drop_path_rate': 0.1, 'norm_layer_name': 'LayerNorm', 'use_dfca': False, 'use_gradient_checkpointing': False, 'ssl_enable_mae': False, 'ssl_enable_contrastive': False, 'enable_consistency_loss_heads': False, 'dfca_embed_dim_match_rgb': True, 'dfca_num_heads': 32, 'dfca_drop_rate': 0.1, 'dfca_use_disease_mask': True, 'ssl_mae_mask_ratio': 0.75, 'ssl_mae_decoder_dim': 64, 'ssl_mae_norm_pix_loss': True, 'ssl_contrastive_projector_dim': 128, 'ssl_contrastive_projector_depth': 2}, 'enable_torch_compile': False, 'torch_compile_mode': 'reduce-overhead', 'matmul_precision': 'high', 'cudnn_benchmark': True, 'epochs': 200, 'batch_size': 16, 'accumulation_steps': 2, 'amp_enabled': True, 'clip_grad_norm': 1.0, 'log_interval': 10, 'optimizer': 'AdamW', 'learning_rate': 2e-05, 'head_lr_multiplier': 5.0, 'weight_decay': 0.05, 'optimizer_params': {'betas': (0.9, 0.999)}, 'scheduler': 'WarmupCosine', 'warmup_epochs': 5, 'eta_min_lr': 1e-07, 'loss_label_smoothing': 0.1, 'augmentations_enabled': True, 'evaluate_every_n_epochs': 1, 'early_stopping_patience': 15, 'metric_to_monitor_early_stopping': 'f1_macro', 'ssl_pretrain_img_size_fallback': (448, 448)}
2025-05-28 11:21:35 - __main__ - INFO - [set_global_seed:81] - Global random seed set to: 42
2025-05-28 11:21:35 - __main__ - INFO - [main_execution_logic:191] - Using device: cuda
2025-05-28 11:21:35 - __main__ - INFO - [main_execution_logic:192] - GPU: Tesla T4; CUDA Ver: 12.1
2025-05-28 11:21:35 - phase4_finetuning.dataset - INFO - [__init__:54] - [DATASET INIT - train] Root: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection, ImgSize: (448, 448)
2025-05-28 11:21:35 - phase4_finetuning.dataset - INFO - [__init__:67] - [DATASET INIT - train] Scanning: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection/Original Dataset
2025-05-28 11:21:35 - phase4_finetuning.dataset - INFO - [__init__:67] - [DATASET INIT - train] Scanning: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection/Augmented Dataset
2025-05-28 11:21:35 - phase4_finetuning.dataset - INFO - [__init__:98] - [DATASET INIT - train] Total valid image paths collected: 9137 from ~9137 items considered.
2025-05-28 11:21:35 - phase4_finetuning.dataset - INFO - [__init__:111] - [DATASET INIT - train] Dataset split size: 7309 samples.
2025-05-28 11:21:35 - phase4_finetuning.dataset - INFO - [__init__:123] - [DATASET INIT - train] Base RGB Transforms: Compose(
      ToImage()
      ToDtype(scale=False)
      Resize(size=[448, 448], interpolation=InterpolationMode.BICUBIC, antialias=True)
      Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225], inplace=False)
)
2025-05-28 11:21:35 - phase4_finetuning.dataset - INFO - [__init__:54] - [DATASET INIT - val] Root: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection, ImgSize: (448, 448)
2025-05-28 11:21:35 - phase4_finetuning.dataset - INFO - [__init__:67] - [DATASET INIT - val] Scanning: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection/Original Dataset
2025-05-28 11:21:36 - phase4_finetuning.dataset - INFO - [__init__:67] - [DATASET INIT - val] Scanning: /teamspace/studios/this_studio/cvpr25/SAR-CLD-2024 A Comprehensive Dataset for Cotton Leaf Disease Detection/Augmented Dataset
2025-05-28 11:21:36 - phase4_finetuning.dataset - INFO - [__init__:98] - [DATASET INIT - val] Total valid image paths collected: 9137 from ~9137 items considered.
2025-05-28 11:21:36 - phase4_finetuning.dataset - INFO - [__init__:111] - [DATASET INIT - val] Dataset split size: 1828 samples.
2025-05-28 11:21:36 - phase4_finetuning.dataset - INFO - [__init__:123] - [DATASET INIT - val] Base RGB Transforms: Compose(
      ToImage()
      ToDtype(scale=False)
      Resize(size=[448, 448], interpolation=InterpolationMode.BICUBIC, antialias=True)
      Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225], inplace=False)
)
2025-05-28 11:21:36 - phase4_finetuning.dataset - INFO - [get_class_weights:180] - Computed class weights for split 'train': [1.029 0.912 1.065 1.014 1.05  0.833 1.172]
2025-05-28 11:21:36 - __main__ - INFO - [main_execution_logic:207] - Using WeightedRandomSampler.
2025-05-28 11:21:36 - __main__ - INFO - [main_execution_logic:212] - Dataloaders created. Train batches: 456, Val batches: 115
2025-05-28 11:21:36 - phase2_model.models.hvt - INFO - [create_disease_aware_hvt:602] - Factory: Creating DiseaseAwareHVT for img_size: (448, 448), num_classes: 7
2025-05-28 11:21:39 - phase2_model.models.hvt - INFO - [__init__:325] - HVT: Running RGB stream only. No fusion.
2025-05-28 11:21:41 - phase2_model.models.hvt - INFO - [__init__:359] - DiseaseAwareHVT initialized for image size (448, 448) and 7 classes.
2025-05-28 11:21:41 - __main__.load_and_prepare_hvt_model - INFO - [load_and_prepare_hvt_model:126] - Loading SSL backbone weights from: /teamspace/studios/this_studio/cvpr25/phase3_pretraining/pretrain_checkpoints_hvt_xl/hvt_xl_simclr_t4_resumed_best_probe.pth
2025-05-28 11:21:44 - __main__.load_and_prepare_hvt_model - INFO - [load_and_prepare_hvt_model:136] - SSL and Finetune img_size match: (448, 448). No PE interpolation if patch counts same.
2025-05-28 11:21:44 - __main__.load_and_prepare_hvt_model - INFO - [load_and_prepare_hvt_model:154] - SSL Backbone weights loaded: 450 direct, 0 PE interp, 2 head skipped.
2025-05-28 11:21:44 - __main__.load_and_prepare_hvt_model - WARNING - [load_and_prepare_hvt_model:155] - Missing keys in backbone load: ['classifier_head.weight', 'classifier_head.bias']
2025-05-28 11:21:44 - __main__.load_and_prepare_hvt_model - INFO - [load_and_prepare_hvt_model:161] - Re-initialized HVT classifier_head for 7 classes (in_features=1536).
2025-05-28 11:21:45 - __main__ - INFO - [main_execution_logic:217] - Model ready. Total params: 273,615,751, Trainable params: 273,615,751
2025-05-28 11:21:45 - phase4_finetuning.utils.augmentations - INFO - [__init__:24] - FinetuneAugmentation initialized.
2025-05-28 11:21:45 - __main__ - INFO - [main_execution_logic:279] - Optimizer: AdamW. Initial Group LRs: [0.0001, 2.0000000000000003e-06], Group WDs: [0.05, 0.05]
2025-05-28 11:21:45 - __main__ - INFO - [main_execution_logic:293] - Scheduler: WarmupCosine (per-step). WU Steps: 1140, Total Steps: 45600
2025-05-28 11:21:45 - phase4_finetuning.finetune.trainer - INFO - [__init__:44] - Finetuner initialized: device=cuda, accum_steps=2, lr_sched_on_batch=True, AMP=True
2025-05-28 11:21:45 - phase4_finetuning.finetune.trainer - INFO - [__init__:46] - Using augmentations: FinetuneAugmentation
2025-05-28 11:21:45 - __main__ - INFO - [main_execution_logic:317] - Starting fine-tuning: 200 epochs. Monitor: 'f1_macro', Patience: 15.
2025-05-28 11:24:35 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 1 training finished. Avg Loss: 1.9948, Final LR for epoch: 2.00e-05, Opt Steps: 228
2025-05-28 11:24:55 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 2.0188, accuracy: 0.1138, f1_macro: 0.0504, f1_weighted: 0.0495, precision_macro: 0.0325, precision_weighted: 0.0321, recall_macro: 0.1182, recall_weighted: 0.1138, f1_Bacterial_Blight: 0.0000, f1_Curl_Virus: 0.1642, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.0000, f1_Leaf_Hopper_Jassids: 0.1888, f1_Leaf_Redding: 0.0000, f1_Leaf_Variegation: 0.0000
2025-05-28 11:24:58 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:173] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_full_v1/checkpoints_full_v1/best_finetuned_hvt_full.pth
2025-05-28 11:24:58 - __main__ - INFO - [main_execution_logic:361] - E1: New best! Val f1_macro: 0.0504
2025-05-28 11:24:58 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E1 End: Alloc 3161.6MB
2025-05-28 11:27:58 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 2 training finished. Avg Loss: 1.9337, Final LR for epoch: 4.00e-05, Opt Steps: 228
2025-05-28 11:28:18 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 2.0232, accuracy: 0.1439, f1_macro: 0.0413, f1_weighted: 0.0447, precision_macro: 0.0259, precision_weighted: 0.0277, recall_macro: 0.1318, recall_weighted: 0.1439, f1_Bacterial_Blight: 0.0000, f1_Curl_Virus: 0.2695, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.0000, f1_Leaf_Hopper_Jassids: 0.0197, f1_Leaf_Redding: 0.0000, f1_Leaf_Variegation: 0.0000
2025-05-28 11:28:18 - __main__ - INFO - [main_execution_logic:363] - E2: Val f1_macro (0.0413) not better than 0.0504. Patience: 1/15
2025-05-28 11:28:18 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E2 End: Alloc 3161.6MB
2025-05-28 11:31:06 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 3 training finished. Avg Loss: 1.9243, Final LR for epoch: 6.00e-05, Opt Steps: 228
2025-05-28 11:31:26 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 2.0118, accuracy: 0.1559, f1_macro: 0.0452, f1_weighted: 0.0487, precision_macro: 0.0418, precision_weighted: 0.0434, recall_macro: 0.1428, recall_weighted: 0.1559, f1_Bacterial_Blight: 0.0000, f1_Curl_Virus: 0.2758, f1_Healthy_Leaf: 0.0185, f1_Herbicide_Growth_Damage: 0.0000, f1_Leaf_Hopper_Jassids: 0.0219, f1_Leaf_Redding: 0.0000, f1_Leaf_Variegation: 0.0000
2025-05-28 11:31:26 - __main__ - INFO - [main_execution_logic:363] - E3: Val f1_macro (0.0452) not better than 0.0504. Patience: 2/15
2025-05-28 11:31:26 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E3 End: Alloc 3161.6MB
2025-05-28 11:34:15 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 4 training finished. Avg Loss: 1.9163, Final LR for epoch: 8.00e-05, Opt Steps: 228
2025-05-28 11:34:34 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 2.0325, accuracy: 0.1143, f1_macro: 0.0735, f1_weighted: 0.0742, precision_macro: 0.1538, precision_weighted: 0.1455, recall_macro: 0.1151, recall_weighted: 0.1143, f1_Bacterial_Blight: 0.0168, f1_Curl_Virus: 0.2553, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.1406, f1_Leaf_Hopper_Jassids: 0.1016, f1_Leaf_Redding: 0.0000, f1_Leaf_Variegation: 0.0000
2025-05-28 11:34:37 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:173] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_full_v1/checkpoints_full_v1/best_finetuned_hvt_full.pth
2025-05-28 11:34:37 - __main__ - INFO - [main_execution_logic:361] - E4: New best! Val f1_macro: 0.0735
2025-05-28 11:34:37 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E4 End: Alloc 3161.6MB
2025-05-28 11:37:26 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 5 training finished. Avg Loss: 1.9208, Final LR for epoch: 1.00e-04, Opt Steps: 228
2025-05-28 11:37:44 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9546, accuracy: 0.1603, f1_macro: 0.0976, f1_weighted: 0.0996, precision_macro: 0.2373, precision_weighted: 0.2304, recall_macro: 0.1589, recall_weighted: 0.1603, f1_Bacterial_Blight: 0.0085, f1_Curl_Virus: 0.3588, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.1996, f1_Leaf_Hopper_Jassids: 0.1104, f1_Leaf_Redding: 0.0061, f1_Leaf_Variegation: 0.0000
2025-05-28 11:37:48 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:173] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_full_v1/checkpoints_full_v1/best_finetuned_hvt_full.pth
2025-05-28 11:37:48 - __main__ - INFO - [main_execution_logic:361] - E5: New best! Val f1_macro: 0.0976
2025-05-28 11:37:48 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E5 End: Alloc 3161.6MB
2025-05-28 11:40:36 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 6 training finished. Avg Loss: 1.9217, Final LR for epoch: 1.00e-04, Opt Steps: 228
2025-05-28 11:40:55 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9429, accuracy: 0.1887, f1_macro: 0.1155, f1_weighted: 0.1142, precision_macro: 0.1120, precision_weighted: 0.1097, recall_macro: 0.1845, recall_weighted: 0.1887, f1_Bacterial_Blight: 0.3378, f1_Curl_Virus: 0.3067, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.0149, f1_Leaf_Hopper_Jassids: 0.1111, f1_Leaf_Redding: 0.0380, f1_Leaf_Variegation: 0.0000
2025-05-28 11:40:59 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:173] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_full_v1/checkpoints_full_v1/best_finetuned_hvt_full.pth
2025-05-28 11:40:59 - __main__ - INFO - [main_execution_logic:361] - E6: New best! Val f1_macro: 0.1155
2025-05-28 11:40:59 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E6 End: Alloc 3161.6MB
2025-05-28 11:43:47 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 7 training finished. Avg Loss: 1.9124, Final LR for epoch: 1.00e-04, Opt Steps: 228
2025-05-28 11:44:06 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9307, accuracy: 0.1718, f1_macro: 0.1276, f1_weighted: 0.1364, precision_macro: 0.1488, precision_weighted: 0.1507, recall_macro: 0.1572, recall_weighted: 0.1718, f1_Bacterial_Blight: 0.0967, f1_Curl_Virus: 0.3531, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.0990, f1_Leaf_Hopper_Jassids: 0.1142, f1_Leaf_Redding: 0.2301, f1_Leaf_Variegation: 0.0000
2025-05-28 11:44:09 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:173] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_full_v1/checkpoints_full_v1/best_finetuned_hvt_full.pth
2025-05-28 11:44:09 - __main__ - INFO - [main_execution_logic:361] - E7: New best! Val f1_macro: 0.1276
2025-05-28 11:44:09 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E7 End: Alloc 3161.6MB
2025-05-28 11:46:58 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 8 training finished. Avg Loss: 1.9157, Final LR for epoch: 9.99e-05, Opt Steps: 228
2025-05-28 11:47:17 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9474, accuracy: 0.1652, f1_macro: 0.0976, f1_weighted: 0.1077, precision_macro: 0.2034, precision_weighted: 0.1972, recall_macro: 0.1454, recall_weighted: 0.1652, f1_Bacterial_Blight: 0.0333, f1_Curl_Virus: 0.3715, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.0592, f1_Leaf_Hopper_Jassids: 0.0311, f1_Leaf_Redding: 0.1878, f1_Leaf_Variegation: 0.0000
2025-05-28 11:47:17 - __main__ - INFO - [main_execution_logic:363] - E8: Val f1_macro (0.0976) not better than 0.1276. Patience: 1/15
2025-05-28 11:47:17 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E8 End: Alloc 3161.6MB
2025-05-28 11:50:04 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 9 training finished. Avg Loss: 1.9080, Final LR for epoch: 9.99e-05, Opt Steps: 228
2025-05-28 11:50:23 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9261, accuracy: 0.1313, f1_macro: 0.0787, f1_weighted: 0.0833, precision_macro: 0.0614, precision_weighted: 0.0646, recall_macro: 0.1235, recall_weighted: 0.1313, f1_Bacterial_Blight: 0.0000, f1_Curl_Virus: 0.3127, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.1124, f1_Leaf_Hopper_Jassids: 0.0664, f1_Leaf_Redding: 0.0596, f1_Leaf_Variegation: 0.0000
2025-05-28 11:50:23 - __main__ - INFO - [main_execution_logic:363] - E9: Val f1_macro (0.0787) not better than 0.1276. Patience: 2/15
2025-05-28 11:50:23 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E9 End: Alloc 3161.6MB
2025-05-28 11:53:11 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 10 training finished. Avg Loss: 1.9066, Final LR for epoch: 9.98e-05, Opt Steps: 228
2025-05-28 11:53:29 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9307, accuracy: 0.1761, f1_macro: 0.1205, f1_weighted: 0.1288, precision_macro: 0.1531, precision_weighted: 0.1527, recall_macro: 0.1594, recall_weighted: 0.1761, f1_Bacterial_Blight: 0.1857, f1_Curl_Virus: 0.3856, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.0900, f1_Leaf_Hopper_Jassids: 0.0000, f1_Leaf_Redding: 0.1821, f1_Leaf_Variegation: 0.0000
2025-05-28 11:53:29 - __main__ - INFO - [main_execution_logic:363] - E10: Val f1_macro (0.1205) not better than 0.1276. Patience: 3/15
2025-05-28 11:53:29 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E10 End: Alloc 3161.6MB
2025-05-28 11:56:17 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 11 training finished. Avg Loss: 1.9005, Final LR for epoch: 9.98e-05, Opt Steps: 228
2025-05-28 11:56:37 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9384, accuracy: 0.1329, f1_macro: 0.0836, f1_weighted: 0.0896, precision_macro: 0.1342, precision_weighted: 0.1319, recall_macro: 0.1229, recall_weighted: 0.1329, f1_Bacterial_Blight: 0.0565, f1_Curl_Virus: 0.3346, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.0877, f1_Leaf_Hopper_Jassids: 0.0000, f1_Leaf_Redding: 0.0909, f1_Leaf_Variegation: 0.0156
2025-05-28 11:56:37 - __main__ - INFO - [main_execution_logic:363] - E11: Val f1_macro (0.0836) not better than 0.1276. Patience: 4/15
2025-05-28 11:56:37 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E11 End: Alloc 3161.6MB
2025-05-28 11:59:25 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 12 training finished. Avg Loss: 1.9107, Final LR for epoch: 9.97e-05, Opt Steps: 228
2025-05-28 11:59:43 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9172, accuracy: 0.1526, f1_macro: 0.0963, f1_weighted: 0.0985, precision_macro: 0.1231, precision_weighted: 0.1202, recall_macro: 0.1447, recall_weighted: 0.1526, f1_Bacterial_Blight: 0.0896, f1_Curl_Virus: 0.3182, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.0464, f1_Leaf_Hopper_Jassids: 0.1309, f1_Leaf_Redding: 0.0630, f1_Leaf_Variegation: 0.0259
2025-05-28 11:59:43 - __main__ - INFO - [main_execution_logic:363] - E12: Val f1_macro (0.0963) not better than 0.1276. Patience: 5/15
2025-05-28 11:59:43 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E12 End: Alloc 3161.6MB
2025-05-28 12:02:31 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 13 training finished. Avg Loss: 1.8968, Final LR for epoch: 9.96e-05, Opt Steps: 228
2025-05-28 12:02:50 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9373, accuracy: 0.2166, f1_macro: 0.1237, f1_weighted: 0.1379, precision_macro: 0.1156, precision_weighted: 0.1238, recall_macro: 0.1887, recall_weighted: 0.2166, f1_Bacterial_Blight: 0.0081, f1_Curl_Virus: 0.4276, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.0204, f1_Leaf_Hopper_Jassids: 0.1086, f1_Leaf_Redding: 0.3014, f1_Leaf_Variegation: 0.0000
2025-05-28 12:02:50 - __main__ - INFO - [main_execution_logic:363] - E13: Val f1_macro (0.1237) not better than 0.1276. Patience: 6/15
2025-05-28 12:02:50 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E13 End: Alloc 3161.6MB
2025-05-28 12:05:38 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 14 training finished. Avg Loss: 1.9024, Final LR for epoch: 9.95e-05, Opt Steps: 228
2025-05-28 12:05:57 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9438, accuracy: 0.2133, f1_macro: 0.1323, f1_weighted: 0.1429, precision_macro: 0.1099, precision_weighted: 0.1158, recall_macro: 0.1923, recall_weighted: 0.2133, f1_Bacterial_Blight: 0.2682, f1_Curl_Virus: 0.3957, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.0000, f1_Leaf_Hopper_Jassids: 0.0000, f1_Leaf_Redding: 0.2624, f1_Leaf_Variegation: 0.0000
2025-05-28 12:06:01 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:173] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_full_v1/checkpoints_full_v1/best_finetuned_hvt_full.pth
2025-05-28 12:06:01 - __main__ - INFO - [main_execution_logic:361] - E14: New best! Val f1_macro: 0.1323
2025-05-28 12:06:01 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E14 End: Alloc 3161.6MB
2025-05-28 12:08:49 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 15 training finished. Avg Loss: 1.8941, Final LR for epoch: 9.94e-05, Opt Steps: 228
2025-05-28 12:09:07 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.8834, accuracy: 0.2095, f1_macro: 0.1474, f1_weighted: 0.1558, precision_macro: 0.1344, precision_weighted: 0.1380, recall_macro: 0.1924, recall_weighted: 0.2095, f1_Bacterial_Blight: 0.2995, f1_Curl_Virus: 0.3972, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.0852, f1_Leaf_Hopper_Jassids: 0.0144, f1_Leaf_Redding: 0.2353, f1_Leaf_Variegation: 0.0000
2025-05-28 12:09:11 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:173] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_full_v1/checkpoints_full_v1/best_finetuned_hvt_full.pth
2025-05-28 12:09:11 - __main__ - INFO - [main_execution_logic:361] - E15: New best! Val f1_macro: 0.1474
2025-05-28 12:09:11 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E15 End: Alloc 3161.6MB
2025-05-28 12:11:59 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 16 training finished. Avg Loss: 1.8997, Final LR for epoch: 9.92e-05, Opt Steps: 228
2025-05-28 12:12:18 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9212, accuracy: 0.2019, f1_macro: 0.1675, f1_weighted: 0.1738, precision_macro: 0.1959, precision_weighted: 0.1999, recall_macro: 0.1926, recall_weighted: 0.2019, f1_Bacterial_Blight: 0.2552, f1_Curl_Virus: 0.3341, f1_Healthy_Leaf: 0.2741, f1_Herbicide_Growth_Damage: 0.1892, f1_Leaf_Hopper_Jassids: 0.0000, f1_Leaf_Redding: 0.1203, f1_Leaf_Variegation: 0.0000
2025-05-28 12:12:21 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:173] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_full_v1/checkpoints_full_v1/best_finetuned_hvt_full.pth
2025-05-28 12:12:21 - __main__ - INFO - [main_execution_logic:361] - E16: New best! Val f1_macro: 0.1675
2025-05-28 12:12:21 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E16 End: Alloc 3161.6MB
2025-05-28 12:15:09 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 17 training finished. Avg Loss: 1.8945, Final LR for epoch: 9.91e-05, Opt Steps: 228
2025-05-28 12:15:27 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9677, accuracy: 0.1318, f1_macro: 0.0807, f1_weighted: 0.0847, precision_macro: 0.1483, precision_weighted: 0.1423, recall_macro: 0.1231, recall_weighted: 0.1318, f1_Bacterial_Blight: 0.0791, f1_Curl_Virus: 0.3118, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.0965, f1_Leaf_Hopper_Jassids: 0.0084, f1_Leaf_Redding: 0.0563, f1_Leaf_Variegation: 0.0126
2025-05-28 12:15:27 - __main__ - INFO - [main_execution_logic:363] - E17: Val f1_macro (0.0807) not better than 0.1675. Patience: 1/15
2025-05-28 12:15:27 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E17 End: Alloc 3161.6MB
2025-05-28 12:18:15 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 18 training finished. Avg Loss: 1.9000, Final LR for epoch: 9.89e-05, Opt Steps: 228
2025-05-28 12:18:32 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9018, accuracy: 0.1975, f1_macro: 0.1291, f1_weighted: 0.1418, precision_macro: 0.2994, precision_weighted: 0.3143, recall_macro: 0.1714, recall_weighted: 0.1975, f1_Bacterial_Blight: 0.0738, f1_Curl_Virus: 0.3057, f1_Healthy_Leaf: 0.0072, f1_Herbicide_Growth_Damage: 0.1200, f1_Leaf_Hopper_Jassids: 0.0479, f1_Leaf_Redding: 0.3312, f1_Leaf_Variegation: 0.0177
2025-05-28 12:18:32 - __main__ - INFO - [main_execution_logic:363] - E18: Val f1_macro (0.1291) not better than 0.1675. Patience: 2/15
2025-05-28 12:18:32 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E18 End: Alloc 3161.6MB
2025-05-28 12:21:21 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 19 training finished. Avg Loss: 1.8988, Final LR for epoch: 9.87e-05, Opt Steps: 228
2025-05-28 12:21:39 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.8816, accuracy: 0.2801, f1_macro: 0.1986, f1_weighted: 0.2174, precision_macro: 0.1846, precision_weighted: 0.1982, recall_macro: 0.2535, recall_weighted: 0.2801, f1_Bacterial_Blight: 0.0000, f1_Curl_Virus: 0.3587, f1_Healthy_Leaf: 0.4244, f1_Herbicide_Growth_Damage: 0.2530, f1_Leaf_Hopper_Jassids: 0.0083, f1_Leaf_Redding: 0.3459, f1_Leaf_Variegation: 0.0000
2025-05-28 12:21:43 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:173] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_full_v1/checkpoints_full_v1/best_finetuned_hvt_full.pth
2025-05-28 12:21:43 - __main__ - INFO - [main_execution_logic:361] - E19: New best! Val f1_macro: 0.1986
2025-05-28 12:21:43 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E19 End: Alloc 3161.6MB
2025-05-28 12:24:31 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 20 training finished. Avg Loss: 1.8980, Final LR for epoch: 9.85e-05, Opt Steps: 228
2025-05-28 12:24:49 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9009, accuracy: 0.1931, f1_macro: 0.1485, f1_weighted: 0.1520, precision_macro: 0.1922, precision_weighted: 0.1973, recall_macro: 0.1867, recall_weighted: 0.1931, f1_Bacterial_Blight: 0.2609, f1_Curl_Virus: 0.3337, f1_Healthy_Leaf: 0.0211, f1_Herbicide_Growth_Damage: 0.2116, f1_Leaf_Hopper_Jassids: 0.0466, f1_Leaf_Redding: 0.1450, f1_Leaf_Variegation: 0.0205
2025-05-28 12:24:49 - __main__ - INFO - [main_execution_logic:363] - E20: Val f1_macro (0.1485) not better than 0.1986. Patience: 1/15
2025-05-28 12:24:49 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E20 End: Alloc 3161.6MB
2025-05-28 12:27:37 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 21 training finished. Avg Loss: 1.8963, Final LR for epoch: 9.83e-05, Opt Steps: 228
2025-05-28 12:27:55 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9054, accuracy: 0.2128, f1_macro: 0.1413, f1_weighted: 0.1528, precision_macro: 0.1582, precision_weighted: 0.1631, recall_macro: 0.1865, recall_weighted: 0.2128, f1_Bacterial_Blight: 0.1342, f1_Curl_Virus: 0.3247, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.1378, f1_Leaf_Hopper_Jassids: 0.0709, f1_Leaf_Redding: 0.3213, f1_Leaf_Variegation: 0.0000
2025-05-28 12:27:55 - __main__ - INFO - [main_execution_logic:363] - E21: Val f1_macro (0.1413) not better than 0.1986. Patience: 2/15
2025-05-28 12:27:55 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E21 End: Alloc 3161.6MB
2025-05-28 12:30:43 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 22 training finished. Avg Loss: 1.8928, Final LR for epoch: 9.81e-05, Opt Steps: 228
2025-05-28 12:31:01 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.8973, accuracy: 0.2374, f1_macro: 0.1775, f1_weighted: 0.1858, precision_macro: 0.1705, precision_weighted: 0.1733, recall_macro: 0.2218, recall_weighted: 0.2374, f1_Bacterial_Blight: 0.2656, f1_Curl_Virus: 0.3655, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.2618, f1_Leaf_Hopper_Jassids: 0.0641, f1_Leaf_Redding: 0.2851, f1_Leaf_Variegation: 0.0000
2025-05-28 12:31:01 - __main__ - INFO - [main_execution_logic:363] - E22: Val f1_macro (0.1775) not better than 0.1986. Patience: 3/15
2025-05-28 12:31:01 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E22 End: Alloc 3161.6MB
2025-05-28 12:33:49 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 23 training finished. Avg Loss: 1.8814, Final LR for epoch: 9.79e-05, Opt Steps: 228
2025-05-28 12:34:07 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9227, accuracy: 0.2593, f1_macro: 0.1895, f1_weighted: 0.1962, precision_macro: 0.1878, precision_weighted: 0.1920, recall_macro: 0.2539, recall_weighted: 0.2593, f1_Bacterial_Blight: 0.3541, f1_Curl_Virus: 0.3181, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.3382, f1_Leaf_Hopper_Jassids: 0.0082, f1_Leaf_Redding: 0.2912, f1_Leaf_Variegation: 0.0165
2025-05-28 12:34:07 - __main__ - INFO - [main_execution_logic:363] - E23: Val f1_macro (0.1895) not better than 0.1986. Patience: 4/15
2025-05-28 12:34:07 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E23 End: Alloc 3161.6MB
2025-05-28 12:36:55 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 24 training finished. Avg Loss: 1.8968, Final LR for epoch: 9.77e-05, Opt Steps: 228
2025-05-28 12:37:13 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.8856, accuracy: 0.2620, f1_macro: 0.1975, f1_weighted: 0.2049, precision_macro: 0.2020, precision_weighted: 0.2131, recall_macro: 0.2536, recall_weighted: 0.2620, f1_Bacterial_Blight: 0.3380, f1_Curl_Virus: 0.3445, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.3453, f1_Leaf_Hopper_Jassids: 0.0203, f1_Leaf_Redding: 0.3061, f1_Leaf_Variegation: 0.0283
2025-05-28 12:37:13 - __main__ - INFO - [main_execution_logic:363] - E24: Val f1_macro (0.1975) not better than 0.1986. Patience: 5/15
2025-05-28 12:37:13 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E24 End: Alloc 3161.6MB
2025-05-28 12:40:01 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 25 training finished. Avg Loss: 1.8922, Final LR for epoch: 9.74e-05, Opt Steps: 228
2025-05-28 12:40:18 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9200, accuracy: 0.2319, f1_macro: 0.1666, f1_weighted: 0.1696, precision_macro: 0.2975, precision_weighted: 0.2907, recall_macro: 0.2265, recall_weighted: 0.2319, f1_Bacterial_Blight: 0.2353, f1_Curl_Virus: 0.3247, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.3291, f1_Leaf_Hopper_Jassids: 0.0809, f1_Leaf_Redding: 0.1699, f1_Leaf_Variegation: 0.0262
2025-05-28 12:40:18 - __main__ - INFO - [main_execution_logic:363] - E25: Val f1_macro (0.1666) not better than 0.1986. Patience: 6/15
2025-05-28 12:40:18 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E25 End: Alloc 3161.6MB
2025-05-28 12:43:06 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 26 training finished. Avg Loss: 1.8931, Final LR for epoch: 9.72e-05, Opt Steps: 228
2025-05-28 12:43:24 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9284, accuracy: 0.2374, f1_macro: 0.1585, f1_weighted: 0.1680, precision_macro: 0.2143, precision_weighted: 0.2128, recall_macro: 0.2234, recall_weighted: 0.2374, f1_Bacterial_Blight: 0.1012, f1_Curl_Virus: 0.3193, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.3556, f1_Leaf_Hopper_Jassids: 0.0366, f1_Leaf_Redding: 0.2814, f1_Leaf_Variegation: 0.0155
2025-05-28 12:43:24 - __main__ - INFO - [main_execution_logic:363] - E26: Val f1_macro (0.1585) not better than 0.1986. Patience: 7/15
2025-05-28 12:43:24 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E26 End: Alloc 3161.6MB
2025-05-28 12:46:11 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 27 training finished. Avg Loss: 1.8856, Final LR for epoch: 9.69e-05, Opt Steps: 228
2025-05-28 12:46:28 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9558, accuracy: 0.2303, f1_macro: 0.1514, f1_weighted: 0.1622, precision_macro: 0.2201, precision_weighted: 0.2369, recall_macro: 0.2193, recall_weighted: 0.2303, f1_Bacterial_Blight: 0.0000, f1_Curl_Virus: 0.3202, f1_Healthy_Leaf: 0.0283, f1_Herbicide_Growth_Damage: 0.3443, f1_Leaf_Hopper_Jassids: 0.0853, f1_Leaf_Redding: 0.2818, f1_Leaf_Variegation: 0.0000
2025-05-28 12:46:28 - __main__ - INFO - [main_execution_logic:363] - E27: Val f1_macro (0.1514) not better than 0.1986. Patience: 8/15
2025-05-28 12:46:28 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E27 End: Alloc 3161.6MB
2025-05-28 12:49:16 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 28 training finished. Avg Loss: 1.8853, Final LR for epoch: 9.66e-05, Opt Steps: 228
2025-05-28 12:49:33 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9557, accuracy: 0.2380, f1_macro: 0.1515, f1_weighted: 0.1651, precision_macro: 0.2728, precision_weighted: 0.2707, recall_macro: 0.2247, recall_weighted: 0.2380, f1_Bacterial_Blight: 0.0085, f1_Curl_Virus: 0.3203, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.3193, f1_Leaf_Hopper_Jassids: 0.0556, f1_Leaf_Redding: 0.3567, f1_Leaf_Variegation: 0.0000
2025-05-28 12:49:33 - __main__ - INFO - [main_execution_logic:363] - E28: Val f1_macro (0.1515) not better than 0.1986. Patience: 9/15
2025-05-28 12:49:33 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E28 End: Alloc 3161.6MB
2025-05-28 12:52:21 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 29 training finished. Avg Loss: 1.8866, Final LR for epoch: 9.63e-05, Opt Steps: 228
2025-05-28 12:52:38 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 1.9936, accuracy: 0.2177, f1_macro: 0.1301, f1_weighted: 0.1348, precision_macro: 0.2327, precision_weighted: 0.2346, recall_macro: 0.2162, recall_weighted: 0.2177, f1_Bacterial_Blight: 0.0250, f1_Curl_Virus: 0.3125, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.3350, f1_Leaf_Hopper_Jassids: 0.0805, f1_Leaf_Redding: 0.1350, f1_Leaf_Variegation: 0.0228
2025-05-28 12:52:38 - __main__ - INFO - [main_execution_logic:363] - E29: Val f1_macro (0.1301) not better than 0.1986. Patience: 10/15
2025-05-28 12:52:38 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E29 End: Alloc 3161.6MB
2025-05-28 12:55:26 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 30 training finished. Avg Loss: 1.8799, Final LR for epoch: 9.60e-05, Opt Steps: 228
2025-05-28 12:55:43 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 2.0148, accuracy: 0.2133, f1_macro: 0.1421, f1_weighted: 0.1462, precision_macro: 0.2588, precision_weighted: 0.2624, recall_macro: 0.2140, recall_weighted: 0.2133, f1_Bacterial_Blight: 0.2199, f1_Curl_Virus: 0.3243, f1_Healthy_Leaf: 0.0000, f1_Herbicide_Growth_Damage: 0.2915, f1_Leaf_Hopper_Jassids: 0.0169, f1_Leaf_Redding: 0.1421, f1_Leaf_Variegation: 0.0000
2025-05-28 12:55:43 - __main__ - INFO - [main_execution_logic:363] - E30: Val f1_macro (0.1421) not better than 0.1986. Patience: 11/15
2025-05-28 12:55:43 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E30 End: Alloc 3161.6MB
2025-05-28 12:58:32 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 31 training finished. Avg Loss: 1.8849, Final LR for epoch: 9.57e-05, Opt Steps: 228
2025-05-28 12:58:51 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 2.0400, accuracy: 0.1833, f1_macro: 0.1031, f1_weighted: 0.1047, precision_macro: 0.3284, precision_weighted: 0.3407, recall_macro: 0.1864, recall_weighted: 0.1833, f1_Bacterial_Blight: 0.1032, f1_Curl_Virus: 0.2821, f1_Healthy_Leaf: 0.0275, f1_Herbicide_Growth_Damage: 0.2686, f1_Leaf_Hopper_Jassids: 0.0165, f1_Leaf_Redding: 0.0242, f1_Leaf_Variegation: 0.0000
2025-05-28 12:58:51 - __main__ - INFO - [main_execution_logic:363] - E31: Val f1_macro (0.1031) not better than 0.1986. Patience: 12/15
2025-05-28 12:58:51 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E31 End: Alloc 3161.6MB
2025-05-28 13:01:39 - phase4_finetuning.finetune.trainer - INFO - [train_one_epoch:115] - Epoch 32 training finished. Avg Loss: 1.8738, Final LR for epoch: 9.53e-05, Opt Steps: 228
2025-05-28 13:01:57 - phase4_finetuning.finetune.trainer - INFO - [validate_one_epoch:165] - Validation finished. Avg Loss: 2.0799, accuracy: 0.1663, f1_macro: 0.0823, f1_weighted: 0.0837, precision_macro: 0.2705, precision_weighted: 0.2629, recall_macro: 0.1703, recall_weighted: 0.1663, f1_Bacterial_Blight: 0.0085, f1_Curl_Virus: 0.1416, f1_Healthy_Leaf: 0.1546, f1_Herbicide_Growth_Damage: 0.2636, f1_Leaf_Hopper_Jassids: 0.0078, f1_Leaf_Redding: 0.0000, f1_Leaf_Variegation: 0.0000
2025-05-28 13:01:57 - __main__ - INFO - [main_execution_logic:363] - E32: Val f1_macro (0.0823) not better than 0.1986. Patience: 13/15
2025-05-28 13:01:57 - __main__ - DEBUG - [main_execution_logic:366] - CUDA Mem E32 End: Alloc 3161.6MB
2025-05-28 13:04:10 - __main__ - WARNING - [main_execution_logic:368] - Fine-tuning interrupted. Last completed epoch: 32.
2025-05-28 13:04:10 - __main__ - INFO - [main_execution_logic:371] - Fine-tuning ended. Last completed epoch: 32.
2025-05-28 13:04:14 - phase4_finetuning.finetune.trainer - INFO - [save_model_checkpoint:173] - Model checkpoint saved to /teamspace/studios/this_studio/cvpr25/phase4_finetuning/logs_finetune_full_v1/checkpoints_full_v1/final_finetuned_hvt_full.pth
2025-05-28 13:04:14 - __main__ - INFO - [main_execution_logic:374] - Fine-tuning summary: Best validation 'f1_macro': 0.1986
